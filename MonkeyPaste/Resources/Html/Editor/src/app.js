var IsLoaded = false;
var EnvName = '';

function init(reqMsgStr) {
    if (reqMsgStr == null) {
        //let sample1 = '<p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">//rtbvm.HasViewChanged = true;</span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">rtbvm.OnPropertyChanged(</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">nameof</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">(rtbvm.CurrentSize)); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> cilv =  </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">this</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.GetVisualAncestor<</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(43,145,175);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpContentListView</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">cilv.UpdateAdorner();</span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><br copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> rtbl = cilv.GetVisualDescendents<</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(43,145,175);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">RichTextBox</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">double</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> totalHeight = rtbl.Sum(x => x.ActualHeight) +</span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(43,145,175);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpMeasurements</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.Instance.ClipTileEditToolbarHeight + </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(43,145,175);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpMeasurements</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.Instance.ClipTileDetailHeight; </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> ctcv =  </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">this</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.GetVisualAncestor<</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(43,145,175);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpClipTileContainerView</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">ctcv.ExpandBehavior.Resize(totalHeight); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,255);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> sv = cilv.ContentListBox.GetScrollViewer(); </span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">sv.InvalidateScrollInfo();</span></p><p class="ql-align-left" copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><br copyitemguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"></p>';
        let sample1 = '<p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">//rtbvm.HasViewChanged = true;</span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">rtbvm.OnPropertyChanged(</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">nameof</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">(rtbvm.CurrentSize)); </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> cilv =  </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">this</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.GetVisualAncestor<</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(43,145,175);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpContentListView</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">cilv.UpdateAdorner();</span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><br copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> rtbl = cilv.GetVisualDescendents<</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(43,145,175);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">RichTextBox</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">double</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> totalHeight = rtbl.Sum(x => x.ActualHeight) +</span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(43,145,175);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpMeasurements</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.Instance.ClipTileEditToolbarHeight + </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(43,145,175);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpMeasurements</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.Instance.ClipTileDetailHeight; </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> ctcv =  </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">this</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">.GetVisualAncestor<</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(43,145,175);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">MpClipTileContainerView</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">>(); </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">ctcv.ExpandBehavior.Resize(totalHeight); </span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,255);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">var</span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"> sv = cilv.ContentListBox.GetScrollViewer(); </span></p><p class="ql-align-left"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6">sv.InvalidateScrollInfo();</span></p><p class="ql-align-left"	copyitemblockguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"><br copyiteminlineguid="8a26a5ad-66eb-43b4-b4e6-4fa4005ebed6"></p>';
        //let sample2 = '<p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//public async Task FillAllTemplates() {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    bool hasExpanded = false;</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    foreach (var rtbvm in SubSelectedContentItems) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//        if (rtbvm.HasTokens) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.IsSelected = true;</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.IsPastingTemplate = true;</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            if (!hasExpanded) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                //tile will be shrunk in on completed of hide window</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                MainWindowViewModel.ExpandClipTile(HostClipTileViewModel);</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                if (!MpClipTrayViewModel.Instance.IsPastingHotKey) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                    PasteTemplateToolbarViewModel.IsBusy = true;</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                hasExpanded = true;</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            PasteTemplateToolbarViewModel.SetSubItem(rtbvm);</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            await Application.Current.Dispatcher.BeginInvoke((Action)(() => {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                while (!PasteTemplateToolbarViewModel.HaveAllSubItemTemplatesBeenVisited) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                    System.Threading.Thread.Sleep(100);</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            }), DispatcherPriority.Background);</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //await Task.Run(() => {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    while (!HostClipTileViewModel.PasteTemplateToolbarViewModel.HaveAllSubItemTemplatesBeenVisited) {</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //        System.Threading.Thread.Sleep(100);</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    //TemplateRichText is set in PasteTemplateCommand</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //});</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.TemplateHyperlinkCollectionViewModel.ClearSelection();</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//        }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    }</span></p><p class="ql-align-left" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,0,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas" style="font-size: 12.6666666666667px; color: rgb(0,128,0);" copyitemguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//}</span></p>';
        let sample2 = '<p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//public async Task FillAllTemplates() {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    bool hasExpanded = false;</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    foreach (var rtbvm in SubSelectedContentItems) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//        if (rtbvm.HasTokens) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.IsSelected = true;</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.IsPastingTemplate = true;</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            if (!hasExpanded) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                //tile will be shrunk in on completed of hide window</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                MainWindowViewModel.ExpandClipTile(HostClipTileViewModel);</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                if (!MpClipTrayViewModel.Instance.IsPastingHotKey) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                    PasteTemplateToolbarViewModel.IsBusy = true;</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                hasExpanded = true;</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            PasteTemplateToolbarViewModel.SetSubItem(rtbvm);</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            await Application.Current.Dispatcher.BeginInvoke((Action)(() => {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                while (!PasteTemplateToolbarViewModel.HaveAllSubItemTemplatesBeenVisited) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                    System.Threading.Thread.Sleep(100);</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//                }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            }), DispatcherPriority.Background);</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //await Task.Run(() => {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    while (!HostClipTileViewModel.PasteTemplateToolbarViewModel.HaveAllSubItemTemplatesBeenVisited) {</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //        System.Threading.Thread.Sleep(100);</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //    //TemplateRichText is set in PasteTemplateCommand</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            //});</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//            rtbvm.TemplateHyperlinkCollectionViewModel.ClearSelection();</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//        }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><br copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938"></p><p class="ql-align-left"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//    }</span></p><p class="ql-align-left"	copyitemblockguid="707c5722-f7a7-4459-b8c3-6a1179a59938"><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,0,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">        </span><span class="ql-font-consolas"	style="font-size: 12.6666666666667px; color: rgb(0,128,0);"	copyiteminlineguid="707c5722-f7a7-4459-b8c3-6a1179a59938">//}</span></p>';
        reqMsg = {
            envName: 'web',
            isPasteRequest: false,
            isReadOnlyEnabled: false,
            itemEncodedHtmlData: sample1 + sample2,
            usedTextTemplates: []
        }
    } else {
        let reqMsgStr_decoded = atob(reqMsgStr);
        reqMsg = JSON.parse(reqMsgStr_decoded);
    }
    EnvName = reqMsg.envName;

    initEditor(reqMsg);

    window.addEventListener('resize', function (event) {
        updateAllSizeAndPositions();
    }, true);

    updateAllSizeAndPositions();
    window.onscroll = onWindowScroll;

    IsLoaded = true;
    return "GREAT!";
}

function hideScrollbars() {
    //document.querySelector('body').style.overflow = 'hidden';
    document.getElementById('editor').style.overflow = 'hidden';
}

function showScrollbars() {
    //document.querySelector('body').style.overflow = 'scroll';
    document.getElementById('editor').style.overflow = 'auto';
}

function getTotalHeight() {
    var totalHeight = getEditorToolbarHeight() + getEditorHeight() + getTemplateToolbarHeight();
    return totalHeight;
}

function updateAllSizeAndPositions() {
    //$(".ql-toolbar").css("position", "fixed");
    $(".ql-toolbar").css("top", 0);

    if (IsReadOnly()) {
        $("#editor").css("top", 0);
    } else {
        $("#editor").css("top", $(".ql-toolbar").outerHeight());
    }

    let wh = window.visualViewport.height;
    let eth = getEditorToolbarHeight();
    let tth = getTemplateToolbarHeight();

    $("#editor").css("height", wh - eth - tth);

    updateEditTemplateToolbarPosition();
    updatePasteTemplateToolbarPosition();

    if (EnvName == 'android') {
        //var viewportBottom = window.scrollY + window.innerHeight;
        //let tbh = $(".ql-toolbar").outerHeight();
        //if (y <= 0) {
        //    //keyboard is not visible
        //    $(".ql-toolbar").css("top", y);
        //    $("#editor").css("top", y + tbh);
        //} else {
        //    $(".ql-toolbar").css("top", y - tbh);
        //    $("#editor").css("top", 0);
        //}
        //$("#editor").css("bottom", viewportBottom - tbh);
    }

}

function onWindowScroll(e) {
    if (IsReadOnly()) {
        return;
    }

    updateAllSizeAndPositions();
}
