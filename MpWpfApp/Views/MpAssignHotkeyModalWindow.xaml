<Window x:Class="MpWpfApp.MpAssignHotkeyModalWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MpWpfApp"
        mc:Ignorable="d"
        Title="Assign Hotkey"
        Height="250"
        Width="400"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">
    <Window.DataContext>
        <local:MpAssignShortcutModalWindowViewModel />
    </Window.DataContext>
    <Window.Resources>
        <CollectionViewSource x:Key="ListBoxItems"
                              Source="{Binding KeyItems}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="SeqIdx"  />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:CallMethodAction MethodName="AssignHotkeyModalWindow_Loaded"
                                TargetObject="{Binding}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="0.7*" />
            <RowDefinition Height="0.7*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Label Grid.Row="0"
               FontSize="16"
               HorizontalAlignment="Center"
               HorizontalContentAlignment="Center"
               Content="Press Keys for" />
        <Label Grid.Row="1"
               FontSize="16"
               HorizontalAlignment="Center"
               HorizontalContentAlignment="Center"
               Content="{Binding ShortcutDisplayName}" />
        <ListBox x:Name="ShortcutListBox" 
                     Grid.Row="2"
                     IsEnabled="False"
                     BorderThickness="0" 
                     HorizontalAlignment="Center"
                     ScrollViewer.VerticalScrollBarVisibility="Hidden"
                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                     ItemsSource="{Binding Source={StaticResource ListBoxItems}}">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel Orientation="Horizontal"
                                    IsItemsHost="True"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="{x:Type ListBoxItem}">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                    <ContentPresenter />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border BorderBrush="Black"
                                BorderThickness="0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0"
                                        HorizontalAlignment="Left"
                                        Background="LightGray"                                        
                                        BorderBrush="DarkGray"
                                        Margin="0"
                                        BorderThickness="2"
                                        CornerRadius="5">
                                    <TextBlock HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Padding="10,5,10,5"
                                               FontSize="14"
                                               Foreground="Black"
                                               Text="{Binding KeyStr}"
                                               FontWeight="Bold" />
                                </Border>
                                <Label x:Name="ComboLabel"  
                                       Visibility="{Binding PlusVisibility}"
                                       Content="+"
                                       Grid.Column="1"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center" />
                                <!--<Label x:Name="SequenceLabel"
                                       Visibility="{Binding CommaVisibility}"
                                       Content=","
                                       Grid.Column="1"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Bottom" />-->
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
                <ListBox.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.Panel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </GroupStyle.Panel>
                    <GroupStyle.ContainerStyle>
                            <Style TargetType="{x:Type GroupItem}">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <Border CornerRadius="5" 
                                                    Margin="5,0,5,0" 
                                                    Padding="3"
                                                    BorderBrush="LimeGreen"
                                                    BorderThickness="1"
                                                    Background="Aquamarine">
                                                <ItemsPresenter />
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </GroupStyle.ContainerStyle>
                    </GroupStyle>
                </ListBox.GroupStyle>
        </ListBox>
        <TextBlock Grid.Row="3"
                   FontSize="10"
                   Visibility="Collapsed"
                   FontStyle="Oblique"
                   TextWrapping="Wrap"
                   HorizontalAlignment="Center"
                   Foreground="Red"
                   Text="{Binding KeyString}" />
        <TextBlock Grid.Row="3"
                   FontSize="10"
                   FontStyle="Oblique"
                   TextWrapping="Wrap"
                   HorizontalAlignment="Center"
                   Foreground="Red"
                   Text="{Binding WarningString}" />
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Button Margin="10" 
                    Grid.Column="0" 
                    Content="Cancel" 
                    IsCancel="True"
                    HorizontalAlignment="Stretch" 
                    Command="{Binding CancelCommand}"/>
            <Button Margin="10" 
                    Grid.Column="1"
                    Content="Clear" 
                    HorizontalAlignment="Stretch" 
                    Command="{Binding ClearCommand}"/>
            <Button Margin="10" 
                    Grid.Column="2" 
                    Content="Ok" 
                    HorizontalAlignment="Stretch" 
                    Command="{Binding OkCommand}"
                    IsDefault="True" />
        </Grid>
    </Grid>
</Window>
