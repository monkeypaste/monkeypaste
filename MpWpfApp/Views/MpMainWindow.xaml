<Window x:Class="MpWpfApp.MpMainWindow"
        x:Name="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:ii="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:s="clr-namespace:System;assembly=mscorlib"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:dd="clr-namespace:GongSolutions.Wpf.DragDrop;assembly=GongSolutions.Wpf.DragDrop"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2f008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
        xmlns:spinners="clr-namespace:xamlSpinnersWPF"
        xmlns:diagnostics="clr-namespace:System.Diagnostics;assembly=WindowsBase"
        mc:Ignorable="d"
        xmlns:local="clr-namespace:MpWpfApp"
        Title="MpMainWindow"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Top="0"        
        Visibility="Visible"
        ShowInTaskbar="False"
        ResizeMode="CanResize"
        WindowState="Normal"
        Height="{Binding MainWindowHeight}"
        Width="{Binding MainWindowWidth}"
        DataContext="{StaticResource MainWindowViewModel}">
    <!--<Window.Background>
        <SolidColorBrush Opacity="0.0"
                         Color="White" />GetDataObjectFromSelectedClips
    </Window.Background>-->
    <Window.Resources>
        <!--Color Pallete Menu Item-->
        <Style x:Key="MenuItemStyle"
               TargetType="{x:Type MenuItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Bd"
                                Padding="31,0,17,0"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                SnapsToDevicePixels="True"
                                Uid="Border_38">
                            <ContentPresenter x:Name="ContentPresenter"
                                              Content="{TemplateBinding Header}"
                                              Grid.Column="1"
                                              ContentSource="Header"
                                              Margin="{TemplateBinding Padding}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              Uid="ContentPresenter_33" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted"
                                     Value="True">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="#00FFFFFF" />
                                <Setter Property="BorderBrush"
                                        TargetName="Bd"
                                        Value="#00FFFFFF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background"
                    Value="Transparent" />
            <Style.Triggers>
                <Trigger Property="IsHighlighted"
                         Value="True">
                    <Setter Property="Background"
                            Value="Transparent" />
                </Trigger>
            </Style.Triggers>
        </Style>
        
        
    </Window.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:CallMethodAction MethodName="MainWindow_Loaded"
                                TargetObject="{Binding}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <Canvas x:Name="MainWindowCanvas"
            AllowDrop="True"
            Height="{Binding MainWindowHeight}"
            Width="{Binding MainWindowWidth}"
            Background="Transparent">
        <Grid x:Name="MainWindowGrid"
              Canvas.Top="{Binding MainWindowGridTop}"
              Height="{Binding MainWindowGridHeight}"
              Width="{Binding MainWindowWidth}"
              Background="Green">
            <Grid.RowDefinitions>
                <RowDefinition Height="{Binding TitleMenuHeight}" />
                <RowDefinition Height="{Binding FilterMenuHeight}" />
                <RowDefinition Height="{Binding ClipTrayHeight}" />
            </Grid.RowDefinitions>
            <tb:TaskbarIcon x:Name="SystemTrayTaskbarIcon"
                            DataContext="{Binding SystemTrayViewModel}"
                            IconSource="/MpWpfApp;component/Resources/Icons/monkey (2).ico"
                            ToolTipText="{Binding SystemTrayIconToolTipText}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Loaded">
                        <i:CallMethodAction MethodName="SystemTrayTaskbarIcon_Loaded"
                                            TargetObject="{Binding}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <tb:TaskbarIcon.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Settings"
                                  Icon="{Binding Source={StaticResource CogIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding ShowSettingsWindowCommand}"
                                  CommandParameter="{StaticResource SettingsTabAccount}" />
                        <MenuItem Header="{Binding PauseOrPlayHeader}"
                                  Icon="{Binding PauseOrPlayIconSource, Converter={StaticResource StringToIconConverter}}"
                                  Command="{Binding MainWindowViewModel.AppModeViewModel.ToggleIsAppPausedCommand}"/>
                        <MenuItem Header="Help"
                                  Icon="{Binding Source={StaticResource HelpIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding ShowSettingsWindowCommand}"
                                  CommandParameter="{StaticResource SettingsTabHelp}" />
                        <MenuItem Header="Exit"
                                  Icon="{Binding Source={StaticResource DeleteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding ExitApplicationCommand}" />
                    </ContextMenu>
                </tb:TaskbarIcon.ContextMenu>
                <tb:TaskbarIcon.TrayToolTip>
                    <Border Background="{StaticResource AppColorDark}"
                            BorderBrush="{StaticResource AppColorLight}"
                            BorderThickness="2"
                            Padding="10"
                            CornerRadius="4"
                            Opacity="0.8">
                        <StackPanel>
                            <TextBlock Text="{Binding AppStatus}"
                                       Foreground="White"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center" />
                            <TextBlock Text="{Binding AccountStatus}"
                                       Foreground="White"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center" />
                            <TextBlock Text="{Binding TotalItemCount}"
                                       Foreground="White"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center" />
                            <TextBlock Text="{Binding DbSizeInMbs}"
                                       Foreground="White"
                                       HorizontalAlignment="Left"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>
                </tb:TaskbarIcon.TrayToolTip>
            </tb:TaskbarIcon>
            <!-- Main Menu -->
            <StackPanel Grid.Row="0"
                        Grid.Column="0"
                        Orientation="Horizontal"
                        Background="DarkGreen" />
            <!-- FilterMenu -->
            <Grid Grid.Row="1"
                  Grid.Column="0"
                  Focusable="True"
                  Background="DarkViolet">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.5*" />
                    <ColumnDefinition Width="1.15*" />
                    <ColumnDefinition Width="5*" />
                    <ColumnDefinition Width="1.5*" />
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal"
                            Grid.Column="0">
                    <Button x:Name="SettingsWindowButton"
                            Width="35"
                            Height="35"
                            Margin="5,0,0,0"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            Command="{Binding SystemTrayViewModel.ShowSettingsWindowCommand}"
                            Template="{StaticResource SearchButtonControlTemplate}">
                        <Image Source="/Resources/Images/cog.png"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center" />
                    </Button>
                    <ToggleButton x:Name="TogglekMainWindowLockButton"
                                  Width="35"
                                  Height="35"
                                  Margin="5,0,0,0"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  IsChecked="{Binding IsMainWindowLocked}"
                                  Command="{Binding ToggleMainWindowLockCommand}"
                                  CommandParameter="{StaticResource True}"
                                  Template="{StaticResource LockToggleButtonControlTemplate}">
                        <Image Source="/Resources/Images/lock.png"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center" />
                    </ToggleButton>
                </StackPanel>
                <!-- Sort Combobox -->
                <Grid Grid.Column="1"
                      DataContext="{Binding ClipTileSortViewModel}"
                      Margin="0">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:CallMethodAction MethodName="ClipTileSort_Loaded"
                                                TargetObject="{Binding}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="4*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Label Grid.Column="0"
                           FontSize="19"
                           Foreground="White"
                           HorizontalAlignment="Left"
                           FontWeight="DemiBold"
                           VerticalContentAlignment="Center"
                           Padding="0,0,0,0">Sort By</Label>
                    <local:MpClipBorder CornerRadius="15"
                                        Margin="5"
                                        Grid.Column="1">
                        <ComboBox FontSize="16"
                                  Background="Transparent"
                                  HorizontalContentAlignment="Left"
                                  VerticalContentAlignment="Center"
                                  SelectedItem="{Binding SelectedSortType}"
                                  ItemsSource="{Binding SortTypes}">
                            <ComboBox.ItemTemplate>
                                <ItemContainerTemplate>
                                    <TextBlock Text="{Binding Header}" />
                                </ItemContainerTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </local:MpClipBorder>
                    <Button Grid.Column="2"
                            Margin="0,0,0,0"
                            Background="Transparent"
                            Template="{StaticResource SearchButtonControlTemplate}"
                            BorderThickness="0"
                            Height="30"
                            Width="30"
                            Command="{Binding ToggleSortOrderCommand}">
                        <Grid>
                            <Image Source="/Resources/Images/asc_white.png"
                                   Visibility="{Binding AscSortOrderButtonImageVisibility}"
                                   Stretch="Fill" />
                            <Image Source="/Resources/Images/desc_white.png"
                                   Visibility="{Binding DescSortOrderButtonImageVisibility}"
                                   Stretch="Fill" />
                        </Grid>

                    </Button>
                </Grid>
                <!-- Tag Tray -->
                <StackPanel Grid.Column="2"
                            DataContext="{Binding TagTrayViewModel}"
                            Focusable="False"
                            HorizontalAlignment="Center"
                            Orientation="Horizontal">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:CallMethodAction MethodName="TagTray_Loaded"
                                                TargetObject="{Binding}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <ListBox x:Name="TagTray"
                             Focusable="False"
                             Background="Transparent"
                             BorderBrush="Transparent"
                             dd:DragDrop.IsDragSource="True"
                             dd:DragDrop.IsDropTarget="True"
                             HorizontalAlignment="Center"
                             SelectionMode="Single"
                             ScrollViewer.VerticalScrollBarVisibility="Hidden"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             ItemsSource="{Binding}">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="{x:Type ListBoxItem}">
                                <Setter Property="IsSelected"
                                        Value="{Binding IsSelected}" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                            <ContentPresenter />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="HorizontalContentAlignment"
                                        Value="Left" />
                                <Setter Property="VerticalContentAlignment"
                                        Value="Top" />
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel IsItemsHost="True"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <!-- Tag Tile Border -->
                                <local:MpClipBorder x:Name="TagTileBorder"
                                                    CornerRadius="10"
                                                    Margin="5,0,5,0"
                                                    Padding="7,5,7,5"
                                                    Focusable="True"
                                                    VerticalAlignment="Center"
                                                    Background="{Binding TagBorderBackgroundBrush}"
                                                    BorderBrush="{Binding TagBorderBrush}"
                                                    BorderThickness="1.5"
                                                    Height="{Binding TagHeight}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="Loaded">
                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                MethodName="TagTile_Loaded" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                    <local:MpClipBorder.ContextMenu>
                                        <ContextMenu>
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Loaded">
                                                    <i:CallMethodAction TargetObject="{Binding}"
                                                                        MethodName="TagTile_ContextMenu_Loaded" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                            <MenuItem Header="Rename"
                                                      Command="{Binding RenameTagCommand}" />
                                            <MenuItem Header="Hotkey"
                                                      InputGestureText="{Binding ShortcutKeyString}"
                                                      Command="{Binding AssignHotkeyCommand}" />
                                            <MenuItem Header="Change Color"
                                                      Command="{Binding ChangeTagColorCommand}" />
                                            <MenuItem x:Name="TagTileColorContextMenuItem"
                                                      Style="{StaticResource MenuItemStyle}" />
                                            <MenuItem Header="Delete"
                                                      Command="{Binding TagTrayViewModel.DeleteTagCommand}" />
                                        </ContextMenu>
                                    </local:MpClipBorder.ContextMenu>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <!-- Tag Count Box-->
                                        <local:MpClipBorder CornerRadius="5"
                                                            Grid.Column="0"
                                                            Grid.Row="0"
                                                            MinWidth="20"
                                                            Margin="3,0,0,0"
                                                            Padding="5"
                                                            BorderThickness="0"
                                                            Background="{Binding TagColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                                            <TextBlock Background="Transparent"
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Center"
                                                       Text="{Binding TagClipCount, Converter={StaticResource IntToStringConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                                                       Foreground="{Binding TagCountTextColor}" />
                                        </local:MpClipBorder>
                                        <TextBlock x:Name="TagTextBlock"
                                                   Grid.Column="1"
                                                   Grid.Row="0"
                                                   Margin="5,0,0,0"
                                                   Background="Transparent"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding TextBlockVisibility}"
                                                   FontSize="{Binding TagFontSize}"
                                                   FontWeight="SemiBold"
                                                   Foreground="{Binding TagTextColor}"
                                                   Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                                        </TextBlock>
                                        <TextBox x:Name="TagTextBox"
                                                 Grid.Row="0"
                                                 Grid.Column="1"
                                                 Margin="5,0,0,0"
                                                 Background="White"
                                                 Foreground="Black"
                                                 IsReadOnly="False"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"
                                                 Visibility="{Binding TextBoxVisibility}"
                                                 FontSize="{Binding TagFontSize}"
                                                 Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" />
                                    </Grid>
                                </local:MpClipBorder>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <!-- Add Tag Button -->
                    <Button x:Name="AddTagButton"
                            Height="30"
                            Width="30"
                            BorderThickness="0"
                            Template="{StaticResource SearchButtonControlTemplate}"
                            Background="Transparent"
                            Command="{Binding CreateTagCommand}">
                        <Image Stretch="Fill"
                               Source="/MpWpfApp;component/Resources/Images/add4.png" />
                    </Button>
                </StackPanel>
                <Grid Grid.Column="3"
                      DataContext="{Binding SearchBoxViewModel}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="0.2*" />
                    </Grid.ColumnDefinitions>
                    <!-- Search Border -->
                    <local:MpClipBorder x:Name="SearchTextBoxBorder"
                                        Grid.Column="0"
                                        Grid.ColumnSpan="{Binding SearchBorderColumnSpan}"
                                        Margin="5"
                                        CornerRadius="10"
                                        BorderBrush="{Binding TextBoxBorderBrush}"
                                        Background="White"
                                        BorderThickness="3">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Loaded">
                                <i:CallMethodAction MethodName="SearchBoxBorder_Loaded"
                                                    TargetObject="{Binding}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <Grid Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.15*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="0.1*" />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="SearchDropDownButton"
                                    Background="Transparent"
                                    Grid.Column="0"
                                    Margin="3,0,0,0"
                                    Width="25"
                                    Height="25"
                                    Template="{StaticResource SearchButtonControlTemplate}"
                                    BorderThickness="0">
                                <Image Source="/MpWpfApp;component/Resources/Images/search.png"
                                       Stretch="Fill"
                                       SnapsToDevicePixels="True" />
                            </Button>
                            <TextBox x:Name="SearchBox"
                                     Grid.Column="1"
                                     AllowDrop="False"
                                     FontSize="16"
                                     Background="Transparent"
                                     Foreground="{Binding TextBoxTextBrush}"
                                     FontStyle="{Binding TextBoxFontStyle}"
                                     BorderThickness="0"
                                     VerticalContentAlignment="Center"
                                     Padding="0,0,0,0"
                                     Text="{Binding Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                            </TextBox>
                            <spinners:ucSpinnerApple x:Name="IsSearchingSpinner"
                                                     Grid.Column="2"
                                                     VerticalAlignment="Center"
                                                     Margin="0,0,5,0"
                                                     Visibility="{Binding SearchSpinnerVisibility}" />
                            <Button x:Name="ClearTextBoxButton"
                                    Grid.Column="2"
                                    Width="15"
                                    Height="15"
                                    Visibility="{Binding ClearTextButtonVisibility}"
                                    Command="{Binding ClearTextCommand}"
                                    Template="{DynamicResource BackgroundButton}">
                                <Button.Background>
                                    <ImageBrush ImageSource="/MpWpfApp;component/Resources/Images/close2.png" />
                                </Button.Background>
                                <Button.Resources>
                                    <ControlTemplate x:Key="BackgroundButton"
                                                     TargetType="Button">
                                        <Border x:Name="border"
                                                BorderThickness="0"
                                                Background="{TemplateBinding Background}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        TargetName="border">
                                                    <Setter.Value>
                                                        <ImageBrush ImageSource="/MpWpfApp;component/Resources/Images/close2.png" />
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Resources>
                            </Button>
                        </Grid>
                    </local:MpClipBorder>
                    <!-- Search Navigation Border-->
                    <local:MpClipBorder Grid.Column="1"
                                        CornerRadius="10"
                                        Visibility="{Binding SearchNavigationButtonPanelVisibility}"
                                        HorizontalAlignment="Center"
                                        Margin="3,0,10,0">
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="PreviousTemplateButton"
                                    TabIndex="2"
                                    Command="{Binding PrevMatchCommand}"
                                    Width="20"
                                    Height="20"
                                    Padding="5">
                                <Image Source="/Resources/Images/back_black.png" />
                            </Button>
                            <Button x:Name="NextTemplateButton"
                                    TabIndex="3"
                                    Command="{Binding NextMatchCommand}"
                                    Width="20"
                                    Height="20"
                                    Padding="5">
                                <Image Source="/Resources/Images/forward_black.png" />
                            </Button>
                        </StackPanel>
                    </local:MpClipBorder>
                </Grid>
            </Grid>
            <Grid Grid.Row="2"
                  Grid.Column="0"                  
                  Focusable="True"
                  Background="MediumPurple">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="{Binding AppModeButtonGridWidth}" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!-- Side bar AppState Buttons -->
                <Grid Grid.Row="0"
                      Grid.Column="0"
                      Background="DimGray"
                      DataContext="{Binding AppModeViewModel}"
                      Visibility="{Binding AppModeColumnVisibility}">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:CallMethodAction MethodName="AppMode_Loaded"
                                                TargetObject="{Binding}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <ToggleButton Grid.Row="0"
                                  Grid.Column="0"
                                  Width="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  Height="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  ToolTipService.InitialShowDelay="0"
                                  ToolTip="{Binding MainWindowViewModel.SystemTrayViewModel.PauseOrPlayHeader}"                                  
                                  Padding="10"
                                  Content="{Binding MainWindowViewModel.SystemTrayViewModel.PauseOrPlayIconSource, Converter={StaticResource StringToIconConverter}}"
                                  IsChecked="{Binding IsAppPaused}">
                    </ToggleButton>
                    <ToggleButton Grid.Row="1"
                                  Grid.Column="0"
                                  ToolTipService.InitialShowDelay="0"
                                  ToolTip="Auto Copy Selection"
                                  Width="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  Height="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  Content="{Binding Source={StaticResource LeftClickIcon}, Converter={StaticResource StringToIconConverter}}"
                                  IsChecked="{Binding IsAutoCopyMode}"
                                  Padding="10">
                    </ToggleButton>
                    <ToggleButton Grid.Row="2"
                                  Grid.Column="0"
                                  ToolTipService.InitialShowDelay="0"
                                  Width="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  Height="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  ToolTip="Right-Click Paste"
                                  Content="{Binding Source={StaticResource RightClickIcon}, Converter={StaticResource StringToIconConverter}}"
                                  IsChecked="{Binding IsRightClickPasteMode}"
                                  Padding="10">
                    </ToggleButton>
                    <ToggleButton Grid.Row="3"
                                  Grid.Column="0"
                                  Padding="10"
                                  ToolTipService.InitialShowDelay="0"
                                  Width="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  Height="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  ToolTip="Append Copy"
                                  Content="{Binding Source={StaticResource AppendIcon}, Converter={StaticResource StringToIconConverter}}"
                                  IsChecked="{Binding IsInAppendMode}">
                    </ToggleButton>
                    <ToggleButton Grid.Row="4"
                                  Grid.Column="0"
                                  ToolTipService.InitialShowDelay="0"
                                  Width="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  Height="{Binding MainWindowViewModel.AppModeButtonGridWidth}"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center"
                                  ToolTip="Auto Analyze"
                                  Content="{Binding Source={StaticResource BrainIcon}, Converter={StaticResource StringToIconConverter}}"
                                  IsChecked="{Binding IsInAutoAnalyzeMode}"
                                  Padding="10">
                    </ToggleButton>
                </Grid>
                <Grid x:Name="ClipTrayGrid"
                      DataContext="{Binding ClipTrayViewModel}"
                      Grid.Row="0"
                      Grid.Column="1">
                    <Grid.Resources>
                        <local:MpBindingProxy x:Key="ClipTrayProxy"
                                              Data="{Binding}" />
                    </Grid.Resources>
                    <AdornerDecorator>
                        <local:MpMultiSelectListBox x:Name="ClipTray"
                                                     DataContext="{Binding}"
                                                     ItemsSource="{Binding}"
                                                     Visibility="{Binding ClipTrayVisibility}"
                                                     Width="{Binding MainWindowViewModel.ClipTrayWidth}"
                                                    HorizontalContentAlignment="Left"
                                                    VerticalContentAlignment="Top"
                                                    AllowDrop="True"
                                                     ScrollToSelectedItem="True"
                                                     IsSynchronizedWithCurrentItem="True"
                                                     Margin="0,0,0,0"
                                                     Focusable="True"
                                                     BorderThickness="0"
                                                     VerticalAlignment="Stretch"
                                                     Background="Transparent"
                                                     SelectionMode="Extended"
                                                     VirtualizingPanel.IsVirtualizing="True"
                                                     VirtualizingPanel.ScrollUnit="Pixel"
                                                     VirtualizingPanel.VirtualizationMode="Recycling"
                                                     ScrollViewer.CanContentScroll="False"
                                                     ScrollViewer.IsDeferredScrollingEnabled="True"
                                                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                     ScrollViewer.VerticalScrollBarVisibility="Hidden">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Loaded">
                                    <i:CallMethodAction MethodName="ClipTray_Loaded"
                                                        TargetObject="{Binding}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <local:MpMultiSelectListBox.InputBindings>
                                <KeyBinding Gesture="Ctrl+A"
                                            Command="{Binding SelectAllCommand}" />
                            </local:MpMultiSelectListBox.InputBindings>
                            <local:MpMultiSelectListBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ListBoxItem}">
                                    <Setter Property="IsSelected"
                                            Value="{Binding IsSelected}" />
                                    <Setter Property="FocusVisualStyle"
                                            Value="{x:Null}" />
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Left" />
                                    <Setter Property="VerticalContentAlignment"
                                            Value="Top" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                <ContentPresenter />
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsSelected"
                                                             Value="True">
                                                        <Setter Property="BorderBrush"
                                                                Value="Transparent" />
                                                        <Setter Property="Background"
                                                                Value="Transparent" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </local:MpMultiSelectListBox.ItemContainerStyle>
                            <local:MpMultiSelectListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel x:Name="ClipTrayVirtualizingStackPanel"
                                                            IsItemsHost="True"
                                                            CanVerticallyScroll="False"
                                                            CanHorizontallyScroll="True"
                                                            VerticalAlignment="Top"
                                                            HorizontalAlignment="Left"
                                                            Orientation="Horizontal">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Loaded">
                                                <i:CallMethodAction MethodName="ClipTrayVirtualizingStackPanel_Loaded"
                                                                    TargetObject="{Binding}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </VirtualizingStackPanel>
                                </ItemsPanelTemplate>
                            </local:MpMultiSelectListBox.ItemsPanel>
                            <local:MpMultiSelectListBox.ItemTemplate>
                                <DataTemplate>
                                    <!-- Clip Tile -->
                                    <local:MpClipBorder x:Name="ClipTileClipBorder"
                                                        DataContext="{Binding}"
                                                        Margin="{Binding TileMargin}"
                                                        BorderThickness="{Binding TileBorderThickness}"
                                                        Width="{Binding TileBorderWidth}"
                                                        Height="{Binding TileBorderHeight}"
                                                        Visibility="{Binding TileVisibility, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                                                        Focusable="True"
                                                        AllowDrop="True"
                                                        ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                        Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                                                        ToolTipService.ShowDuration="1000"
                                                        CornerRadius="10">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Loaded">
                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                    MethodName="ClipTile_Loaded" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <local:MpClipBorder.BorderBrush>
                                            <DrawingBrush Viewport="0,0,8,8"
                                                          ViewportUnits="Absolute"
                                                          TileMode="Tile">
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <GeometryDrawing Brush="{Binding TileBorderBrush}">
                                                            <GeometryDrawing.Geometry>
                                                                <GeometryGroup>
                                                                    <RectangleGeometry Rect="{Binding TileBorderBrushRect}" />
                                                                    <RectangleGeometry Rect="50,50,50,50" />
                                                                </GeometryGroup>
                                                            </GeometryDrawing.Geometry>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </local:MpClipBorder.BorderBrush>
                                        <local:MpClipBorder.RenderTransform>
                                            <TranslateTransform X="0"
                                                                Y="0"
                                                                x:Name="ClipTileBorderTranslateTransform" />
                                        </local:MpClipBorder.RenderTransform>
                                        <local:MpClipBorder.Resources>
                                            <local:MpBindingProxy x:Key="ClipTileProxy"
                                                                  Data="{Binding}" />
                                        </local:MpClipBorder.Resources>
                                        <local:MpClipBorder.ContextMenu>
                                            <ContextMenu x:Name="ClipTile_ContextMenu"
                                                         DataContext="{Binding Data, Source={StaticResource ClipTileProxy}}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="Loaded">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTile_ContextMenu_Loaded" />
                                                    </i:EventTrigger>
                                                    <i:EventTrigger EventName="Opened">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTile_ContextMenu_Opened" />
                                                    </i:EventTrigger>
                                                    <i:EventTrigger EventName="Closed">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTile_ContextMenu_Closed" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <MenuItem Header="_Paste" 
                                                          Tag="6"
                                                          Icon="{Binding Source={StaticResource PasteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                          Command="{Binding Data.PasteSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Delete"
                                                          Tag="7"
                                                          Icon="{Binding Source={StaticResource DeleteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                          Command="{Binding Data.DeleteSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <Separator />
                                                <MenuItem Header="_Edit"
                                                          Icon="{Binding Source={StaticResource EditIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                    <MenuItem Header="_Edit Content"
                                                              Tag="20"
                                                              Icon="{Binding Source={StaticResource EditContentIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.EditSelectedContentCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <MenuItem Header="_Rename"
                                                              Tag="21"
                                                              Icon="{Binding Source={StaticResource RenameIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.EditSelectedTitleCommand, Source={StaticResource ClipTrayProxy}}"  />
                                                    <Separator />
                                                    <MenuItem x:Name="TranslateMenuItem"
                                                              Header="Translate"
                                                              Icon="{Binding Source={StaticResource TranslateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              ItemsSource="{Binding Data.TranslateLanguageMenuItems, Source={StaticResource ClipTrayProxy}}">
                                                        <MenuItem.ItemContainerStyle>
                                                            <Style TargetType="{x:Type MenuItem}">
                                                                <Setter Property="Header"
                                                                        Value="{Binding Header}" />
                                                                <Setter Property="Command"
                                                                        Value="{Binding Command}" />
                                                                <Setter Property="CommandParameter"
                                                                        Value="{Binding CommandParameter}" />
                                                                <Setter Property="HorizontalContentAlignment"
                                                                        Value="Left" />
                                                                <Setter Property="VerticalContentAlignment"
                                                                        Value="Top" />
                                                            </Style>
                                                        </MenuItem.ItemContainerStyle>
                                                    </MenuItem>
                                                </MenuItem>
                                                <MenuItem x:Name="ToolsMenuItem" 
                                                          Header="_Tools"
                                                          Icon="{Binding Source={StaticResource ToolsIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                    <MenuItem Header="Duplicate"
                                                              Tag="22"
                                                              Icon="{Binding Source={StaticResource DuplicateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.DuplicateSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}"/>
                                                    <MenuItem Header="_Merge"
                                                              Tag="17"
                                                              Icon="{Binding Source={StaticResource MergeIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.MergeSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <Separator />
                                                    <MenuItem Header="Send as Email"
                                                              Tag="23"
                                                              Icon="{Binding Source={StaticResource EmailIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.SendClipToEmailCommand, Source={StaticResource ClipTileProxy}}" />
                                                    <MenuItem Header="Duplicate As _Qr Code"
                                                              Tag="24"
                                                              Icon="{Binding Source={StaticResource QrIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.CreateQrCodeFromClipCommand, Source={StaticResource ClipTileProxy}}" />
                                                    <Separator />
                                                    <MenuItem Header="Say"
                                                              Tag="16"
                                                              Icon="{Binding Source={StaticResource SpeakIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.SpeakSelectedClipsAsyncCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <Separator />
                                                    <MenuItem Header="Search"
                                                              Icon="{Binding Source={StaticResource SearchIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                        <MenuItem Header="_Google"
                                                                  Icon="{Binding Source={StaticResource GoogleIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTrayProxy}}"
                                                                  CommandParameter="https://www.google.com/search?q=" />
                                                        <MenuItem Header="_Bing"
                                                                  Icon="{Binding Source={StaticResource BingIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTrayProxy}}"
                                                                  CommandParameter="https://www.bing.com/search?q=" />
                                                        <MenuItem Header="_DuckDuckGo"
                                                                  Icon="{Binding Source={StaticResource DuckIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTrayProxy}}"
                                                                  CommandParameter="https://duckduckgo.com/?q=" />
                                                        <MenuItem Header="_Yandex"
                                                                  Icon="{Binding Source={StaticResource YandexIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTrayProxy}}"
                                                                  CommandParameter="https://yandex.com/search/?text=" />
                                                    </MenuItem>
                                                    <Separator />
                                                    <MenuItem x:Name="ExcludeApplication" 
                                                              Header="Exclude Application"
                                                              Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding ExcludeApplicationCommand}" />
                                                    <MenuItem Header="Add Paste Macro For Application"
                                                              Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding MainWindowViewModel.SystemTrayViewModel.ShowSettingsWindowCommand}"
                                                              CommandParameter="{Binding}" />
                                                </MenuItem>
                                                <MenuItem Header="_Selection"
                                                          Icon="{Binding Source={StaticResource SelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                    <MenuItem Header="_Bring to Front"
                                                              Tag="12"
                                                              Icon="{Binding Source={StaticResource BringToFrontIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.BringSelectedClipTilesToFrontCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <MenuItem Header="_Send to Back"
                                                              Tag="13"
                                                              Icon="{Binding Source={StaticResource SendToBackIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.SendSelectedClipTilesToBackCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <Separator />
                                                    <MenuItem Header="Select _All"
                                                              Tag="10"
                                                              Icon="{Binding Source={StaticResource SelectAllIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.SelectAllCommand, Source={StaticResource ClipTrayProxy}}" />
                                                    <MenuItem Header="_Invert Selection"
                                                              Tag="11"
                                                              Icon="{Binding Source={StaticResource InvertSelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                              Command="{Binding Data.InvertSelectionCommand, Source={StaticResource ClipTrayProxy}}" />
                                                </MenuItem>
                                                <MenuItem Header="_Hotkey"
                                                          Tag="14"
                                                          Icon="{Binding Source={StaticResource HotkeyIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                          InputGestureText="{Binding ShortcutKeyString}"
                                                          Command="{Binding Data.AssignHotkeyCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <Separator />
                                                <MenuItem x:Name="ClipTileColorContextMenuItem"
                                                          Style="{StaticResource MenuItemStyle}" />
                                                <Separator />
                                                <MenuItem x:Name="PasteToAppPathMenuItem"
                                                          Header="Paste To Application"
                                                          Icon="{Binding Source={StaticResource PasteToAppIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}" />
                                                <Separator />
                                                <MenuItem Header="Pin To _Collection"
                                                          Icon="{Binding Source={StaticResource PinToCollectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                          ItemsSource="{Binding Data.TagMenuItems, Source={StaticResource ClipTileProxy}}">
                                                    <MenuItem.ItemContainerStyle>
                                                        <Style TargetType="{x:Type MenuItem}">
                                                            <Setter Property="Header"
                                                                    Value="{Binding Header}" />
                                                            <Setter Property="Command"
                                                                    Value="{Binding Command}" />
                                                            <Setter Property="CommandParameter"
                                                                    Value="{Binding CommandParameter}" />
                                                            <Setter Property="IsCheckable"
                                                                    Value="True" />
                                                            <Setter Property="IsChecked"
                                                                    Value="{Binding IsChecked}" />
                                                            <Setter Property="HorizontalContentAlignment"
                                                                    Value="Left" />
                                                            <Setter Property="VerticalContentAlignment"
                                                                    Value="Top" />
                                                        </Style>
                                                    </MenuItem.ItemContainerStyle>
                                                </MenuItem>
                                            </ContextMenu>
                                        </local:MpClipBorder.ContextMenu>
                                        <!--<local:MpClipBorder.Effect>
                                    <DropShadowEffect Color="DarkGray"
                                                      BlurRadius="7" />
                                </local:MpClipBorder.Effect>-->
                                        <Grid x:Name="ClipTileBorderGrid"
                                              Background="#FF3D3D3D"
                                              Visibility="{Binding ContainerVisibility}">
                                            <Grid Background="White"
                                                  Visibility="{Binding ContentVisibility}">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="{Binding TileTitleHeight}" />
                                                    <RowDefinition Height="{Binding TileContentHeight}" />
                                                    <RowDefinition Height="{Binding TileDetailHeight}" />
                                                </Grid.RowDefinitions>
                                                <!-- Tile Title Canvas -->
                                                <Canvas Grid.Row="0"
                                                        Grid.Column="0"
                                                        VerticalAlignment="Top"
                                                        HorizontalAlignment="Left"
                                                        Width="{Binding TileBorderWidth}"
                                                        Height="{Binding TileTitleHeight}">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Loaded">
                                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                                MethodName="ClipTileTitle_Loaded" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                    <!--<Image x:Name="TitleSwirl"
                                                       Canvas.Top="-1"
                                                       Canvas.Left="-1"
                                                       Visibility="Hidden"
                                                       RenderOptions.BitmapScalingMode="HighQuality"
                                                       Stretch="Fill"
                                                       Width="{Binding TileBorderWidth}"
                                                       Height="{Binding TileTitleHeight}"
                                                       Source="{Binding TitleSwirl}" />-->
                                                    <Viewbox VerticalAlignment="Top"
                                                             HorizontalAlignment="Left"
                                                             Stretch="Fill"
                                                             Width="{Binding TileBorderWidth,Mode=TwoWay}"
                                                             Height="{Binding TileTitleHeight,Mode=TwoWay}">
                                                        <Canvas x:Name="TitleSwirlCanvas"
                                                                Visibility="Visible"
                                                                Width="{Binding ClipTileViewModel.TileBorderMinWidth}"
                                                                Height="{Binding ClipTileViewModel.TileTitleHeight}"
                                                                DataContext="{Binding TitleSwirlViewModel}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName="Loaded">
                                                                    <i:CallMethodAction TargetObject="{Binding}"
                                                                                        MethodName="TitleSwirlCanvas_Loaded" />
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                            <Path x:Name="Layer0"
                                                                  StrokeThickness="0"
                                                                  DataContext="{Binding SwirlLayer0}"
                                                                  Fill="{Binding LayerBrush}"
                                                                  Opacity="{Binding LayerOpacity}">
                                                                <Path.Data>
                                                                    <PathGeometry>
                                                                        <PathGeometry.Figures>
                                                                            <PathFigure StartPoint="0,22"
                                                                                        IsClosed="True">
                                                                                <BezierSegment Point1="150,-10"
                                                                                               Point2="180,110"
                                                                                               Point3="270,40" />
                                                                                <LineSegment Point="270,0" />
                                                                                <LineSegment Point="0,0" />
                                                                            </PathFigure>
                                                                        </PathGeometry.Figures>
                                                                    </PathGeometry>
                                                                </Path.Data>
                                                            </Path>
                                                            <Path x:Name="Layer1"
                                                                  StrokeThickness="0"
                                                                  DataContext="{Binding SwirlLayer1}"
                                                                  Fill="{Binding LayerBrush}"
                                                                  Opacity="{Binding LayerOpacity}">
                                                                <Path.Data>
                                                                    <PathGeometry>
                                                                        <PathGeometry.Figures>
                                                                            <PathFigure StartPoint="0,40"
                                                                                        IsClosed="True">
                                                                                <BezierSegment Point1="90,65"
                                                                                               Point2="65,20"
                                                                                               Point3="135,20" />
                                                                                <BezierSegment Point1="205,20"
                                                                                               Point2="180,65"
                                                                                               Point3="270,40" />
                                                                                <LineSegment Point="270,0" />
                                                                                <LineSegment Point="0,0" />
                                                                            </PathFigure>
                                                                        </PathGeometry.Figures>
                                                                    </PathGeometry>
                                                                </Path.Data>
                                                            </Path>
                                                            <Ellipse x:Name="Layer2"
                                                                     StrokeThickness="0"
                                                                     DataContext="{Binding SwirlLayer2}"
                                                                     Fill="{Binding LayerBrush}"
                                                                     Opacity="{Binding LayerOpacity}"
                                                                     Width="84"
                                                                     Height="28"
                                                                     Canvas.Left="171"
                                                                     Canvas.Top="34" />
                                                            <Path x:Name="Layer3"
                                                                  StrokeThickness="0"
                                                                  DataContext="{Binding SwirlLayer3}"
                                                                  Fill="{Binding LayerBrush}"
                                                                  Opacity="{Binding LayerOpacity}">
                                                                <Path.Data>
                                                                    <PathGeometry>
                                                                        <PathGeometry.Figures>
                                                                            <PathFigure StartPoint="0,55"
                                                                                        IsClosed="True">
                                                                                <QuadraticBezierSegment Point1="30,10"
                                                                                                        Point2="270,0" />
                                                                                <LineSegment Point="0,0" />
                                                                            </PathFigure>
                                                                        </PathGeometry.Figures>
                                                                    </PathGeometry>
                                                                </Path.Data>
                                                            </Path>
                                                        </Canvas>
                                                    </Viewbox>

                                                    <Grid x:Name="ClipTileTitleTextGrid"
                                                          Background="{Binding TileTitleTextGridBackgroundBrush}">
                                                        <!-- Clip Title TextBlock -->
                                                        <TextBlock x:Name="ClipTileTitleTextBlock"
                                                                   Text="{Binding CopyItemTitle}"
                                                                   FontSize="{Binding TitleFontSize}"
                                                                   Foreground="White"
                                                                   Background="Transparent"
                                                                   Visibility="{Binding TileTitleTextBlockVisibility}">
                                            <!--<TextBlock.Effect>
                                                <DropShadowEffect ShadowDepth="0.5"
                                                                  Direction="300"
                                                                  Color="Black"
                                                                  Opacity="1.0"
                                                                  BlurRadius="0.1" />
                                            </TextBlock.Effect>-->
                                                        </TextBlock>
                                                        <!-- Clip Title TextBox -->
                                                        <TextBox x:Name="ClipTileTitleTextBox"
                                                                 Background="{StaticResource ClipTileTitleTextBoxBackgroundBrush}"
                                                                 Foreground="Black"
                                                                 FontSize="20"
                                                                 IsReadOnly="False"
                                                                 Visibility="{Binding TileTitleTextBoxVisibility}"
                                                                 Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}" />
                                                    </Grid>
                                                    <Image x:Name="ClipTileAppIconHighlightedBorderImage"
                                                           Source="{Binding CopyItemAppIconHighlightBorder, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                           Stretch="Fill"
                                                           Visibility="{Binding AppIconHighlightBorderVisibility}"
                                                           Width="{Binding TileTitleIconBorderSize}"
                                                           Height="{Binding TileTitleIconBorderSize}">
                                                    </Image>
                                                    <!-- Clip Title Icon Image -->
                                                    <Button x:Name="ClipTileAppIconImageButton"
                                                            Style="{StaticResource Transparent_Button}"
                                                            Visibility="{Binding ClipTileTitleAppIconVisibility}"
                                                            RenderTransformOrigin="0.5,0.5"
                                                            Background="Transparent"
                                                            BorderThickness="0">
                                                        <Button.RenderTransform>
                                                            <RotateTransform x:Name="ClipTileAppIconImageButtonRotateTransform" />
                                                        </Button.RenderTransform>
                                                        <Button.ContextMenu>
                                                            <ContextMenu>
                                                                <MenuItem Header="Exclude Application"
                                                                          Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                          Command="{Binding ExcludeApplicationCommand}" />
                                                                <MenuItem Header="Add Paste Macro For Application"
                                                                          Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                          Command="{Binding MainWindowViewModel.SystemTrayViewModel.ShowSettingsWindowCommand}"
                                                                          CommandParameter="{Binding}" />
                                                            </ContextMenu>
                                                        </Button.ContextMenu>
                                                        <Grid>
                                                            <Image x:Name="ClipTileAppIconBorderImage"
                                                                   Source="{Binding CopyItemAppIconBorder, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                   Stretch="Fill"
                                                                   RenderTransformOrigin="0.5, 0.5"
                                                                   Visibility="Hidden"
                                                                   Width="{Binding TileTitleIconSize}"
                                                                   Height="{Binding TileTitleIconSize}">
                                                                <Image.RenderTransform>
                                                                    <ScaleTransform x:Name="ClipTileAppIconBorderImageScaleTransform" />
                                                                </Image.RenderTransform>
                                                            </Image>
                                                            <Image x:Name="ClipTileAppIconImage"
                                                                   Source="{Binding AppIcon, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                   Stretch="Fill"
                                                                   Width="{Binding TileTitleIconSize}"
                                                                   Height="{Binding TileTitleIconSize}">
                                                            </Image>

                                                        </Grid>
                                                    </Button>
                                                </Canvas>
                                                <!-- Content Container Canvas -->
                                                <Canvas x:Name="ClipTileContentCanvas"
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Width="{Binding TileContentWidth}"
                                                        Height="{Binding TileContentHeight}"
                                                        ToolTipService.InitialShowDelay="1000">
                                                    <!-- RichText Content -->
                                                    <Canvas x:Name="ClipTileRichTextBoxListBoxGridContainerCanvas"
                                                            Visibility="{Binding RtbVisibility}"
                                                            ClipToBounds="True" 
                                                            Height="{Binding TileContentHeight}"
                                                            Width="{Binding TileContentWidth}">
                                                        <Border x:Name="ClipTileEditorToolbar"
                                                                Canvas.Top="{Binding EditRichTextBoxToolbarViewModel.EditBorderCanvasTop, Mode=TwoWay}"
                                                                Visibility="{Binding EditToolbarVisibility}"
                                                                Height="{Binding EditRichTextBoxToolbarHeight}"
                                                                Width="{Binding TileContentWidth}"
                                                                BorderThickness="0,0,0,1"
                                                                BorderBrush="OldLace">
                                                            <StackPanel Orientation="Horizontal"
                                                                        DataContext="{Binding EditRichTextBoxToolbarViewModel}">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Loaded">
                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                            MethodName="ClipTileEditorToolbarBorder_Loaded" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                                <Button x:Name="PrintButton"
                                                                        Template="{StaticResource FlatButtonControlTemplate}"
                                                                        Margin="10,1,0,1">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/Print.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <ComboBox x:Name="FontFamilyCombo"
                                                                          Height="23"
                                                                          Width="100"
                                                                          Margin="5,2,0,2"
                                                                          IsEditable="True"
                                                                          ItemsSource="{Binding SystemFonts}">
                                                                    <ComboBox.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <VirtualizingStackPanel Width="250" />
                                                                        </ItemsPanelTemplate>
                                                                    </ComboBox.ItemsPanel>
                                                                    <ComboBox.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <TextBlock Text="{Binding}"
                                                                                       FontFamily="{Binding}"
                                                                                       FontSize="15"
                                                                                       Height="20" />
                                                                        </DataTemplate>
                                                                    </ComboBox.ItemTemplate>
                                                                </ComboBox>
                                                                <ComboBox x:Name="FontSizeCombo"
                                                                          Height="23"
                                                                          Width="40"
                                                                          Margin="5,2,5,2"
                                                                          IsEditable="True"
                                                                          ItemsSource="{Binding FontSizes}" />
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <Button x:Name="AddTemplateButton"
                                                                        ToolTip="Add Template"
                                                                        Template="{StaticResource FlatButtonControlTemplate}"
                                                                        IsEnabled="{Binding IsAddTemplateButtonEnabled}"
                                                                        Background="{Binding AddTemplateButtonBackgroundBrush}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/templateadd.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <Button x:Name="CutButton"
                                                                        Command="ApplicationCommands.Cut"
                                                                        ToolTip="Cut"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/editcut.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Button x:Name="CopyButton"
                                                                        Command="ApplicationCommands.Copy"
                                                                        ToolTip="Copy"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/editcopy.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Button x:Name="PasteButton"
                                                                        Command="ApplicationCommands.Paste"
                                                                        ToolTip="Paste"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/editpaste.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Button x:Name="UndoButton"
                                                                        Command="ApplicationCommands.Undo"
                                                                        ToolTip="Undo"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/editundo.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Button x:Name="RedoButton"
                                                                        Command="ApplicationCommands.Redo"
                                                                        ToolTip="Redo"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/editredo.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <ToggleButton x:Name="BoldButton"
                                                                              Command="EditingCommands.ToggleBold"
                                                                              ToolTip="Bold"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/fontbold.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <ToggleButton x:Name="ItalicButton"
                                                                              Command="EditingCommands.ToggleItalic"
                                                                              ToolTip="Italic"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/fontitalic.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <ToggleButton x:Name="UnderlineButton"
                                                                              Command="EditingCommands.ToggleUnderline"
                                                                              ToolTip="Underline"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/fontunderline.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <Button x:Name="ForegroundColorButton"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Border x:Name="ForegroundColorButtonBorder">
                                                                        <Image Source="/Resources/Images/MpRichTextBox/Textcolor.png"
                                                                               Stretch="None"
                                                                               Opacity="1"
                                                                               SnapsToDevicePixels="False" />
                                                                    </Border>
                                                                </Button>
                                                                <Button x:Name="BackgroundColorButton"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Border x:Name="BackgroundColorButtonBorder">
                                                                        <Image Source="/Resources/Images/MpRichTextBox/Backcolor.png"
                                                                               Stretch="None"
                                                                               SnapsToDevicePixels="True" />
                                                                    </Border>
                                                                </Button>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <ToggleButton x:Name="LeftButton"
                                                                              Command="EditingCommands.AlignLeft"
                                                                              ToolTip="Align Left"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/alignleft.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <ToggleButton x:Name="CenterButton"
                                                                              Command="EditingCommands.AlignCenter"
                                                                              ToolTip="Align Center"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/aligncenter.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <ToggleButton x:Name="RightButton"
                                                                              Command="EditingCommands.AlignRight"
                                                                              ToolTip="Align Right"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/alignright.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <ToggleButton x:Name="BulletsButton"
                                                                              Command="EditingCommands.ToggleBullets"
                                                                              ToolTip="Bullets"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/listbullets.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <ToggleButton x:Name="NumberingButton"
                                                                              Command="EditingCommands.ToggleNumbering"
                                                                              ToolTip="Numbering"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/listnumbers.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <ToggleButton x:Name="SpellCheck"
                                                                              IsChecked="{Binding UseSpellCheck}"
                                                                              ToolTip="Spell Check?"
                                                                              Template="{StaticResource FlatToggleButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/spellcheck.png"
                                                                           Stretch="Fill"
                                                                           SnapsToDevicePixels="True" />
                                                                </ToggleButton>
                                                                <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                                       Stretch="None"
                                                                       SnapsToDevicePixels="True" />
                                                                <Button x:Name="RefreshDocumentButton"
                                                                        Command="{Binding RefreshDocumentCommand}"
                                                                        ToolTip="Refresh"
                                                                        Template="{StaticResource FlatButtonControlTemplate}">
                                                                    <Image Source="/Resources/Images/MpRichTextBox/arrow_refresh.png"
                                                                           Stretch="None"
                                                                           SnapsToDevicePixels="True" />
                                                                </Button>

                                                                <!--<Button Command="EditingCommands.IncreaseIndentation"
                                                                CommandTarget="{Binding ElementName=RtbListBoxItemRichTextBox}"
                                                                ToolTip="Increase Indentation"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                >
                                                            <Image Source="/Resources/Images/MpRichTextBox/indentincrease.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="EditingCommands.DecreaseIndentation"
                                                                CommandTarget="{Binding ElementName=RtbListBoxItemRichTextBox}"
                                                                ToolTip="Decrease Indentation"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                >
                                                            <Image Source="/Resources/Images/MpRichTextBox/indentdecrease.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>-->
                                                            </StackPanel>
                                                        </Border>
                                                        <Grid x:Name="ClipTileRichTextboxListBoxContainerGrid"
                                                              DataContext="{Binding RichTextBoxViewModelCollection}"
                                                              Canvas.Top="{Binding RichTextBoxViewModelCollection.RtblbCanvasTop}">
                                                            <ScrollViewer x:Name="ClipTileRichTextBoxListBoxScrollViewer"
                                                                          Background="Transparent"
                                                                          VerticalAlignment="Top"
                                                                          HorizontalAlignment="Left"
                                                                          Width="{Binding RtbLbScrollViewerWidth}"
                                                                          Height="{Binding RtbLbScrollViewerHeight}"
                                                                          HorizontalScrollBarVisibility="{Binding HorizontalScrollbarVisibility}"
                                                                          VerticalScrollBarVisibility="{Binding VerticalScrollbarVisibility}">
                                                                <AdornerDecorator>
                                                                    <local:MpMultiSelectListBox x:Name="ClipTilRichTextBoxListBox"
                                                                                           VerticalAlignment="Top"
                                                                                           HorizontalAlignment="Left"
                                                                                           HorizontalContentAlignment="Left"
                                                                                           VerticalContentAlignment="Top"
                                                                                           BorderThickness="0"
                                                                                           BorderBrush="Pink"
                                                                                           SelectionMode="Multiple" 
                                                                                           ScrollToSelectedItem="True"
                                                                                           IsSynchronizedWithCurrentItem="False"
                                                                                           Width="{Binding RtbLbWidth}"
                                                                                           Height="{Binding RtbListBoxHeight}"
                                                                                           Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                                                                                           ItemsSource="{Binding}"
                                                                                           Focusable="True"
                                                                                           IsEnabled="True"
                                                                                           ScrollViewer.CanContentScroll="False"
                                                                                           ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                                           ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                                           VirtualizingPanel.IsVirtualizing="True"
                                                                                           Padding="0">
                                                                        <i:Interaction.Triggers>
                                                                            <i:EventTrigger EventName="Loaded">
                                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                                    MethodName="ClipTileRichTextBoxViewModelCollection_Loaded" />
                                                                            </i:EventTrigger>
                                                                        </i:Interaction.Triggers>
                                                                        <local:MpMultiSelectListBox.InputBindings>
                                                                            <KeyBinding Gesture="Ctrl+A"
                                                                                        Command="{Binding SelectAllCommand}" />
                                                                        </local:MpMultiSelectListBox.InputBindings>
                                                                        <local:MpMultiSelectListBox.Resources>
                                                                            <local:MpBindingProxy x:Key="ClipTileRichTextBoxListBox_Proxy"
                                                                                                  Data="{Binding}" />
                                                                        </local:MpMultiSelectListBox.Resources>
                                                                        <local:MpMultiSelectListBox.ItemsPanel>
                                                                            <ItemsPanelTemplate>
                                                                                <StackPanel IsItemsHost="True"
                                                                                            Orientation="Vertical" />
                                                                            </ItemsPanelTemplate>
                                                                        </local:MpMultiSelectListBox.ItemsPanel>
                                                                        <local:MpMultiSelectListBox.ItemContainerStyle>
                                                                            <Style TargetType="{x:Type ListBoxItem}">
                                                                                <Setter Property="IsSelected"
                                                                                        Value="{Binding IsSubSelected, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" />
                                                                                <Setter Property="FocusVisualStyle"
                                                                                        Value="{x:Null}" />
                                                                                <Setter Property="HorizontalContentAlignment"
                                                                                        Value="Left" />
                                                                                <Setter Property="VerticalContentAlignment"
                                                                                        Value="Top" />
                                                                                <Setter Property="Template">
                                                                                    <Setter.Value>
                                                                                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                                                            <ContentPresenter />
                                                                                        </ControlTemplate>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </Style>
                                                                        </local:MpMultiSelectListBox.ItemContainerStyle>
                                                                        <local:MpMultiSelectListBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <AdornerDecorator Visibility="{Binding SubItemVisibility}"
                                                                                                  DataContext="{Binding}">
                                                                                    <Canvas x:Name="RtbListBoxItemCanvas"
                                                                                            DataContext="{Binding}"
                                                                                            HorizontalAlignment="Left"
                                                                                            VerticalAlignment="Top"
                                                                                            Focusable="{Binding HostClipTileViewModel.IsExpanded}"
                                                                                            Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                                                                                            Width="{Binding RtbCanvasWidth}"
                                                                                            Height="{Binding RtbCanvasHeight}">
                                                                                        <i:Interaction.Triggers>
                                                                                            <i:EventTrigger EventName="Loaded">
                                                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                                                    MethodName="ClipTileRichTextBoxListItemCanvas_Loaded" />
                                                                                            </i:EventTrigger>
                                                                                        </i:Interaction.Triggers>
                                                                                        <Canvas.Resources>
                                                                                            <local:MpBindingProxy x:Key="RtbListBoxItemProxy"
                                                                                                                  Data="{Binding}" />
                                                                                        </Canvas.Resources>
                                                                                        <Canvas.ContextMenu>
                                                                                            <ContextMenu x:Name="RtbItem_ContextMenu"
                                                                                                         DataContext="{Binding Data, Source={StaticResource RtbListBoxItemProxy}}">
                                                                                                <i:Interaction.Triggers>
                                                                                                    <i:EventTrigger EventName="Loaded">
                                                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                                                            MethodName="RtbItem_ContextMenu_Loaded" />
                                                                                                    </i:EventTrigger>
                                                                                                    <i:EventTrigger EventName="Opened">
                                                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                                                            MethodName="RtbItem_ContextMenu_Opened" />
                                                                                                    </i:EventTrigger>
                                                                                                    <i:EventTrigger EventName="Closed">
                                                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                                                            MethodName="RtbItem_ContextMenu_Closed" />
                                                                                                    </i:EventTrigger>
                                                                                                </i:Interaction.Triggers>
                                                                                                <MenuItem Header="_Paste"
                                                                                                          Tag="6"
                                                                                                          Icon="{Binding Source={StaticResource PasteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                          Command="{Binding Data.PasteSubItemCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                <MenuItem Header="Delete"
                                                                                                          Tag="7"
                                                                                                          Icon="{Binding Source={StaticResource DeleteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                          Command="{Binding Data.DeleteSubSelectedClipsCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                <Separator />
                                                                                                <MenuItem Header="_Edit"
                                                                                                          Icon="{Binding Source={StaticResource EditIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                                                                    <MenuItem Header="_Edit Content"
                                                                                                              Tag="20"
                                                                                                              Icon="{Binding Source={StaticResource EditContentIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.ToggleEditSubSelectedItemCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <MenuItem Header="_Rename"
                                                                                                              Tag="21"
                                                                                                              Icon="{Binding Source={StaticResource RenameIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.EditSubTitleCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                    <Separator />
                                                                                                    <MenuItem x:Name="TranslateMenuItem"
                                                                                                              Header="Translate"
                                                                                                              Icon="{Binding Source={StaticResource TranslateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              ItemsSource="{Binding Data.TranslateLanguageMenuItems, Source={StaticResource ClipTrayProxy}}">
                                                                                                        <MenuItem.ItemContainerStyle>
                                                                                                            <Style TargetType="{x:Type MenuItem}">
                                                                                                                <Setter Property="Header"
                                                                                                                        Value="{Binding Header}" />
                                                                                                                <Setter Property="Command"
                                                                                                                        Value="{Binding Command}" />
                                                                                                                <Setter Property="CommandParameter"
                                                                                                                        Value="{Binding CommandParameter}" />
                                                                                                                <Setter Property="HorizontalContentAlignment"
                                                                                                                        Value="Left" />
                                                                                                                <Setter Property="VerticalContentAlignment"
                                                                                                                        Value="Top" />
                                                                                                            </Style>
                                                                                                        </MenuItem.ItemContainerStyle>
                                                                                                    </MenuItem>
                                                                                                </MenuItem>
                                                                                                <MenuItem x:Name="ToolsMenuItem" 
                                                                                                          Header="_Tools"
                                                                                                          Icon="{Binding Source={StaticResource ToolsIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                                                                    <MenuItem Header="Duplicate"
                                                                                                              Tag="22"
                                                                                                              Icon="{Binding Source={StaticResource DuplicateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.DuplicateSubSelectedClipsCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <MenuItem Header="_Merge"
                                                                                                              Tag="17"
                                                                                                              Icon="{Binding Source={StaticResource MergeIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.MergeSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                                                                    <Separator />
                                                                                                    <MenuItem Header="Send as Email"
                                                                                                              Tag="23"
                                                                                                              Icon="{Binding Source={StaticResource EmailIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.SendSubSelectedToEmailCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                    <MenuItem Header="Duplicate As _Qr Code"
                                                                                                              Tag="24"
                                                                                                              Icon="{Binding Source={StaticResource QrIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.CreateQrCodeFromSubSelectedItemCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                    <Separator />
                                                                                                    <MenuItem Header="Say"
                                                                                                              Tag="16"
                                                                                                              Icon="{Binding Source={StaticResource SpeakIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.SpeakSubSelectedClipsAsyncCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <Separator />
                                                                                                    <MenuItem Header="Search"
                                                                                                              Icon="{Binding Source={StaticResource SearchIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                                                                        <MenuItem Header="_Google"
                                                                                                                  Icon="{Binding Source={StaticResource GoogleIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}"
                                                                                                                  CommandParameter="https://www.google.com/search?q=" />
                                                                                                        <MenuItem Header="_Bing"
                                                                                                                  Icon="{Binding Source={StaticResource BingIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}"
                                                                                                                  CommandParameter="https://www.bing.com/search?q=" />
                                                                                                        <MenuItem Header="_DuckDuckGo"
                                                                                                                  Icon="{Binding Source={StaticResource DuckIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}"
                                                                                                                  CommandParameter="https://duckduckgo.com/?q=" />
                                                                                                        <MenuItem Header="_Yandex"
                                                                                                                  Icon="{Binding Source={StaticResource YandexIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                  Command="{Binding Data.SearchWebCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}"
                                                                                                                  CommandParameter="https://yandex.com/search/?text=" />
                                                                                                    </MenuItem>
                                                                                                    <Separator />
                                                                                                    <MenuItem x:Name="ExcludeApplication"
                                                                                                              Header="Exclude Application"
                                                                                                              Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.ExcludeSubSelectedItemApplicationCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                    <MenuItem Header="Add Paste Macro For Application"
                                                                                                              Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding MainWindowViewModel.SystemTrayViewModel.ShowSettingsWindowCommand}"
                                                                                                              CommandParameter="{Binding}" />
                                                                                                </MenuItem>
                                                                                                <MenuItem Header="_Selection"
                                                                                                          Icon="{Binding Source={StaticResource SelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                                                                                                    <MenuItem Header="_Bring to Front"
                                                                                                              Tag="12"
                                                                                                              Icon="{Binding Source={StaticResource BringToFrontIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.BringSubSelectedClipTilesToFrontCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <MenuItem Header="_Send to Back"
                                                                                                              Tag="13"
                                                                                                              Icon="{Binding Source={StaticResource SendToBackIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.SendSubSelectedClipTilesToBackCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <Separator />
                                                                                                    <MenuItem Header="Select _All"
                                                                                                              Tag="10"
                                                                                                              Icon="{Binding Source={StaticResource SelectAllIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.SelectAllCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                    <MenuItem Header="_Invert Selection"
                                                                                                              Tag="11"
                                                                                                              Icon="{Binding Source={StaticResource InvertSelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                              Command="{Binding Data.InvertSubSelectionCommand, Source={StaticResource ClipTileRichTextBoxListBox_Proxy}}" />
                                                                                                </MenuItem>
                                                                                                <MenuItem Header="_Hotkey"
                                                                                                          Tag="14"
                                                                                                          Icon="{Binding Source={StaticResource HotkeyIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                          InputGestureText="{Binding ShortcutKeyString}"
                                                                                                          Command="{Binding Data.AssignHotkeyToSubSelectedItemCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                <Separator />
                                                                                                <MenuItem x:Name="ClipTileColorContextMenuItem"
                                                                                                          Style="{StaticResource MenuItemStyle}" />
                                                                                                <Separator />
                                                                                                <MenuItem x:Name="PasteToAppPathMenuItem"
                                                                                                          Header="Paste To Application"
                                                                                                          Icon="{Binding Source={StaticResource PasteToAppIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"/>
                                                                                                <Separator />
                                                                                                <MenuItem Header="Pin To _Collection"
                                                                                                          Icon="{Binding Source={StaticResource PinToCollectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                          ItemsSource="{Binding Data.TagMenuItems, Source={StaticResource RtbListBoxItemProxy}}">
                                                                                                    <MenuItem.ItemContainerStyle>
                                                                                                        <Style TargetType="{x:Type MenuItem}">
                                                                                                            <Setter Property="Header"
                                                                                                                    Value="{Binding Header}" />
                                                                                                            <Setter Property="Command"
                                                                                                                    Value="{Binding Command}" />
                                                                                                            <Setter Property="CommandParameter"
                                                                                                                    Value="{Binding CommandParameter}" />
                                                                                                            <Setter Property="IsCheckable"
                                                                                                                    Value="True" />
                                                                                                            <Setter Property="IsChecked"
                                                                                                                    Value="{Binding IsChecked}" />
                                                                                                            <Setter Property="HorizontalContentAlignment"
                                                                                                                    Value="Left" />
                                                                                                            <Setter Property="VerticalContentAlignment"
                                                                                                                    Value="Top" />
                                                                                                        </Style>
                                                                                                    </MenuItem.ItemContainerStyle>
                                                                                                </MenuItem>
                                                                                            </ContextMenu>
                                                                                        </Canvas.ContextMenu>
                                                                                        <AdornerDecorator DataContext="{Binding}">
                                                                                            <RichTextBox x:Name="RtbListBoxItemRichTextBox"
                                                                                                         Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                                                                                                         IsReadOnly="{Binding HostClipTileViewModel.IsRtbReadOnly}"
                                                                                                         IsEnabled="True" 
                                                                                                         AllowDrop="False" 
                                                                                                         AutoWordSelection="False"
                                                                                                         IsInactiveSelectionHighlightEnabled="True"
                                                                                                         IsDocumentEnabled="True"
                                                                                                         Focusable="{Binding HostClipTileViewModel.IsEditingTile}"
                                                                                                         Cursor="{Binding RtbListBoxItemCursor}"
                                                                                                         Width="{Binding RtbWidth}"
                                                                                                         Height="{Binding RtbHeight}"
                                                                                                         Padding="{Binding RtbPadding}"
                                                                                                         local:MpDocumentRtfExtension.DocumentRtf="{Binding CopyItemRichText, UpdateSourceTrigger=LostFocus,NotifyOnSourceUpdated=True}"
                                                                                                         IsUndoEnabled="True"
                                                                                                         VerticalAlignment="Top"
                                                                                                         HorizontalAlignment="Left"
                                                                                                         ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                                                         ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                                                         BorderThickness="0">
                                                                                                <RichTextBox.Resources>
                                                                                                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                                                                                                     Color="Blue" />
                                                                                                </RichTextBox.Resources>
                                                                                                <SpellCheck.IsEnabled>
                                                                                                    <Binding Path="Data.EditRichTextBoxToolbarViewModel.UseSpellCheck"
                                                                                                             Source="{StaticResource ClipTileProxy}" />
                                                                                                </SpellCheck.IsEnabled>
                                                                                            </RichTextBox>
                                                                                        </AdornerDecorator>
                                                                                        <local:MpClipBorder x:Name="RtbListBoxItemOverlayBorder"
                                                                                                            DataContext="{Binding}"
                                                                                                            Visibility="{Binding SubItemOverlayVisibility}"
                                                                                                            Width="{Binding RtbCanvasWidth}"
                                                                                                            Height="{Binding RtbCanvasHeight}"
                                                                                                            Background="{Binding RtbListBoxItemBackgroundColor}"
                                                                                                            ToolTipService.InitialShowDelay="750"
                                                                                                            BorderBrush="{Binding RtbOverlayBorderBrush}"
                                                                                                            BorderThickness="1"
                                                                                                            CornerRadius="5">
                                                                                            <local:MpClipBorder.ToolTip>
                                                                                                <ToolTip x:Name="ClipTileTooltip"
                                                                                                         Visibility="{Binding SubItemToolTipVisibility}"
                                                                                                         Placement="Top"
                                                                                                         HorizontalOffset="{Binding HostClipTileViewModel.TileBorderWidth}">
                                                                                                    <ToolTip.Template>
                                                                                                        <ControlTemplate>
                                                                                                            <Border Background="White"
                                                                                                                    BorderThickness="1"
                                                                                                                    BorderBrush="Black"
                                                                                                                    Padding="5">
                                                                                                                <Image Stretch="Fill"
                                                                                                                       HorizontalAlignment="Center"
                                                                                                                       VerticalAlignment="Center"
                                                                                                                       Source="{Binding Data.CopyItemBmp,Source={StaticResource ClipTileProxy}}" />
                                                                                                            </Border>
                                                                                                        </ControlTemplate>
                                                                                                    </ToolTip.Template>
                                                                                                </ToolTip>
                                                                                            </local:MpClipBorder.ToolTip>
                                                                                            <DockPanel x:Name="RtbListItemOverlayBorderDockPanel"
                                                                                                       DataContext="{Binding}"
                                                                                                       Width="{Binding RtbCanvasWidth}"
                                                                                                       Height="{Binding RtbCanvasHeight}">
                                                                                                <DockPanel DockPanel.Dock="Left">
                                                                                                    <Button x:Name="RtbListBoxItemOverlayBorderGridDragButton"
                                                                                                            DockPanel.Dock="Top"
                                                                                                            BorderThickness="0"
                                                                                                            Cursor="SizeAll"
                                                                                                            Margin="0,0,0,0"
                                                                                                            Background="Transparent"
                                                                                                            VerticalAlignment="Top"
                                                                                                            VerticalContentAlignment="Top"
                                                                                                            HorizontalAlignment="Left"
                                                                                                            HorizontalContentAlignment="Left"
                                                                                                            Width="{Binding DragButtonSize}"
                                                                                                            Height="{Binding DragButtonSize}"
                                                                                                            Template="{StaticResource SearchButtonControlTemplate}">
                                                                                                        <Image HorizontalAlignment="Left"
                                                                                                               Source="/Resources/Images/burger.png"
                                                                                                               Stretch="Fill" />
                                                                                                    </Button>
                                                                                                    <Button x:Name="RtbListboxItemHotkeyButton"
                                                                                                            DockPanel.Dock="Bottom"
                                                                                                            VerticalAlignment="Bottom"
                                                                                                            VerticalContentAlignment="Bottom"
                                                                                                            HorizontalAlignment="Center"
                                                                                                            HorizontalContentAlignment="Center"
                                                                                                            Width="14"
                                                                                                            Height="14"
                                                                                                            Margin="0,0,0,0"
                                                                                                            ToolTipService.InitialShowDelay="0"
                                                                                                            ToolTip="{Binding HotkeyIconTooltip}"
                                                                                                            Command="{Binding Data.AssignHotkeyToSubSelectedItemCommand, Source={StaticResource RtbListBoxItemProxy}}"
                                                                                                            Visibility="{Binding SubItemOverlayVisibility}"
                                                                                                            Template="{StaticResource SearchButtonControlTemplate}">
                                                                                                        <Image Source="{Binding HotkeyIconSource}" />
                                                                                                    </Button>
                                                                                                </DockPanel>
                                                                                                <DockPanel DockPanel.Dock="Right">
                                                                                                    <TextBlock x:Name="RtbListBoxItemTitleTextBlock"
                                                                                                               DockPanel.Dock="Top"
                                                                                                               Opacity="1"
                                                                                                               Margin="0,0,25,0"
                                                                                                               TextAlignment="Right"
                                                                                                               HorizontalAlignment="Right"
                                                                                                               VerticalAlignment="Top"
                                                                                                               Cursor="IBeam"
                                                                                                               ToolTip="{Binding DetailText}"
                                                                                                               Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}"
                                                                                                               FontSize="{Binding RtbListBoxItemTitleFontSize}"
                                                                                                               Foreground="{Binding RtbListBoxItemTitleTextBlockTextColor}"
                                                                                                               FontWeight="Bold"
                                                                                                               Background="Transparent"
                                                                                                               Visibility="{Binding RtbListBoxItemTitleTextBlockVisibility}">
                                                                                                    <!--<TextBlock.Effect>
                                                                                                        <DropShadowEffect ShadowDepth="2"
                                                                                                                          Direction="300"
                                                                                                                          Color="Black"
                                                                                                                          Opacity="1.0"
                                                                                                                          BlurRadius="3" />
                                                                                                    </TextBlock.Effect>-->
                                                                                                    </TextBlock>
                                                                                                    <TextBox x:Name="RtbListBoxItemTitleTextBox"
                                                                                                             DockPanel.Dock="Top"
                                                                                                             Opacity="1"
                                                                                                             Margin="0,0,25,0"
                                                                                                             TextAlignment="Right"
                                                                                                             VerticalAlignment="Top"
                                                                                                             HorizontalAlignment="Right"
                                                                                                             Background="White"
                                                                                                             Foreground="Black"
                                                                                                             FontSize="{Binding RtbListBoxItemTitleFontSize}"
                                                                                                             IsReadOnly="False"
                                                                                                             Visibility="{Binding RtbListBoxItemTitleTextBoxVisibility}"
                                                                                                             Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}" />
                                                                                                    <!-- Clip Title Icon Image -->
                                                                                                    <Button x:Name="RtbItemAppIconImageButton"
                                                                                                            DockPanel.Dock="Bottom"
                                                                                                            HorizontalAlignment="Right"
                                                                                                            Margin="0,0,25,3"
                                                                                                            Style="{StaticResource Transparent_Button}"
                                                                                                            Visibility="{Binding SubItemOverlayVisibility}"
                                                                                                            Background="Transparent"
                                                                                                            BorderThickness="0">
                                                                                                        <Button.ContextMenu>
                                                                                                            <ContextMenu>
                                                                                                                <MenuItem Header="Exclude Application"
                                                                                                                          Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                          Command="{Binding Data.ExcludeSubSelectedItemApplicationCommand, Source={StaticResource RtbListBoxItemProxy}}" />
                                                                                                                <MenuItem Header="Add Paste Macro For Application"
                                                                                                                          Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                                                                                          Command="{Binding MainWindowViewModel.SystemTrayViewModel.ShowSettingsWindowCommand}"
                                                                                                                          CommandParameter="{Binding}" />
                                                                                                            </ContextMenu>
                                                                                                        </Button.ContextMenu>
                                                                                                        <Grid>
                                                                                                            <Image x:Name="RtbItemAppIconBorderImage"
                                                                                                                   Source="{Binding CopyItemAppIconBorder, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                                                                   Stretch="Fill"
                                                                                                                   RenderTransformOrigin="0.5, 0.5"
                                                                                                                   Visibility="Hidden"
                                                                                                                   Width="{Binding SubItemAppIconSize}"
                                                                                                                   Height="{Binding SubItemAppIconSize}">
                                                                                                                <Image.RenderTransform>
                                                                                                                    <ScaleTransform x:Name="RtbItemAppIconBorderImageScaleTransform" />
                                                                                                                </Image.RenderTransform>
                                                                                                            </Image>
                                                                                                            <Image x:Name="RtbItemAppIconImage"
                                                                                                                   Source="{Binding AppIcon, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                                                                   Stretch="Fill"
                                                                                                                   Width="{Binding SubItemAppIconSize}"
                                                                                                                   Height="{Binding SubItemAppIconSize}">
                                                                                                            </Image>

                                                                                                        </Grid>
                                                                                                    </Button>
                                                                                                </DockPanel>                                                                                                
                                                                                            </DockPanel>
                                                                                        </local:MpClipBorder>
                                                                                    </Canvas>
                                                                                </AdornerDecorator>
                                                                            </DataTemplate>
                                                                        </local:MpMultiSelectListBox.ItemTemplate>
                                                                    </local:MpMultiSelectListBox>
                                                                </AdornerDecorator>
                                                            </ScrollViewer>
                                                        </Grid>
                                                        <Border x:Name="ClipTileEditTemplateToolbar"
                                                                Visibility="{Binding EditTemplateToolbarVisibility}"
                                                                Canvas.Top="{Binding EditTemplateToolbarViewModel.EditTemplateBorderCanvasTop, Mode=TwoWay}"
                                                                Height="{Binding EditTemplateToolbarHeight}"
                                                                Width="{Binding TileContentWidth}"
                                                                CornerRadius="10,0,0,10"
                                                                BorderThickness="0"
                                                                Background="LightBlue">
                                                            <Grid DataContext="{Binding EditTemplateToolbarViewModel}">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Loaded">
                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                            MethodName="EditTemplateToolbarBorderGrid_Loaded" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="0.5*" />
                                                                    <ColumnDefinition Width="3*" />
                                                                    <ColumnDefinition Width="1.2*" />
                                                                </Grid.ColumnDefinitions>
                                                                <Button x:Name="TemplateColorButton"
                                                                        Grid.Column="0"
                                                                        Background="{Binding SelectedTemplateHyperlinkViewModel.TemplateBrush, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                        Width="20"
                                                                        Height="20"
                                                                        VerticalAlignment="Center"
                                                                        Margin="10,0,0,0"
                                                                        BorderBrush="Black"
                                                                        BorderThickness="1" />
                                                                <StackPanel Orientation="Horizontal"
                                                                            Grid.Column="1">
                                                                    <TextBox x:Name="TemplateNameEditorTextBox"
                                                                             Foreground="Black"
                                                                             HorizontalAlignment="Left"
                                                                             VerticalAlignment="Center"
                                                                             VerticalContentAlignment="Top"
                                                                             BorderBrush="{Binding SelectedTemplateNameTextBoxBorderBrush}"
                                                                             BorderThickness="2"
                                                                             Text="{Binding SelectedTemplateHyperlinkViewModel.TemplateName, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                             FontSize="14"
                                                                             Height="25"
                                                                             MinWidth="200"
                                                                             IsReadOnly="False"
                                                                             Margin="0,0,0,0"
                                                                             Padding="0,0,0,0" />
                                                                    <TextBlock x:Name="TemplateNameValidationTextBlock"
                                                                               Text="{Binding ValidationText}"
                                                                               Visibility="{Binding ValidationVisibility}"
                                                                               Foreground="Red"
                                                                               FontStyle="Oblique"
                                                                               HorizontalAlignment="Right"
                                                                               VerticalAlignment="Stretch"
                                                                               TextWrapping="Wrap"
                                                                               FontSize="12"
                                                                               Padding="0,0,0,0"
                                                                               Margin="5,0,0,0"
                                                                               Width="300" />
                                                                </StackPanel>
                                                                <StackPanel Orientation="Horizontal"
                                                                            Grid.Column="2"
                                                                            HorizontalAlignment="Center"
                                                                            Margin="0,0,0,0">
                                                                    <Button x:Name="CancelButton"
                                                                            Margin="10,7,10,7"
                                                                            Padding="5,0,5,0"
                                                                            FontSize="14"
                                                                            Content="CANCEL"
                                                                            IsCancel="True"
                                                                            HorizontalAlignment="Stretch"
                                                                            Command="{Binding CancelCommand}" />
                                                                    <Button x:Name="OkButton"
                                                                            Margin="0,7,10,7"
                                                                            Padding="5,0,5,0"
                                                                            FontSize="14"
                                                                            Content="DONE"
                                                                            HorizontalAlignment="Stretch"
                                                                            Command="{Binding OkCommand}"
                                                                            IsDefault="True" />
                                                                </StackPanel>
                                                            </Grid>
                                                        </Border>
                                                        <Border x:Name="ClipTilePasteTemplateToolbar"
                                                                Canvas.Top="{Binding PasteTemplateToolbarViewModel.PasteTemplateBorderCanvasTop, Mode=TwoWay, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged,NotifyOnTargetUpdated=True}"
                                                                Width="{Binding TileContentWidth}"
                                                                Height="{Binding PasteTemplateToolbarHeight}"
                                                                CornerRadius="5"
                                                                BorderThickness="0"
                                                                Background="LightBlue"
                                                                Visibility="{Binding PasteTemplateToolbarVisibility}">
                                                            <Grid x:Name="PasteTemplateToolbarGrid"
                                                                  DataContext="{Binding PasteTemplateToolbarViewModel}">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Loaded">
                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                            MethodName="ClipTilePasteTemplateToolbarBorder_Loaded" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="2*" />
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="3*" />
                                                                    <ColumnDefinition Width="0.7*" />
                                                                    <ColumnDefinition Width="*" />
                                                                </Grid.ColumnDefinitions>
                                                                <local:MpClipBorder x:Name="SelectedTemplateComboBoxBorder"
                                                                                    Grid.Column="0"
                                                                                    HorizontalAlignment="Center"
                                                                                    Background="{Binding SelectedTemplateBrush}"
                                                                                    CornerRadius="15"
                                                                                    Margin="0,3,0,3">
                                                                    <ComboBox x:Name="SelectedTemplateComboBox"
                                                                              FontSize="14"
                                                                              Background="Transparent"
                                                                              HorizontalContentAlignment="Left"
                                                                              VerticalContentAlignment="Center"
                                                                              SelectedItem="{Binding SelectedTemplate, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                              ItemsSource="{Binding UniqueTemplateHyperlinkViewModelListByDocOrder}">
                                                                        <ComboBox.ItemTemplate>
                                                                            <ItemContainerTemplate>
                                                                                <DockPanel>
                                                                                    <Border Background="{Binding TemplateBrush}"
                                                                                            BorderBrush="Black"
                                                                                            DockPanel.Dock="Left"
                                                                                            Height="15"
                                                                                            Width="15"
                                                                                            BorderThickness="1"
                                                                                            CornerRadius="10" />
                                                                                    <TextBlock DockPanel.Dock="Right"
                                                                                               Text="{Binding TemplateDisplayName}" />
                                                                                </DockPanel>
                                                                            </ItemContainerTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>
                                                                </local:MpClipBorder>
                                                                <Button x:Name="ClearAllTemplatesButton"
                                                                        Grid.Column="1"
                                                                        TabIndex="0"
                                                                        Visibility="{Binding ClearAllTemplateToolbarButtonVisibility}"
                                                                        Command="{Binding ClearAllTemplatesCommand}"
                                                                        Margin="3,0,3,0"
                                                                        Padding="0,0,0,0"
                                                                        FontSize="12"
                                                                        VerticalContentAlignment="Top"
                                                                        VerticalAlignment="Center"
                                                                        Content="CLEAR ALL" />
                                                                <local:MpClipBorder Grid.Column="2"
                                                                                    CornerRadius="10"
                                                                                    Background="White"
                                                                                    BorderThickness="0.5"
                                                                                    BorderBrush="DimGray"
                                                                                    Margin="1"
                                                                                    Padding="0"
                                                                                    VerticalAlignment="Center"
                                                                                    HorizontalAlignment="Stretch">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="*" />
                                                                            <ColumnDefinition Width="0.1*" />
                                                                        </Grid.ColumnDefinitions>
                                                                        <TextBox x:Name="SelectedTemplateTextBox"
                                                                                 Grid.Column="0"
                                                                                 TabIndex="1"
                                                                                 BorderThickness="0"
                                                                                 Text="{Binding SelectedTemplateText, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                                 FontStyle="{Binding SelectedTemplateTextBoxFontStyle}"
                                                                                 Foreground="{Binding SelectedTemplateTextBrush}"
                                                                                 FontSize="16"
                                                                                 Height="24"
                                                                                 Width="240"
                                                                                 Padding="0,0,0,0"
                                                                                 Margin="5,0,0,0"
                                                                                 VerticalAlignment="Top"
                                                                                 HorizontalAlignment="Left"
                                                                                 VerticalContentAlignment="Top" />
                                                                        <Button x:Name="ClearCurrentTemplateButton"
                                                                                Grid.Column="1"
                                                                                Visibility="{Binding ClearSelectedTemplateTextboxButtonVisibility}"
                                                                                Command="{Binding ClearCurrentTemplatesCommand}"
                                                                                Background="Transparent"
                                                                                BorderThickness="0"
                                                                                Width="15"
                                                                                Height="15">
                                                                            <Image x:Name="ClearCurrentTemplateButtonImage"
                                                                                   Source="/Resources/Images/close1.png" />
                                                                        </Button>
                                                                    </Grid>
                                                                </local:MpClipBorder>
                                                                <StackPanel Orientation="Horizontal"
                                                                            Grid.Column="3"
                                                                            Visibility="{Binding PasteTemplateNavigationButtonStackVisibility}"
                                                                            HorizontalAlignment="Center"
                                                                            Margin="8,0,0,0">
                                                                    <Button x:Name="PreviousTemplateButton"
                                                                            TabIndex="2"
                                                                            Command="{Binding PreviousTemplateTokenCommand}"
                                                                            Width="20"
                                                                            Height="20"
                                                                            Margin="0"
                                                                            Padding="5">
                                                                        <Image Source="/Resources/Images/back_black.png" />
                                                                    </Button>
                                                                    <Button x:Name="NextTemplateButton"
                                                                            TabIndex="3"
                                                                            Command="{Binding NextTemplateTokenCommand}"
                                                                            Width="20"
                                                                            Height="20"
                                                                            Margin="1"
                                                                            Padding="5">
                                                                        <Image Source="/Resources/Images/forward_black.png" />
                                                                    </Button>
                                                                </StackPanel>
                                                                <Button x:Name="PasteTemplateButton"
                                                                        Grid.Column="4"
                                                                        TabIndex="4"
                                                                        IsEnabled="{Binding IsTemplateReadyToPaste}"
                                                                        Command="{Binding PasteTemplateCommand}"
                                                                        Margin="15,0,15,0"
                                                                        Padding="0,0,0,0"
                                                                        FontSize="12"
                                                                        VerticalContentAlignment="Top"
                                                                        VerticalAlignment="Center"
                                                                        Content="PASTE" />
                                                            </Grid>
                                                        </Border>
                                                    </Canvas>
                                                    <!-- Image Content-->
                                                    <Grid Margin="0"
                                                          Background="Transparent"
                                                          Height="{Binding TileContentHeight}"
                                                          Width="{Binding TileContentWidth}"
                                                          Visibility="{Binding ImgVisibility}"
                                                          Focusable="{Binding IsSelected}"
                                                          IsEnabled="{Binding IsSelected}">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="Loaded">
                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                    MethodName="ClipTileImageCanvas_Loaded" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                        <Viewbox x:Name="ClipTileImageItemsControlViewBox"
                                                                 Height="{Binding TileContentHeight}"
                                                                 Width="{Binding TileContentWidth}">
                                                            <ItemsControl x:Name="ClipTileImageDetectedObjectItemscontrol"
                                                                          Background="{Binding CopyItemBmpImageBrush}"
                                                                          DataContext="{Binding DetectedImageObjectCollectionViewModel}"
                                                                          Width="{Binding CopyItemBmpWidth}"
                                                                          Height="{Binding CopyItemBmpHeight}"
                                                                          ItemsSource="{Binding}">
                                                                <ItemsControl.Resources>
                                                                    <DataTemplate DataType="{x:Type local:MpDetectedImageObjectViewModel}">
                                                                        <Border Width="{Binding Width}"
                                                                                Height="{Binding Height}"
                                                                                BorderThickness="3"
                                                                                BorderBrush="{Binding BorderBrush}"
                                                                                Background="Transparent">
                                                                            <!--<Border.Resources>
                                                                                <local:MpBindingProxy x:Key="DetectedImageObjectProxy"
                                                                                                      Data="{Binding}" />
                                                                            </Border.Resources>-->
                                                                            <!--<Border.Visibility>
                                                                        <Binding Path="Data.TileDetectedImageItemsVisibility"
                                                                                 Source="{StaticResource ClipTileProxy}" />
                                                                    </Border.Visibility>-->
                                                                            <!--<Border.RenderTransform>
                                                                                <TranslateTransform X="{Binding Data.X, Source={StaticResource DetectedImageObjectProxy}}"
                                                                                                    Y="{Binding Data.Y, Source={StaticResource DetectedImageObjectProxy}}" />
                                                                            </Border.RenderTransform>
                                                                            <i:Interaction.Triggers>
                                                                                <i:EventTrigger EventName="Loaded">
                                                                                    <i:CallMethodAction TargetObject="{Binding}"
                                                                                                        MethodName="ClipTileImageDetectedObjectCanvas_Loaded" />
                                                                                </i:EventTrigger>
                                                                            </i:Interaction.Triggers>
                                                                            <TextBox HorizontalAlignment="Center"
                                                                                     VerticalAlignment="Center"
                                                                                     HorizontalContentAlignment="Center"
                                                                                     VerticalContentAlignment="Center"
                                                                                     Text="{Binding ObjectTypeName, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                                     FontSize="{Binding FontSize}"
                                                                                     IsReadOnly="{Binding IsNameReadOnly}"
                                                                                     Background="{StaticResource ClipTileDetectedObjectTextBoxBackgroundBrush}"
                                                                                     Foreground="White" />-->
                                                                        </Border>
                                                                    </DataTemplate>
                                                                </ItemsControl.Resources>
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Loaded">
                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                            MethodName="ClipTileImageDetectedObjectItemscontrol_Loaded" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                                <ItemsControl.ItemsPanel>
                                                                    <ItemsPanelTemplate>
                                                                        <Canvas x:Name="ClipTileImageDetectedObjectsCanvas"
                                                                                Width="{Binding Data.DetectedImageObjectCollectionViewModel.CopyItemBmpWidth, Source={StaticResource ClipTileProxy}}"
                                                                                Height="{Binding Data.DetectedImageObjectCollectionViewModel.CopyItemBmpHeight, Source={StaticResource ClipTileProxy}}"
                                                                                HorizontalAlignment="Center"
                                                                                IsItemsHost="True"
                                                                                VerticalAlignment="Center" />
                                                                    </ItemsPanelTemplate>
                                                                </ItemsControl.ItemsPanel>
                                                            </ItemsControl>
                                                        </Viewbox>
                                                    </Grid>
                                                    <!--File List Content -->
                                                    <local:MpMultiSelectListBox x:Name="ClipTileFileListBox"
                                                             SelectionMode="Extended"
                                                             ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                             ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                             Width="{Binding TileBorderWidth}"
                                                             Height="{Binding TileContentHeight}"
                                                             ItemsSource="{Binding FileListCollectionViewModel}"
                                                             Visibility="{Binding FileListVisibility}"
                                                             IsEnabled="{Binding IsSelected, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                             BorderThickness="0"
                                                             Focusable="False">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="Loaded">
                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                    MethodName="ClipTileFileListBox_Loaded" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                        <ListBox.ItemContainerStyle>
                                                            <Style TargetType="{x:Type ListBoxItem}">
                                                                <Setter Property="IsSelected"
                                                                        Value="{Binding IsSubSelected, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" />
                                                                <Setter Property="HorizontalContentAlignment"
                                                                        Value="Left" />
                                                                <Setter Property="VerticalContentAlignment"
                                                                        Value="Top" />
                                                            </Style>
                                                        </ListBox.ItemContainerStyle>
                                                        <ListBox.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Height="22"
                                                                        BorderThickness="0">
                                                                    <Grid>
                                                                        <StackPanel Visibility="{Binding Data.FileListStackPanelVisibility, Source={StaticResource ClipTileProxy}}"
                                                                                    VerticalAlignment="Center"
                                                                                    HorizontalAlignment="Left"
                                                                                    ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                                    ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                                    Orientation="Horizontal">
                                                                            <Image Source="{Binding Icon, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                                   Height="22"
                                                                                   Stretch="Fill" />
                                                                            <TextBlock x:Name="FileListItemTextBlock"
                                                                                       Margin="3,0,0,0"
                                                                                       VerticalAlignment="Center"
                                                                                       HorizontalAlignment="Left"
                                                                                       ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                                       ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                                       FontSize="16"
                                                                                       Foreground="Black"
                                                                                       Background="Transparent">
                                                                                <TextBlock.ToolTip>
                                                                                    <ToolTip>
                                                                                        <TextBlock Text="{Binding ItemPath}" />
                                                                                    </ToolTip>
                                                                                </TextBlock.ToolTip>
                                                                                <i:Interaction.Triggers>
                                                                                    <i:EventTrigger EventName="Loaded">
                                                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                                                            MethodName="FileListItemTextBlock_Loaded" />
                                                                                    </i:EventTrigger>
                                                                                </i:Interaction.Triggers>
                                                                        </TextBlock>
                                                                        </StackPanel>
                                                                        <WebBrowser x:Name="FileItemMoonPdfPanel"
                                                                                          Visibility="{Binding Data.WebBrowserFileViewerVisibility, Source={StaticResource ClipTileProxy}}"
                                                                                          VerticalAlignment="Center"
                                                                                          HorizontalAlignment="Center"
                                                                                          ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                                          ScrollViewer.VerticalScrollBarVisibility="Hidden">
                                                                            <i:Interaction.Triggers>
                                                                                <i:EventTrigger EventName="Loaded">
                                                                                    <i:CallMethodAction TargetObject="{Binding}"
                                                                                                        MethodName="FileItemWebBrowser_Loaded" />
                                                                                </i:EventTrigger>
                                                                            </i:Interaction.Triggers>
                                                                        </WebBrowser>
                                                                    </Grid>
                                                                </Border>
                                                            </DataTemplate>
                                                        </ListBox.ItemTemplate>
                                                    </local:MpMultiSelectListBox>
                                                </Canvas>
                                                <!-- Selection Overlay Grid -->
                                                <Grid x:Name="ClipTileSelectionOverlayGrid"
                                                      Grid.Row="1"
                                                      Grid.Column="0"
                                                      Background="Magenta"
                                                      Width="{Binding TileContentWidth}"
                                                      Visibility="{Binding SelectionOverlayGridVisibility}"
                                                      Opacity="0">
                                                    <Grid.ToolTip>
                                                        <ToolTip Visibility="{Binding ToolTipVisibility}"
                                                                 Opacity="1"
                                                                 Placement="Top">
                                                            <ToolTip.Template>
                                                                <ControlTemplate>
                                                                    <local:MpClipBorder Background="White"
                                                                                        BorderThickness="1"
                                                                                        BorderBrush="Black"
                                                                                        Padding="5">
                                                                        <Image x:Name="ItemTooltipImage"
                                                                               Stretch="Fill"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"
                                                                               Source="{Binding Path=DataContext.CopyItemBmp,RelativeSource={RelativeSource TemplatedParent}}" />
                                                                    </local:MpClipBorder>
                                                                </ControlTemplate>
                                                            </ToolTip.Template>
                                                        </ToolTip>
                                                    </Grid.ToolTip>
                                                </Grid>
                                                <!-- Tile Detail Grid -->
                                                <Border Grid.Row="2"
                                                        Visibility="{Binding DetailGridVisibility}"
                                                        Background="Transparent"
                                                        BorderThickness="0,0,0,0"
                                                        BorderBrush="LightGray">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="auto" />
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="Loaded">
                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                    MethodName="ClipTileDetailGrid_Loaded" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                        <Button x:Name="ClipTileHotkeyButton"
                                                                Grid.Column="0"
                                                                HorizontalAlignment="Left"
                                                                Width="20"
                                                                Height="20"
                                                                ToolTipService.InitialShowDelay="0"
                                                                ToolTip="{Binding HotkeyIconTooltip}"
                                                                Margin="0,-5,2,0"
                                                                Command="{Binding Data.AssignHotkeyCommand, Source={StaticResource ClipTileProxy}}"
                                                                Visibility="{Binding ToggleEditModeButtonVisibility}"
                                                                Template="{StaticResource SearchButtonControlTemplate}">
                                                            <Image Source="{Binding HotkeyIconSource}" />
                                                        </Button>
                                                        <TextBlock x:Name="ClipTileTitleDetailTextBlock"
                                                                   Grid.Column="1"
                                                                   Background="Transparent"
                                                                   Foreground="{Binding DetailTextColor}"
                                                                   FontSize="10"
                                                                   HorizontalAlignment="Center"
                                                                   Text="{Binding DetailText}" />
                                                        <ToggleButton x:Name="ClipTileToggleEditButton"
                                                                      Grid.Column="2"
                                                                      HorizontalAlignment="Right"
                                                                      Width="20"
                                                                      Height="20"
                                                                      Margin="0,-5,2,0"
                                                                      Visibility="{Binding ToggleEditModeButtonVisibility}"
                                                                      IsChecked="{Binding IsEditingTile}"
                                                                      Template="{StaticResource LockToggleButtonControlTemplate}">
                                                            <Image Source="/Resources/Images/edit.png" />
                                                        </ToggleButton>
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                            <Viewbox HorizontalAlignment="Center"
                                                     VerticalAlignment="Center"
                                                     Visibility="{Binding LoadingSpinnerVisibility}"
                                                     Width="{Binding LoadingSpinnerSize}"
                                                     Height="{Binding LoadingSpinnerSize}">
                                                <spinners:ucSpinnerDotCircle HorizontalAlignment="Center"
                                                                             VerticalAlignment="Center" />
                                            </Viewbox>
                                            <Grid x:Name="TrialExpiredOverlayGrid"
                                                  Background="Gray"
                                                  Opacity="0.5"
                                                  Visibility="{Binding TrialOverlayVisibility}">
                                                <Viewbox HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"
                                                         Width="{Binding LoadingSpinnerSize}"
                                                         Height="{Binding LoadingSpinnerSize}">
                                                    <Image Source="/Resources/Images/lock.png"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />
                                                </Viewbox>
                                            </Grid>
                                        </Grid>
                                    </local:MpClipBorder>
                                </DataTemplate>
                            </local:MpMultiSelectListBox.ItemTemplate>
                        </local:MpMultiSelectListBox>
                    </AdornerDecorator>
                    <TextBlock x:Name="EmptyListTextBlock"
                               Text="This list has no items"
                               Focusable="True"
                               Visibility="Collapsed"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Margin="0,0,0,15"
                               Foreground="LightGray"
                               FontStyle="Oblique"
                               FontSize="34" />
                </Grid>
            </Grid>
            <!--3rd row row for tray -->
        </Grid>
    </Canvas>    
</Window>
