<Window x:Class="MpWpfApp.MpMainWindow"
        x:Name="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:ii="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:s="clr-namespace:System;assembly=mscorlib"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:dd="clr-namespace:GongSolutions.Wpf.DragDrop;assembly=GongSolutions.Wpf.DragDrop"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2f008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:diagnostics="clr-namespace:System.Diagnostics;assembly=WindowsBase"
        mc:Ignorable="d"
        xmlns:local="clr-namespace:MpWpfApp"
        Title="MpMainWindow"
        WindowStyle="None" 
        Top="10000"
        ShowInTaskbar="false"
        ResizeMode="NoResize"
        Background="Transparent"
        Height="350"
        Width="1680">
    <Window.DataContext>
        <local:MpMainWindowViewModel />
    </Window.DataContext>
    <Window.Resources>
        <s:Int32 x:Key="Files">1</s:Int32>
        <s:Int32 x:Key="Csv">2</s:Int32>
        <s:Int32 x:Key="Zip">3</s:Int32>
        <s:Boolean x:Key="True">True</s:Boolean>
        <s:Boolean x:Key="False">False</s:Boolean>
        <local:MpIntToStringConverter x:Key="IntToStringConverter" />
        <local:MpBoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <local:MpSolidColorBrushToBrushConverter x:Key="SolidColorBrushToBrushConverter" />
        <local:MpImageSourceToBitmapSourceConverter x:Key="ImageSourceToBitmapSourceConverter" />
        <!--Color Pallete Menu Item-->
        <Style x:Key="MenuItemStyle"
               TargetType="{x:Type MenuItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Bd"
                                Padding="31,0,17,0"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                SnapsToDevicePixels="True"
                                Uid="Border_38">
                            <ContentPresenter x:Name="ContentPresenter"
                                              Content="{TemplateBinding Header}"
                                              Grid.Column="1"
                                              ContentSource="Header"
                                              Margin="{TemplateBinding Padding}"
                                              RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              Uid="ContentPresenter_33" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted"
                                     Value="True">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="#00FFFFFF" />
                                <Setter Property="BorderBrush"
                                        TargetName="Bd"
                                        Value="#00FFFFFF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background"
                    Value="Transparent" />
            <Style.Triggers>
                <Trigger Property="IsHighlighted"
                         Value="True">
                    <Setter Property="Background"
                            Value="Transparent" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <!-- Button Styles -->
        <Style x:Key="Transparent_Button"
               TargetType="{x:Type Button}">
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                BorderThickness="0"
                                BorderBrush="Black"
                                Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter Property="Background"
                                        Value="Transparent" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Flat Button -->
        <ControlTemplate x:Key="FlatButtonControlTemplate"
                         TargetType="{x:Type Button}">
            <Border x:Name="OuterBorder"
                    BorderBrush="Transparent"
                    BorderThickness="1"
                    CornerRadius="2">
                <Border x:Name="InnerBorder"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        BorderThickness="1"
                        CornerRadius="2">
                    <ContentPresenter HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True"
                                      Margin="{TemplateBinding Padding}" />
                </Border>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver"
                         Value="True">
                    <Setter TargetName="OuterBorder"
                            Property="BorderBrush"
                            Value="#FF7CA0CC" />
                    <Setter TargetName="InnerBorder"
                            Property="BorderBrush"
                            Value="#FFE4EFFD" />
                    <Setter TargetName="InnerBorder"
                            Property="Background"
                            Value="#FFDAE7F5" />
                </Trigger>
                <Trigger Property="IsPressed"
                         Value="True">
                    <Setter TargetName="OuterBorder"
                            Property="BorderBrush"
                            Value="#FF2E4E76" />
                    <Setter TargetName="InnerBorder"
                            Property="BorderBrush"
                            Value="#FF116EE4" />
                    <Setter TargetName="InnerBorder"
                            Property="Background"
                            Value="#FF3272B8" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!-- Flat Toggle Button -->
        <ControlTemplate x:Key="FlatToggleButtonControlTemplate"
                         TargetType="{x:Type ToggleButton}">
            <Border x:Name="OuterBorder"
                    BorderBrush="Transparent"
                    BorderThickness="1"
                    CornerRadius="2">
                <Border x:Name="InnerBorder"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        BorderThickness="1"
                        CornerRadius="2">
                    <ContentPresenter HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      RecognizesAccessKey="True"
                                      Margin="{TemplateBinding Padding}" />
                </Border>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver"
                         Value="True">
                    <Setter TargetName="OuterBorder"
                            Property="BorderBrush"
                            Value="#FF7CA0CC" />
                    <Setter TargetName="InnerBorder"
                            Property="BorderBrush"
                            Value="#FFE4EFFD" />
                    <Setter TargetName="InnerBorder"
                            Property="Background"
                            Value="#FFDAE7F5" />
                </Trigger>
                <Trigger Property="IsPressed"
                         Value="True">
                    <Setter TargetName="OuterBorder"
                            Property="BorderBrush"
                            Value="#FF2E4E76" />
                    <Setter TargetName="InnerBorder"
                            Property="BorderBrush"
                            Value="#FF116EE4" />
                    <Setter TargetName="InnerBorder"
                            Property="Background"
                            Value="#FF3272B8" />
                </Trigger>
                <Trigger Property="IsChecked"
                         Value="True">
                    <Setter TargetName="OuterBorder"
                            Property="BorderBrush"
                            Value="#FFFFC00A" />
                    <Setter TargetName="InnerBorder"
                            Property="BorderBrush"
                            Value="#FFFFDE7F" />
                    <Setter TargetName="InnerBorder"
                            Property="Background"
                            Value="#FFFFD458" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!-- Color Palletes -->
        <SolidColorBrush x:Key="AppColorDark">DarkViolet</SolidColorBrush>
        <SolidColorBrush x:Key="AppColorLight">MediumPurple</SolidColorBrush>
    </Window.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:CallMethodAction MethodName="MainWindow_Loaded"
                                TargetObject="{Binding}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <!-- Main Window Grid -->
    <Grid x:Name="MainWindowGrid"
          Background="Green">
        <Grid.RowDefinitions>
            <RowDefinition Height="{Binding TitleMenuHeight}" />
            <RowDefinition Height="{Binding FilterMenuHeight}" />
            <RowDefinition Height="{Binding ClipTrayHeight}" />
        </Grid.RowDefinitions>
        <tb:TaskbarIcon x:Name="SystemTrayTaskbarIcon"
                        DataContext="{Binding SystemTrayViewModel}"
                        IconSource="/MpWpfApp;component/Resources/Icons/monkey (2).ico"
                        ToolTipText="{Binding SystemTrayIconToolTipText}">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Loaded">
                    <i:CallMethodAction MethodName="SystemTrayTaskbarIcon_Loaded"
                                        TargetObject="{Binding}" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Settings"
                              Command="{Binding ShowSettingsWindowCommand}" />
                    <MenuItem Header="Pause" />
                    <MenuItem Header="Help" />
                    <MenuItem Header="Exit"
                              Command="{Binding ExitApplicationCommand}" />
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
            <tb:TaskbarIcon.TrayToolTip>
                <Border Background="{StaticResource AppColorDark}"
                        BorderBrush="{StaticResource AppColorLight}"
                        BorderThickness="2"
                        Padding="10"
                        CornerRadius="4"
                        Opacity="0.8">
                    <StackPanel>
                        <TextBlock Text="Monkey Paste Info 1"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                        <TextBlock Text="Monkey Paste Info 2"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                        <TextBlock Text="Monkey Paste Info 3"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center" />
                    </StackPanel>
                </Border>
            </tb:TaskbarIcon.TrayToolTip>
        </tb:TaskbarIcon>
        <!-- Main Menu -->
        <StackPanel Grid.Row="0"
                    Grid.Column="0"
                    Orientation="Horizontal"
                    Background="DarkGreen" />
        <!-- FilterMenu -->
        <Grid Grid.Row="1"
              Grid.Column="0"
              Focusable="True"
              Background="DarkViolet">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="5*" />
                <ColumnDefinition Width="1.5*" />
            </Grid.ColumnDefinitions>
            <!-- Sort Combobox -->
            <Grid Grid.Row="0"
                  Grid.Column="0"
                  DataContext="{Binding ClipTileSortViewModel}"
                  Margin="0">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Loaded">
                        <i:CallMethodAction MethodName="ClipTileSort_Loaded"
                                            TargetObject="{Binding}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="4*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Label Grid.Column="0"
                       FontSize="19"
                       Foreground="White"
                       HorizontalAlignment="Right"
                       FontWeight="DemiBold"
                       VerticalContentAlignment="Center"
                       Padding="0,0,15,0">Sort By</Label>
                <local:MpClipBorder CornerRadius="15"
                                    Margin="5"
                                    Grid.Column="1">
                    <ComboBox FontSize="16"
                              Background="Transparent"
                              HorizontalContentAlignment="Left"
                              VerticalContentAlignment="Center"
                              SelectedItem="{Binding SelectedSortType}"
                              ItemsSource="{Binding SortTypes}">
                        <ComboBox.ItemTemplate>
                            <ItemContainerTemplate>
                                <TextBlock Text="{Binding Header}" />
                            </ItemContainerTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </local:MpClipBorder>
                <Button Grid.Column="2"
                        Margin="0,0,0,0"
                        Background="Transparent"
                        Style="{StaticResource Transparent_Button}"
                        BorderThickness="0"
                        Height="30"
                        Width="30"
                        Command="{Binding ToggleSortOrderCommand}">
                    <Grid>
                        <Image Source="/Resources/Images/asc_white.png"
                               Visibility="{Binding AscSortOrderButtonImageVisibility}"
                               Stretch="Fill" />
                        <Image Source="/Resources/Images/desc_white.png"
                               Visibility="{Binding DescSortOrderButtonImageVisibility}"
                               Stretch="Fill" />
                    </Grid>

                </Button>
            </Grid>
            <!-- Tag Tray -->
            <StackPanel Grid.Row="0"
                        Grid.Column="1"
                        DataContext="{Binding TagTrayViewModel}"
                        Focusable="False"
                        HorizontalAlignment="Center"
                        Orientation="Horizontal">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Loaded">
                        <i:CallMethodAction MethodName="TagTray_Loaded"
                                            TargetObject="{Binding}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ListBox x:Name="TagTray"
                         Focusable="False"
                         Background="Transparent"
                         BorderBrush="Transparent"
                         dd:DragDrop.IsDragSource="True"
                         dd:DragDrop.IsDropTarget="True"
                         dd:DragDrop.DropHandler="{Binding}"
                         HorizontalAlignment="Center"
                         SelectionMode="Single"
                         ScrollViewer.VerticalScrollBarVisibility="Hidden"
                         ItemsSource="{Binding}">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="IsSelected"
                                    Value="{Binding IsSelected}" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                        <ContentPresenter />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True"
                                                    ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                    Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <!-- Tag Tile Border -->
                            <local:MpClipBorder x:Name="TagTileBorder"
                                                CornerRadius="10"
                                                Margin="5,0,5,0"
                                                Padding="7,5,7,5"
                                                Focusable="True"
                                                VerticalAlignment="Center"
                                                Background="{Binding TagBorderBackgroundBrush}"
                                                BorderBrush="Transparent"
                                                BorderThickness="0"
                                                Height="{Binding TagHeight}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Loaded">
                                        <i:CallMethodAction TargetObject="{Binding}"
                                                            MethodName="TagTile_Loaded" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <local:MpClipBorder.ContextMenu>
                                    <ContextMenu>
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Loaded">
                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                    MethodName="TagTile_ContextMenu_Loaded" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <MenuItem Header="Rename"
                                                  Command="{Binding RenameTagCommand}" />
                                        <MenuItem Header="Assign Hotkey"
                                                  InputGestureText="{Binding ShortcutKeyList}"
                                                  Command="{Binding AssignHotkeyCommand}" />
                                        <MenuItem Header="Change Color"
                                                  Command="{Binding ChangeTagColorCommand}" />
                                        <MenuItem x:Name="TagTileColorContextMenuItem"
                                                  Style="{StaticResource MenuItemStyle}" />
                                        <MenuItem Header="Delete"
                                                  Command="{Binding TagTrayViewModel.DeleteTagCommand}" />
                                    </ContextMenu>
                                </local:MpClipBorder.ContextMenu>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <!-- Tag Count Box-->
                                    <local:MpClipBorder CornerRadius="5"
                                                        Grid.Column="0"
                                                        Grid.Row="0"
                                                        MinWidth="20"
                                                        Margin="3,0,0,0"
                                                        Padding="5"
                                                        BorderThickness="0"
                                                        Background="{Binding TagColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                                        <TextBlock Background="Transparent"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Center"
                                                   Text="{Binding TagClipCount, Converter={StaticResource IntToStringConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                                                   Foreground="{Binding TagCountTextColor}" />
                                    </local:MpClipBorder>
                                    <TextBlock x:Name="TagTextBlock"
                                               Grid.Column="1"
                                               Grid.Row="0"
                                               Margin="5,0,0,0"
                                               Background="Transparent"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Visibility="{Binding TextBlockVisibility}"
                                               FontSize="{Binding TagFontSize}"
                                               FontWeight="SemiBold"
                                               Foreground="{Binding TagTextColor}"
                                               Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                                    </TextBlock>
                                    <TextBox x:Name="TagTextBox"
                                             Grid.Row="0"
                                             Grid.Column="1"
                                             Margin="5,0,0,0"
                                             Background="White"
                                             Foreground="Black"
                                             IsReadOnly="False"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"
                                             Visibility="{Binding TextBoxVisibility}"
                                             FontSize="{Binding TagFontSize}"
                                             Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" />
                                </Grid>
                            </local:MpClipBorder>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <!-- Add Tag Button -->
                <Button x:Name="AddTagButton"
                        Height="30"
                        Width="30"
                        BorderThickness="0"
                        Style="{StaticResource Transparent_Button}"
                        Background="Transparent"
                        Command="{Binding CreateTagCommand}">
                    <Image Stretch="Fill"
                           Source="/MpWpfApp;component/Resources/Images/add4.png" />
                </Button>
            </StackPanel>
            <Grid Grid.Row="0"
                  Grid.Column="2"
                  DataContext="{Binding SearchBoxViewModel}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="0.2*" />
                </Grid.ColumnDefinitions>
                <!-- Search Border -->
                <local:MpClipBorder x:Name="SearchTextBoxBorder"
                                    Grid.Column="0"
                                    Grid.ColumnSpan="{Binding SearchBorderColumnSpan}"
                                    Margin="5"
                                    CornerRadius="{Binding CornerRadius}"
                                    BorderBrush="{Binding TextBoxBorderBrush}"
                                    Background="White"
                                    BorderThickness="3">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:CallMethodAction MethodName="SearchBoxBorder_Loaded"
                                                TargetObject="{Binding}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <Grid Grid.Column="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="0.15*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="0.1*" />
                        </Grid.ColumnDefinitions>
                        <Button Background="Transparent"
                                Grid.Column="0"
                                Width="25"
                                Margin="3,0,0,0"
                                Height="25"
                                Style="{StaticResource Transparent_Button}"
                                BorderThickness="0">
                            <Image Source="/MpWpfApp;component/Resources/Images/search.png"
                                   Stretch="Fill" />
                        </Button>
                        <TextBox x:Name="SearchBox"
                                 Grid.Column="1"
                                 FontSize="{Binding FontSize}"
                                 Background="Transparent"
                                 Foreground="{Binding TextBoxTextBrush}"
                                 FontStyle="{Binding TextBoxFontStyle}"
                                 BorderThickness="0"
                                 VerticalContentAlignment="Center"
                                 Padding="0,0,0,0"
                                 local:MpFocusExtension.IsFocused="{Binding IsTextBoxFocused, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                                 Text="{Binding Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                        </TextBox>
                        <Button x:Name="ClearTextBoxButton"
                                Grid.Column="2"
                                Width="15"
                                Height="15"
                                Visibility="{Binding ClearTextButtonVisibility}"
                                Command="{Binding ClearTextCommand}"
                                Template="{DynamicResource BackgroundButton}">
                            <Button.Background>
                                <ImageBrush ImageSource="/MpWpfApp;component/Resources/Images/close2.png" />
                            </Button.Background>
                            <Button.Resources>
                                <ControlTemplate x:Key="BackgroundButton"
                                                 TargetType="Button">
                                    <Border x:Name="border"
                                            BorderThickness="0"
                                            Background="{TemplateBinding Background}">
                                        <ContentPresenter HorizontalAlignment="Center"
                                                          VerticalAlignment="Center" />
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                 Value="True">
                                            <Setter Property="Background"
                                                    TargetName="border">
                                                <Setter.Value>
                                                    <ImageBrush ImageSource="/MpWpfApp;component/Resources/Images/close2.png" />
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Resources>
                        </Button>
                    </Grid>
                </local:MpClipBorder>
                <!-- Search Navigation Border-->
                <local:MpClipBorder Grid.Column="1"
                                    CornerRadius="10"
                                    Visibility="{Binding SearchNavigationButtonPanelVisibility}"
                                    HorizontalAlignment="Center"
                                    Margin="3,0,10,0">
                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="PreviousTemplateButton"
                                TabIndex="2"
                                Command="{Binding PrevMatchCommand}"
                                Width="20"
                                Height="20"
                                Padding="5">
                            <Image Source="/Resources/Images/back_black.png" />
                        </Button>
                        <Button x:Name="NextTemplateButton"
                                TabIndex="3"
                                Command="{Binding NextMatchCommand}"
                                Width="20"
                                Height="20"
                                Padding="5">
                            <Image Source="/Resources/Images/forward_black.png" />
                        </Button>
                    </StackPanel>
                </local:MpClipBorder>
            </Grid>
        </Grid>
        <Grid Grid.Row="2"
              Grid.Column="0"
              Focusable="True"
              Background="MediumPurple">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="{Binding AppStateButtonGridWidth}" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <!-- Side bar AppState Buttons -->
            <Grid Grid.Row="0"
                  Grid.Column="0"
                  DataContext="{Binding AppModeViewModel}"
                  Background="Orange">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <ToggleButton Grid.Row="0"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Pause System"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="1"
                              Grid.Column="0"
                              IsChecked="{Binding IsAutoCopyMode}"
                              Padding="0,5,0,5">
                    <TextBlock Text="Auto Copy"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="2"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Auto Paste"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="3"
                              Grid.Column="0"
                              Padding="0,5,0,5"
                              IsChecked="{Binding IsInAppendMode}">
                    <TextBlock Text="Auto Append"
                               FontSize="11"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="4"
                              Grid.Column="0"
                              Padding="0,10,10,10">
                    <TextBlock Text="Smart Copy"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
            </Grid>
            <Grid DataContext="{Binding ClipTrayViewModel}"
                  Grid.Row="0"
                  Grid.Column="1">
                <Grid.Resources>
                    <local:MpBindingProxy x:Key="ClipTrayProxy"
                                          Data="{Binding}" />
                </Grid.Resources>
                <local:MpMultiSelectListBox x:Name="ClipTray"
                                            ItemsSource="{Binding}"
                                            Visibility="Visible"
                                            AllowDrop="True" 
                                            IsSynchronizedWithCurrentItem="True"
                                            Margin="5,0,0,0"
                                            Focusable="True"
                                            local:MpFocusExtension.IsFocused="{Binding IsClipTrayFocused}"
                                            BorderThickness="0"
                                            VerticalAlignment="Stretch"
                                            Background="Transparent"
                                            SelectionMode="Extended"
                                            VirtualizingPanel.IsVirtualizing="True"
                                            VirtualizingPanel.ScrollUnit="Pixel"
                                            VirtualizingPanel.VirtualizationMode="Recycling"
                                            ScrollViewer.CanContentScroll="False"
                                            ScrollViewer.IsDeferredScrollingEnabled="False"
                                            ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                            ScrollViewer.VerticalScrollBarVisibility="Hidden">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Loaded">
                            <i:CallMethodAction MethodName="ClipTray_Loaded"
                                                TargetObject="{Binding}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <local:MpMultiSelectListBox.InputBindings>
                        <KeyBinding Gesture="Ctrl+A"
                                    Command="{Binding SelectAllCommand}" />
                    </local:MpMultiSelectListBox.InputBindings>
                    <local:MpMultiSelectListBox.ItemContainerStyle>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="IsSelected"
                                    Value="{Binding IsSelected}" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                        <ContentPresenter />
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected"
                                                     Value="True">
                                                <Setter Property="BorderBrush"
                                                        Value="Transparent" />
                                                <Setter Property="Background"
                                                        Value="Transparent" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </local:MpMultiSelectListBox.ItemContainerStyle>
                    <local:MpMultiSelectListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True"
                                                    CanVerticallyScroll="False"
                                                    CanHorizontallyScroll="True"
                                                    VerticalAlignment="Stretch"
                                                    Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </local:MpMultiSelectListBox.ItemsPanel>
                    <local:MpMultiSelectListBox.ItemTemplate>
                        <DataTemplate>
                            <!-- Clip Tile -->
                            <local:MpClipBorder BorderBrush="{Binding TileBorderBrush}"
                                                Margin="{Binding TileMargin}"
                                                BorderThickness="{Binding TileBorderThickness}"
                                                Width="{Binding TileBorderWidth}"
                                                Height="{Binding TileSize}"
                                                Visibility="{Binding TileVisibility, NotifyOnTargetUpdated=True}"
                                                local:MpFocusExtension.IsFocused="{Binding IsClipItemFocused}"
                                                local:MpHighlightTextExtension.HighlightText="{Binding MainWindowViewModel.SearchBoxViewModel.SearchText}"
                                                Focusable="True"
                                                Background="White"
                                                ToolTipService.ShowDuration="1000"
                                                CornerRadius="10">
                                <ii:Interaction.Behaviors>
                                    <local:MpAnimatedVisibilityFadeBehavior AnimationDuration="0:0:0.0001"
                                                                          InitialState="Collapsed" />
                                </ii:Interaction.Behaviors>
                                <local:MpClipBorder.Resources>
                                    <local:MpBindingProxy x:Key="ClipTileProxy"
                                                          Data="{Binding}" />
                                </local:MpClipBorder.Resources>
                                <!--<local:MpClipBorder.Effect>
                                    <DropShadowEffect Color="Black"
                                                      BlurRadius="10" />
                                </local:MpClipBorder.Effect>-->
                                <Grid>
                                    <Label Content="Loading"
                                           Visibility="{Binding LoadingSpinnerVisibility}" />
                                    <Grid Visibility="{Binding ContentVisibility}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Loaded">
                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                    MethodName="ClipTile_Loaded" />
                                            </i:EventTrigger>
                                            <i:EventTrigger EventName="Loaded">
                                                <i:CallMethodAction TargetObject="{Binding MainWindowViewModel.ClipTrayViewModel}"
                                                                    MethodName="ClipTile_Loaded" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <Grid.ContextMenu>
                                            <ContextMenu x:Name="ClipTile_ContextMenu">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="Loaded">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTile_ContextMenu_Loaded" />
                                                    </i:EventTrigger>
                                                    <i:EventTrigger EventName="Opened">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTile_ContextMenu_Opened" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <MenuItem Header="Bring to Front"
                                                          Command="{Binding Data.BringSelectedClipTilesToFrontCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Send to Back"
                                                          Command="{Binding Data.SendSelectedClipTilesToBackCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Assign Hotkey"
                                                          InputGestureText="{Binding ShortcutKeyList}"
                                                          Command="{Binding AssignHotkeyCommand}" />
                                                <MenuItem Header="Exclude Application"
                                                          Command="{Binding ExcludeApplicationCommand}" />
                                                <MenuItem Header="Export To">
                                                    <MenuItem Header="File(s)..."
                                                              Command="{Binding Data.ExportSelectedClipTilesCommand, Source={StaticResource ClipTrayProxy}}"
                                                              CommandParameter="{StaticResource Files}" />
                                                    <MenuItem Header="CSV"
                                                              Command="{Binding Data.ExportSelectedClipTilesCommand, Source={StaticResource ClipTrayProxy}}"
                                                              CommandParameter="{StaticResource Csv}" />
                                                    <MenuItem Header="Zip"
                                                              Command="{Binding Data.ExportSelectedClipTilesCommand, Source={StaticResource ClipTrayProxy}}"
                                                              CommandParameter="{StaticResource Zip}" />
                                                </MenuItem>
                                                <MenuItem Header="Share..."
                                                          Command="{Binding ShareClipCommand}" />
                                                <MenuItem Header="Rename"
                                                          Command="{Binding Data.RenameClipCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Duplicate"
                                                          Command="{Binding Data.DuplicateSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Edit"
                                                          Command="{Binding EditClipCommand}" />
                                                <MenuItem Header="Send as Email"
                                                          Command="{Binding SendClipToEmailCommand}" />
                                                <MenuItem x:Name="ClipTileColorContextMenuItem"
                                                          Style="{StaticResource MenuItemStyle}" />
                                                <MenuItem Header="Delete"
                                                          Command="{Binding Data.DeleteSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Run in Command Prompt"
                                                          Command="{Binding Data.RunSelectedClipsInShellCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Say"
                                                          Command="{Binding Data.SpeakSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Merge"
                                                          Command="{Binding Data.MergeSelectedClipsCommand, Source={StaticResource ClipTrayProxy}}" />
                                                <MenuItem Header="Search Web">
                                                    <MenuItem Header="Google">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="PreviewMouseLeftButtonUp">
                                                                <i:CallMethodAction MethodName="ContextMenuMouseLeftButtonUpOnSearchGoogle"
                                                                                    TargetObject="{Binding Data, Source={StaticResource ClipTileProxy}}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </MenuItem>
                                                    <MenuItem Header="Bing">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="PreviewMouseLeftButtonUp">
                                                                <i:CallMethodAction MethodName="ContextMenuMouseLeftButtonUpOnSearchBing"
                                                                                    TargetObject="{Binding Data, Source={StaticResource ClipTileProxy}}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </MenuItem>
                                                    <MenuItem Header="DuckDuckGo">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="PreviewMouseLeftButtonUp">
                                                                <i:CallMethodAction MethodName="ContextMenuMouseLeftButtonUpOnSearchDuckDuckGo"
                                                                                    TargetObject="{Binding Data, Source={StaticResource ClipTileProxy}}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </MenuItem>
                                                    <MenuItem Header="Yandex">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="PreviewMouseLeftButtonUp">
                                                                <i:CallMethodAction MethodName="ContextMenuMouseLeftButtonUpOnSearchYandex"
                                                                                    TargetObject="{Binding Data, Source={StaticResource ClipTileProxy}}" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                    </MenuItem>
                                                </MenuItem>
                                                <MenuItem Header="Convert To"
                                                          ItemsSource="{Binding Data.ConvertClipTypes, Source={StaticResource ClipTileProxy}}">
                                                    <MenuItem.ItemContainerStyle>
                                                        <Style TargetType="{x:Type MenuItem}">
                                                            <Setter Property="Header"
                                                                    Value="{Binding Header}" />
                                                            <Setter Property="Command"
                                                                    Value="{Binding Command}" />
                                                            <Setter Property="CommandParameter"
                                                                    Value="{Binding CommandParameter}" />
                                                            <Setter Property="IsCheckable"
                                                                    Value="True" />
                                                            <Setter Property="IsChecked"
                                                                    Value="{Binding IsChecked}" />
                                                        </Style>
                                                    </MenuItem.ItemContainerStyle>
                                                </MenuItem>
                                                <MenuItem x:Name="TranslateMenuItem" 
                                                          Header="Translate"
                                                          ItemsSource="{Binding Data.TranslateLanguageMenuItems, Source={StaticResource ClipTileProxy}}">
                                                    <MenuItem.ItemContainerStyle>
                                                        <Style TargetType="{x:Type MenuItem}">
                                                            <Setter Property="Header"
                                                                    Value="{Binding Header}" />
                                                            <Setter Property="Command"
                                                                    Value="{Binding Command}" />
                                                            <Setter Property="CommandParameter"
                                                                    Value="{Binding CommandParameter}" />
                                                        </Style>
                                                    </MenuItem.ItemContainerStyle>
                                                </MenuItem>
                                                <MenuItem Header="Pin To"
                                                          ItemsSource="{Binding Data.TagMenuItems, Source={StaticResource ClipTileProxy}}">
                                                    <MenuItem.ItemContainerStyle>
                                                        <Style TargetType="{x:Type MenuItem}">
                                                            <Setter Property="Header"
                                                                    Value="{Binding Header}" />
                                                            <Setter Property="Command"
                                                                    Value="{Binding Command}" />
                                                            <Setter Property="CommandParameter"
                                                                    Value="{Binding CommandParameter}" />
                                                            <Setter Property="IsCheckable"
                                                                    Value="True" />
                                                            <Setter Property="IsChecked"
                                                                    Value="{Binding IsChecked}" />
                                                        </Style>
                                                    </MenuItem.ItemContainerStyle>
                                                </MenuItem>
                                            </ContextMenu>
                                        </Grid.ContextMenu>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="{Binding TileTitleHeight}" />
                                            <RowDefinition Height="{Binding TileContentHeight}" />
                                        </Grid.RowDefinitions>
                                        <!-- Tile Title StackPanel -->
                                        <Canvas Grid.Row="0"
                                                Grid.Column="0"
                                                VerticalAlignment="Top"
                                                HorizontalAlignment="Left">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="Loaded">
                                                    <i:CallMethodAction TargetObject="{Binding}"
                                                                        MethodName="ClipTileTitle_Loaded" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                            <Image x:Name="TitleSwirl"
                                                   Canvas.Top="-1"
                                                   Canvas.Left="-1"
                                                   RenderOptions.BitmapScalingMode="HighQuality"
                                                   Stretch="Fill"
                                                   Width="{Binding TileBorderWidth}"
                                                   Height="{Binding TileTitleHeight}"
                                                   Source="{Binding TitleSwirl}" />
                                            <!-- Clip Title TextBlock -->
                                            <TextBlock x:Name="ClipTileTitleTextBlock"
                                                       Text="{Binding CopyItemTitle}"
                                                       Canvas.Top="-2"
                                                       Canvas.Left="5"
                                                       FontSize="24"
                                                       Foreground="White"
                                                       Background="Transparent"
                                                       Visibility="{Binding TileTitleTextBlockVisibility}">
                                            <!--<TextBlock.Effect>
                                                <DropShadowEffect ShadowDepth="2"
                                                                  Direction="330"
                                                                  Color="Black"
                                                                  Opacity="1.0"
                                                                  BlurRadius="7" />
                                            </TextBlock.Effect>-->
                                            </TextBlock>
                                            <!-- Clip Title TextBox -->
                                            <TextBox x:Name="ClipTileTitleTextBox"
                                                     Background="White"
                                                     Foreground="Black"
                                                     Canvas.Top="-2"
                                                     Canvas.Left="5"
                                                     FontSize="24"
                                                     IsReadOnly="False"
                                                     Visibility="{Binding TileTitleTextBoxVisibility}"
                                                     local:MpFocusExtension.IsFocused="{Binding IsClipTitleTextBoxFocused}"
                                                     Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}" />
                                            <!-- Clip Title Detail TextBlock -->
                                            <TextBlock x:Name="ClipTileTitleDetailTextBlock"
                                                       Background="Transparent"
                                                       Foreground="{Binding DetailTextColor}"
                                                       FontSize="9"
                                                       Text="{Binding DetailText}" />
                                            <!-- Clip Title Icon Image -->
                                            <Button x:Name="ClipTileAppIconImageButton"
                                                    Style="{StaticResource Transparent_Button}"
                                                    Background="Transparent"
                                                    BorderThickness="0">
                                                <Image x:Name="ClipTileAppIconImage"
                                                       Source="{Binding CopyItemAppIcon, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                       Stretch="Fill"
                                                       ToolTip="{Binding CopyItemAppName}"
                                                       Width="{Binding TileTitleIconSize}"
                                                       Height="{Binding TileTitleIconSize}">
                                                    <Image.Style>
                                                        <Style TargetType="{x:Type Image}">
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver"
                                                                         Value="True">
                                                                    <Setter Property="Effect">
                                                                        <Setter.Value>
                                                                            <DropShadowEffect ShadowDepth="3"
                                                                                              Color="White"
                                                                                              Opacity="1"
                                                                                              BlurRadius="50" />
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Image.Style>
                                                </Image>
                                            </Button>
                                        </Canvas>
                                        <!-- Content Container Canvas -->
                                        <Canvas x:Name="ClipTileContentCanvas"
                                                Grid.Row="1"
                                                Grid.Column="0">
                                            <!-- RichText Content -->
                                            <StackPanel x:Name="ClipTileRichTextStackPanel"
                                                        Height="{Binding TileContentHeight}"
                                                        Visibility="{Binding RtbVisibility}"
                                                        Width="{Binding TileBorderWidth, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="Loaded">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTileRichTextStackPanel_Loaded" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <Border x:Name="ClipTileEditorToolbar"
                                                        DataContext="{Binding EditRichTextBoxToolbarViewModel}"
                                                        Visibility="{Binding EditToolbarVisibility}">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Loaded">
                                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                                MethodName="ClipTileEditorToolbarBorder_Loaded" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                    <StackPanel Orientation="Horizontal"
                                                                Height="{Binding TileContentEditToolbarHeight}">
                                                        <ComboBox x:Name="FontFamilyCombo"
                                                                  Height="23"
                                                                  Width="100"
                                                                  Margin="5,2,0,2"
                                                                  IsEditable="True"
                                                                  ItemsSource="{Binding SystemFonts}">
                                                            <ComboBox.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <VirtualizingStackPanel Width="250" />
                                                                </ItemsPanelTemplate>
                                                            </ComboBox.ItemsPanel>
                                                            <ComboBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding}"
                                                                               FontFamily="{Binding}"
                                                                               FontSize="15"
                                                                               Height="20" />
                                                                </DataTemplate>
                                                            </ComboBox.ItemTemplate>
                                                        </ComboBox>
                                                        <ComboBox x:Name="FontSizeCombo"
                                                                  Height="23"
                                                                  Width="40"
                                                                  Margin="5,2,5,2"
                                                                  IsEditable="True"
                                                                  ItemsSource="{Binding FontSizeList}" />
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None" />
                                                        <Button x:Name="AddTemplateButton"
                                                                ToolTip="Add Template"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                IsEnabled="{Binding IsAddTemplateButtonEnabled}"
                                                                Background="{Binding AddTemplateButtonBackgroundBrush}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/templateadd.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None"
                                                               SnapsToDevicePixels="True" />
                                                        <Button Command="ApplicationCommands.Cut"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Cut"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/editcut.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="ApplicationCommands.Copy"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Copy"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/editcopy.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="ApplicationCommands.Paste"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Paste"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/editpaste.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="ApplicationCommands.Undo"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Undo"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/editundo.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="ApplicationCommands.Redo"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Redo"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/editredo.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None"
                                                               SnapsToDevicePixels="True" />
                                                        <ToggleButton x:Name="BoldButton"
                                                                      Command="EditingCommands.ToggleBold"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Bold"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/fontbold.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="ItalicButton"
                                                                      Command="EditingCommands.ToggleItalic"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Italic"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/fontitalic.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="UnderlineButton"
                                                                      Command="EditingCommands.ToggleUnderline"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Underline"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/fontunderline.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None"
                                                               SnapsToDevicePixels="True" />
                                                        <ToggleButton x:Name="LeftButton"
                                                                      Command="EditingCommands.AlignLeft"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Align Left"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/alignleft.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="CenterButton"
                                                                      Command="EditingCommands.AlignCenter"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Align Center"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/aligncenter.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="RightButton"
                                                                      Command="EditingCommands.AlignRight"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Align Right"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/alignright.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="JustifyButton"
                                                                      Command="EditingCommands.AlignJustify"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Align Justify"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/alignjustify.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None"
                                                               SnapsToDevicePixels="True" />
                                                        <ToggleButton x:Name="BulletsButton"
                                                                      Command="EditingCommands.ToggleBullets"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Bullets"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/listbullets.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <ToggleButton x:Name="NumberingButton"
                                                                      Command="EditingCommands.ToggleNumbering"
                                                                      CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                      ToolTip="Numbering"
                                                                      Template="{StaticResource FlatToggleButtonControlTemplate}"
                                                                      Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/listnumbers.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </ToggleButton>
                                                        <Image Source="/Resources/Images/MpRichTextBox/separator.png"
                                                               Stretch="None" />
                                                        <Button Command="EditingCommands.IncreaseIndentation"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Increase Indentation"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/indentincrease.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                        <Button Command="EditingCommands.DecreaseIndentation"
                                                                CommandTarget="{Binding ElementName=ClipTileRichTextBox}"
                                                                ToolTip="Decrease Indentation"
                                                                Template="{StaticResource FlatButtonControlTemplate}"
                                                                Margin="0,1,0,1">
                                                            <Image Source="/Resources/Images/MpRichTextBox/indentdecrease.png"
                                                                   Stretch="None"
                                                                   SnapsToDevicePixels="True" />
                                                        </Button>
                                                    </StackPanel>
                                                </Border>
                                                <RichTextBox x:Name="ClipTileRichTextBox"
                                                             local:MpDocumentRtfExtension.DocumentRtf="{Binding CopyItemRichText}"
                                                             IsReadOnly="{Binding IsRtbReadOnly}"
                                                             IsInactiveSelectionHighlightEnabled="True"
                                                             IsDocumentEnabled="{Binding IsSelected}"
                                                             Focusable="{Binding IsEditingTile}"
                                                             Cursor="{Binding ContentCursor}"
                                                             Height="{Binding RichTextBoxHeight}"
                                                             local:MpFocusExtension.IsFocused="{Binding IsClipRichTextBoxFocused}"
                                                             IsUndoEnabled="True"
                                                             Background="White"
                                                             VerticalAlignment="Top"
                                                             HorizontalAlignment="Left"
                                                             ScrollViewer.HorizontalScrollBarVisibility="{Binding RtbHorizontalScrollbarVisibility}"
                                                             ScrollViewer.VerticalScrollBarVisibility="{Binding RtbVerticalScrollbarVisibility}"
                                                             BorderThickness="0"
                                                             Padding="10,0,10,10">
                                                    <RichTextBox.Resources>
                                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                                                         Color="Blue" />
                                                    </RichTextBox.Resources>
                                                </RichTextBox>
                                                <Border x:Name="ClipTilePasteTemplateToolbar"
                                                        DataContext="{Binding PasteTemplateToolbarViewModel}"
                                                        Background="LightBlue"
                                                        Visibility="{Binding PasteTemplateToolbarVisibility}">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Loaded">
                                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                                MethodName="ClipTilePasteTemplateToolbarBorder_Loaded" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                    <Grid Height="{Binding TileContentPasteToolbarHeight}">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="3*" />
                                                            <ColumnDefinition Width="0.5*" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>
                                                        <Button x:Name="ClearAllTemplatesButton"
                                                                Grid.Column="0"
                                                                TabIndex="0"
                                                                Visibility="{Binding ClearAllTemplateToolbarButtonVisibility}"
                                                                Command="{Binding ClearAllTemplatesCommand}"
                                                                Margin="15,0,15,0"
                                                                Padding="0,0,0,0"
                                                                FontSize="12"
                                                                VerticalContentAlignment="Top"
                                                                VerticalAlignment="Center"
                                                                Content="CLEAR ALL" />
                                                        <local:MpClipBorder Grid.Column="1"
                                                                            CornerRadius="10"
                                                                            Background="White"
                                                                            BorderThickness="1"
                                                                            BorderBrush="DimGray"
                                                                            Margin="1"
                                                                            Padding="0"
                                                                            VerticalAlignment="Center"
                                                                            HorizontalAlignment="Stretch">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="0.1*" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBox x:Name="CurrentTemplateTextBox"
                                                                         Grid.Column="0"
                                                                         TabIndex="1"
                                                                         BorderThickness="0"
                                                                         Text="{Binding SelectedTemplateText, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                         FontStyle="{Binding SelectedTemplateTextBoxFontStyle}"
                                                                         Foreground="{Binding SelectedTemplateTextBrush}"
                                                                         FontSize="14"
                                                                         Width="240"
                                                                         Padding="0,0,0,0"
                                                                         Margin="5,0,0,0"
                                                                         VerticalAlignment="Top"
                                                                         HorizontalAlignment="Left"
                                                                         VerticalContentAlignment="Top" />
                                                                <Button x:Name="ClearCurrentTemplateButton"
                                                                        Grid.Column="1"
                                                                        Visibility="{Binding ClearSelectedTemplateTextboxButtonVisibility}"
                                                                        Command="{Binding ClearCurrentTemplatesCommand}"
                                                                        Background="Transparent"
                                                                        BorderThickness="0"
                                                                        Width="15"
                                                                        Height="15">
                                                                    <Image x:Name="ClearCurrentTemplateButtonImage"
                                                                           Source="/Resources/Images/close1.png" />
                                                                </Button>
                                                            </Grid>
                                                        </local:MpClipBorder>
                                                        <StackPanel Orientation="Horizontal"
                                                                    Grid.Column="2"
                                                                    Visibility="{Binding TemplateNavigationButtonStackVisibility}"
                                                                    HorizontalAlignment="Center"
                                                                    Margin="8,0,0,0">
                                                            <Button x:Name="PreviousTemplateButton"
                                                                    TabIndex="2"
                                                                    Command="{Binding PreviousTemplateTokenCommand}"
                                                                    Width="20"
                                                                    Height="20"
                                                                    Padding="5">
                                                                <Image Source="/Resources/Images/back_black.png" />
                                                            </Button>
                                                            <Button x:Name="NextTemplateButton"
                                                                    TabIndex="3"
                                                                    Command="{Binding NextTemplateTokenCommand}"
                                                                    Width="20"
                                                                    Height="20"
                                                                    Padding="5">
                                                                <Image Source="/Resources/Images/forward_black.png" />
                                                            </Button>
                                                        </StackPanel>
                                                        <Button x:Name="PasteTemplateButton"
                                                                Grid.Column="3"
                                                                TabIndex="4"
                                                                IsEnabled="{Binding IsTemplateReadyToPaste}"
                                                                Command="{Binding ClipTileViewModel.PasteTemplateCommand}"
                                                                Margin="15,0,15,0"
                                                                Padding="0,0,0,0"
                                                                FontSize="12"
                                                                VerticalContentAlignment="Top"
                                                                VerticalAlignment="Center"
                                                                Content="PASTE" />
                                                    </Grid>
                                                </Border>
                                            </StackPanel>
                                            <!-- Image Content-->
                                            <Grid Margin="0" Background="Transparent"
                                                  Height="{Binding TileContentHeight}"
                                                  Width="{Binding TileContentWidth}"
                                                  Visibility="{Binding ImgVisibility}"
                                                  Focusable="{Binding IsSelected}"
                                                  IsEnabled="{Binding IsSelected}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="Loaded">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTileImageCanvas_Loaded" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <Viewbox x:Name="ClipTileImageItemsControlViewBox"
                                                         Height="{Binding TileContentHeight}"
                                                         Width="{Binding TileContentWidth}">
                                                    <ItemsControl x:Name="ClipTileImageDetectedObjectItemscontrol"
                                                                  Background="{Binding CopyItemBmpImageBrush}"
                                                                  DataContext="{Binding DetectedImageObjectCollectionViewModel}"
                                                                  Width="{Binding CopyItemBmpWidth}"
                                                                  Height="{Binding CopyItemBmpHeight}"
                                                                  ItemsSource="{Binding}">
                                                        <i:Interaction.Triggers>
                                                            <i:EventTrigger EventName="Loaded">
                                                                <i:CallMethodAction TargetObject="{Binding}"
                                                                                    MethodName="ClipTileImageDetectedObjectItemscontrol_Loaded" />
                                                            </i:EventTrigger>
                                                        </i:Interaction.Triggers>
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <Canvas x:Name="ClipTileImageDetectedObjectsCanvas"
                                                                        Width="{Binding Data.DetectedImageObjectCollectionViewModel.CopyItemBmpWidth, Source={StaticResource ClipTileProxy}}"
                                                                        Height="{Binding Data.DetectedImageObjectCollectionViewModel.CopyItemBmpHeight, Source={StaticResource ClipTileProxy}}"
                                                                        HorizontalAlignment="Center"
                                                                        IsItemsHost="True"
                                                                        VerticalAlignment="Center">
                                                                </Canvas>
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.Resources>
                                                            <DataTemplate DataType="{x:Type local:MpDetectedImageObjectViewModel}">
                                                                <Border Width="{Binding Width}"
                                                                        Height="{Binding Height}"
                                                                        BorderThickness="3"
                                                                        BorderBrush="{Binding BorderBrush}"
                                                                        Background="Transparent">
                                                                    <Border.Resources>
                                                                        <local:MpBindingProxy x:Key="DetectedImageObjectProxy"
                                                                                              Data="{Binding}" />
                                                                    </Border.Resources>
                                                                    <Border.RenderTransform>
                                                                        <TranslateTransform X="{Binding Data.X, Source={StaticResource DetectedImageObjectProxy}}"
                                                                                            Y="{Binding Data.Y, Source={StaticResource DetectedImageObjectProxy}}" />
                                                                    </Border.RenderTransform>
                                                                    <i:Interaction.Triggers>
                                                                        <i:EventTrigger EventName="Loaded">
                                                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                                                MethodName="ClipTileImageDetectedObjectCanvas_Loaded" />
                                                                        </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                                    <TextBox HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"
                                                                               HorizontalContentAlignment="Center"
                                                                               VerticalContentAlignment="Center"
                                                                               Text="{Binding ObjectTypeName, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                                               FontSize="{Binding FontSize}"
                                                                               IsReadOnly="{Binding IsNameReadOnly}"
                                                                               Background="Black"
                                                                               Foreground="White" />
                                                                </Border>
                                                            </DataTemplate>
                                                        </ItemsControl.Resources>
                                                    </ItemsControl>
                                                </Viewbox>
                                            </Grid>
                                            <!--File List Content -->
                                            <ListBox x:Name="ClipTileFileListBox"
                                                     Width="{Binding TileBorderWidth}"
                                                     Height="{Binding TileContentHeight}"
                                                     ItemsSource="{Binding FileListViewModels}"
                                                     Visibility="{Binding FileListVisibility}"
                                                     IsEnabled="{Binding IsSelected, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=PropertyChanged}"
                                                     BorderThickness="0"
                                                     Focusable="False">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="Loaded">
                                                        <i:CallMethodAction TargetObject="{Binding}"
                                                                            MethodName="ClipTileFileListBox_Loaded" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Height="22"
                                                                BorderThickness="0">
                                                            <StackPanel VerticalAlignment="Center"
                                                                        HorizontalAlignment="Left"
                                                                        ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                        ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                        Orientation="Horizontal">
                                                                <Image Source="{Binding Icon, Converter={StaticResource ImageSourceToBitmapSourceConverter}}"
                                                                       Height="22"
                                                                       Stretch="Fill" />
                                                                <TextBlock x:Name="FileListItemTextBlock"
                                                                           Margin="3,0,0,0"
                                                                           VerticalAlignment="Center"
                                                                           HorizontalAlignment="Left"
                                                                           ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                                           ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                           FontSize="16"
                                                                           Foreground="Black"
                                                                           Background="Transparent">
                                                                    <TextBlock.ToolTip>
                                                                        <ToolTip>
                                                                            <TextBlock Text="{Binding ItemPath}" />
                                                                        </ToolTip>
                                                                    </TextBlock.ToolTip>
                                                                <i:Interaction.Triggers>
                                                                        <i:EventTrigger EventName="Loaded">
                                                                            <i:CallMethodAction TargetObject="{Binding}"
                                                                                                MethodName="FileListItemTextBlock_Loaded" />
                                                                        </i:EventTrigger>
                                                                    </i:Interaction.Triggers>
                                                            </TextBlock>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>
                                            </ListBox>
                                        </Canvas>
                                    </Grid>
                                </Grid>
                            </local:MpClipBorder>
                        </DataTemplate>
                    </local:MpMultiSelectListBox.ItemTemplate>
                </local:MpMultiSelectListBox>
                <TextBlock x:Name="EmptyListTextBlock"
                           Text="This list has no items"
                           Focusable="True"
                           Visibility="Collapsed"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Margin="0,0,0,15"
                           Foreground="LightGray"
                           FontStyle="Oblique"
                           FontSize="34" />
            </Grid>
            <!-- clip tile tray -->
        </Grid>
        <!--3rd row row for tray -->
    </Grid>
</Window>
