<Window x:Class="MpWpfApp.MpMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MpWpfApp"
        local:MpWindowClosingBehavior.Closed="{Binding ClosedCommand}"
        local:MpWindowClosingBehavior.Closing="{Binding ClosingCommand}"
        local:MpWindowClosingBehavior.CancelClosing="{Binding CancelClosingCommand}"
        local:MpWindowLoadingBehavior.Loaded="{Binding LoadedCommand}"
        Title="MpMainWindow"
        WindowStyle="None"
        AllowsTransparency="True"
        ShowInTaskbar="true"
        ResizeMode="NoResize"
        Background="#FFB72F2F"
        Height="350"
        Width="1680">
    <Window.Resources>
    </Window.Resources>
    <Window.DataContext>
        <local:MpMainWindowViewModel />
    </Window.DataContext>
    <!-- Main Window Grid -->
    <Grid x:Name="ClipTrayMainWindowGrid"
          Background="Green">
        <Grid.RowDefinitions>
            <RowDefinition Height="{Binding TitleMenuHeight}"
                           x:Name="ClipTrayTitleMenuPanel" />
            <RowDefinition Height="{Binding FilterMenuHeight}"                           
                           x:Name="ClipTrayFilterMenuPanel" />  
            <RowDefinition Height="{Binding TrayHeight}"
                            x:Name="ClipTrayGrid" />
        </Grid.RowDefinitions>
        <!-- Main Menu -->
        <StackPanel Grid.Row="0"
                    Grid.Column="0"
                    Orientation="Horizontal"
                    Background="Pink" />
        <!-- FilterMenu -->
        <StackPanel Grid.Row="1" Grid.Column="0"
                    Background="DarkBlue">
            <StackPanel HorizontalAlignment="Center"
                        Orientation="Horizontal">
                <ListBox x:Name="TagTray"
                         Background="Transparent"
                         BorderBrush="Transparent"
                         HorizontalAlignment="Center"
                         SelectionMode="Single"
                         ScrollViewer.VerticalScrollBarVisibility="Hidden"
                         ItemsSource="{Binding TagTiles}">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">                            
                            <EventSetter Event="MouseEnter"
                                         Handler="TagListBoxItem_MouseEnter" />
                            <EventSetter Event="MouseLeave"
                                        Handler="TagListBoxItem_MouseLeave"/>
                            <Setter Property="IsSelected"
                                    Value="{Binding IsSelected}" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <ContentPresenter />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True"
                                                    ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                    Orientation="Horizontal">
                            </VirtualizingStackPanel>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>                    
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <!-- Tag Tile View -->
                            <Border CornerRadius="10"
                                    Margin="5,0,5,0"
                                    Padding="10,0,10,0"
                                    Focusable="True"
                                    BorderThickness="2"
                                    VerticalAlignment="Center"
                                    KeyDown="TagTile_KeyDown"
                                    Background="{Binding TagColor}"
                                    BorderBrush="{Binding TagBorderBrush}"
                                    Height="{Binding TagHeight}">
                                <Border.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Rename" Command="{Binding RenameTagCommand}"/>
                                        <MenuItem Header="Delete"
                                                  Command="{Binding DeleteTagCommand}" />
                                    </ContextMenu>
                                </Border.ContextMenu>
                                <StackPanel>
                                    <TextBlock Padding="0,0,0,10"
                                               Background="Transparent"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Top"
                                               Foreground="{Binding TagTextColor}"
                                               Visibility="{Binding TextBlockVisibility}"
                                               Text="{Binding TagName}"
                                               FontSize="{Binding TagFontSize}" />
                                    <TextBox Padding="0,0,0,10"
                                             Background="White"
                                             Foreground="Black"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Top"
                                             SizeChanged="TextBox_SizeChanged"
                                             LostFocus="TagTile_LostFocus"
                                             KeyDown="TagNameTextBox_KeyDown"
                                             Visibility="{Binding TextBoxVisibility}"
                                             Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                             FontSize="{Binding TagFontSize}" />
                                </StackPanel>                                
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <Button Height="30" Width="30" Command="{Binding AddTagCommand}">
                    <Image 
                           Stretch="Fill"
                           Source="add2.png" />
                </Button>
            </StackPanel>
        </StackPanel>
        <!--3rd row row for tray -->
        <Grid Grid.Row="2"
              Grid.Column="0"
              Background="Green">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="{Binding AppStateButtonGridWidth}"
                                  x:Name="AppStateButtonGrid" />
                <ColumnDefinition x:Name="ClipTrayListBox" />
            </Grid.ColumnDefinitions>
            <!-- Side bar AppState Buttons -->
            <Grid Grid.Row="0"
                  Grid.Column="0"
                  Background="Orange">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <ToggleButton Grid.Row="0"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Pause System"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap"/>
                </ToggleButton>
                <ToggleButton Grid.Row="1"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Auto Copy"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="2"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Auto Paste" 
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="3"
                              Grid.Column="0"
                              Padding="0,5,0,5"
                              Command="{Binding ToggleAppendModeCommand}">
                    <TextBlock Text="Auto Apend"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
                <ToggleButton Grid.Row="4"
                              Grid.Column="0"
                              Padding="0,5,0,5">
                    <TextBlock Text="Smart Copy"
                               HorizontalAlignment="Center"
                               TextWrapping="Wrap" />
                </ToggleButton>
            </Grid>
            <!-- tile tray -->
            <ListBox x:Name="ClipTray"
                     Grid.Row="0"
                     Grid.Column="1"
                     Background="DarkViolet"
                     SelectionMode="Extended"
                     PreviewMouseWheel="ClipTray_PreviewMouseWheel"
                     ScrollViewer.CanContentScroll="False"
                     ItemsSource="{Binding ClipTiles}">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <EventSetter Event="MouseEnter"
                                     Handler="ClipListBoxItem_MouseEnter" />
                        <EventSetter Event="MouseLeave"
                                     Handler="ClipListBoxItem_MouseLeave" />
                        <EventSetter Event="KeyDown"
                                     Handler="ClipTile_KeyDown" />
                        <Setter Property="IsSelected"
                                Value="{Binding IsSelected}" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <ContentPresenter />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel IsItemsHost="True"
                                                CanVerticallyScroll="False" 
                                                VerticalAlignment="Stretch"
                                                Orientation="Horizontal" /> 
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <!-- Tile View -->
                        <Viewbox Width="{Binding TileSize}"
                                 Height="{Binding TileSize}"
                                 Visibility="{Binding Visibility}"
                                 Stretch="Fill">
                            <Border BorderBrush="{Binding ClipBorderBrush}"                                    
                                    Focusable="True"                                   
                                    Background="{Binding TitleColor}"
                                    Margin="{Binding TileMargin}"
                                    Loaded="ClipTile_Loaded"
                                    KeyDown="ClipTile_KeyDown"       
                                    BorderThickness="2"
                                    Width="{Binding TileSize}"
                                    Height="{Binding TileSize}"
                                    CornerRadius="10">
                                <Border.Effect>                                    
                                    <DropShadowEffect BlurRadius="10"
                                                      Color="DimGray" />
                                </Border.Effect>
                                <Border.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Rename" Command="{Binding RenameClipCommand}"/>
                                        <MenuItem Header="Delete"
                                                  Command="{Binding DeleteClipCommand}" />
                                        <MenuItem Header="Pin To" ItemsSource="{Binding TagMenuItems}">
                                            <MenuItem.ItemContainerStyle>
                                                <Style TargetType="{x:Type MenuItem}">
                                                    <Setter Property="Header"
                                                            Value="{Binding Header}" />
                                                    <Setter Property="Command"
                                                            Value="{Binding Command}" />
                                                    <Setter Property="IsCheckable"
                                                            Value="True" />
                                                    <Setter Property="IsChecked"
                                                            Value="{Binding IsTagLinkedToClip}" />                                                    
                                                </Style>
                                            </MenuItem.ItemContainerStyle>
                                        </MenuItem>
                                    </ContextMenu>
                                </Border.ContextMenu>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="{Binding TileTitleHeight}" />
                                        <RowDefinition Height="{Binding TileContentHeight}" />
                                    </Grid.RowDefinitions>
                                    <!-- Tile Title StackPanel -->
                                    <StackPanel Grid.Row="0"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                        <Image Source="{Binding Icon}"
                                               Stretch="Fill"
                                               Width="{Binding TileTitleHeight}"
                                               Height="{Binding TileTitleHeight}" />
                                        <TextBlock Text="{Binding Title}"
                                                   Margin="10,0,0,0"
                                                   VerticalAlignment="Top"
                                                   FontSize="35"
                                                   Foreground="{Binding TitleTextColor}"
                                                   Background="Transparent"
                                                   Visibility="{Binding TextBlockVisibility}">
                                            <TextBlock.Effect>
                                                <DropShadowEffect ShadowDepth="2"
                                                                  Direction="330"
                                                                  Color="{Binding TitleTextShadowColor}"
                                                                  Opacity="1.0"
                                                                  BlurRadius="4" />
                                            </TextBlock.Effect>
                                        </TextBlock>
                                        <TextBox Margin="10,0,0,0"
                                                 Background="White"
                                                 Foreground="Black"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Top"
                                                 SizeChanged="TextBox_SizeChanged"
                                                 LostFocus="ClipTile_LostFocus"
                                                 KeyDown="ClipTitleTextBox_KeyDown"
                                                 Visibility="{Binding TextBoxVisibility}"
                                                 Text="{Binding Title, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </StackPanel>
                                    <!-- Tile Content-->
                                    <TextBlock Text="{Binding Text}"
                                               Grid.Row="1"
                                               Grid.Column="0"
                                               Margin="0,0,0,5"
                                               FontSize="24"
                                               Foreground="Black"
                                               Background="White" />

                                </Grid>
                            </Border>
                        </Viewbox>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>
    </Grid>
</Window>
