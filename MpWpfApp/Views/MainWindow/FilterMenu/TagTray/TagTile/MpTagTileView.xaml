<local:MpUserControl x:Class="MpWpfApp.MpTagTileView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpTagTileViewModel"
                     mc:Ignorable="d"
                     d:DesignHeight="450"
                     d:DesignWidth="800"
                     d:DataContext="{d:DesignInstance local:MpTagTileViewModel, IsDesignTimeCreatable=False}">
    <local:MpClipBorder x:Name="TagTileBorder"
                        Loaded="TagTileBorder_Loaded"
                        MouseEnter="TagTileBorder_MouseEnter"
                        MouseLeave="TagTileBorder_MouseLeave"
                        LostFocus="TagTileBorder_LostFocus"
                        PreviewMouseLeftButtonDown="TagTileBorder_PreviewMouseLeftButtonDown"
                        PreviewMouseRightButtonDown="TagTileBorder_PreviewMouseRightButtonDown"
                        CornerRadius="10"
                        Margin="5,3,0,0"
                        Padding="7,5,7,5"
                        Focusable="True"
                        VerticalAlignment="Stretch"
                        Background="{Binding TagBorderBackgroundBrush}"
                        BorderBrush="{Binding TagBorderBrush}"
                        Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=Self}}"
                        BorderThickness="1.5"
                        Height="{Binding TagHeight}">
        <local:MpClipBorder.ContextMenu>
            <ContextMenu Loaded="TagTile_ContextMenu_Loaded"
                         Opened="TagTile_ContextMenu_Opened"
                         Closed="TagTile_ContextMenu_Closed">
                <MenuItem Header="Rename"
                          Icon="{Binding Source={StaticResource RenameIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                          Click="RenameMenuItem_Click" />
                <MenuItem Header="Assign Hotkey"
                          Icon="{Binding Source={StaticResource HotkeyIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                          InputGestureText="{Binding PlacementTarget.Tag.ShortcutKeyString, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}"
                          Command="{Binding PlacementTarget.Tag.AssignHotkeyCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" />
                <Separator />
                <MenuItem x:Name="ClipTileColorContextMenuItem"
                          Style="{StaticResource ColorPalleteMenuItemStyle}" />
                <Separator />
                <MenuItem Header="Delete"
                          Icon="{Binding Source={StaticResource DeleteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                          Click="DeleteMenuItem_Clicked" />
            </ContextMenu>
        </local:MpClipBorder.ContextMenu>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <!--  Tag Count Box  -->
            <local:MpClipBorder CornerRadius="5"
                                Grid.Column="0"
                                Grid.Row="0"
                                MinWidth="20"
                                Margin="3,0,0,0"
                                Padding="5"
                                BorderThickness="0"
                                Background="{Binding TagBrush, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}">
                <TextBlock Background="Transparent"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"
                           Text="{Binding TagClipCount, Converter={StaticResource IntToStringConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                           Foreground="{Binding TagCountTextColor}" />
            </local:MpClipBorder>
            <TextBlock x:Name="TagTextBlock"
                       Grid.Column="1"
                       Grid.Row="0"
                       Margin="5,0,0,0"
                       Background="Transparent"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Visibility="{Binding IsEditing, Converter={StaticResource BoolToVisibilityFlipConverter}}"
                       FontSize="{Binding TagFontSize}"
                       FontWeight="SemiBold"
                       Foreground="{Binding TagTextColor}"
                       Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" />
            <TextBox x:Name="TagTextBox"
                     IsVisibleChanged="TagTextBox_IsVisibleChanged"
                     LostFocus="TagTextBox_LostFocus"
                     PreviewKeyDown="TagTextBox_PreviewKeyDown"
                     Grid.Row="0"
                     Grid.Column="1"
                     Margin="5,0,0,0"
                     Background="White"
                     Foreground="Black"
                     IsReadOnly="False"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     Visibility="{Binding IsEditing, Converter={StaticResource BoolToVisibilityConverter}}"
                     FontSize="{Binding TagFontSize}"
                     Text="{Binding TagName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" />
        </Grid>
    </local:MpClipBorder>
</local:MpUserControl>
