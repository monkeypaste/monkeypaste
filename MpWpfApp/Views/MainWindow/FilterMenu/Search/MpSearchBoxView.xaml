<local:MpUserControl x:Class="MpWpfApp.MpSearchBoxView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpSearchBoxViewModel"
                     mc:Ignorable="d"
                     d:DesignHeight="450"
                     d:DesignWidth="800"
                     d:DataContext="{d:DesignInstance Type=local:MpSearchBoxViewModel,
                                                      IsDesignTimeCreatable=False}">
    <StackPanel x:Name="SearchViewContainerStackPanel"
                Loaded="SearchViewContainerStackPanel_Loaded"
                Orientation="Horizontal">
        <Button x:Name="DeleteSearchButton"
                Background="Transparent"
                Foreground="Transparent"
                BorderThickness="0"
                Command="{Binding DeleteSearchCommand}"
                local:MpHoverableExtension.IsEnabled="True"
                local:MpHoverableExtension.IsHovering="{Binding IsOverDeleteSearchButton}"
                Visibility="{Binding CanDeleteSearch,
                                     Converter={StaticResource BoolToVisibilityConverter},
                                     ConverterParameter={StaticResource Hide}}"
                Style="{StaticResource Transparent_Button}">
            <Border CornerRadius="5"
                    Padding="12,5"
                    Background="LightGray"
                    BorderBrush="{Binding DeleteSearchButtonBorderBrush}"
                    BorderThickness="3">
                <TextBlock FontWeight="Bold"
                           Text="DELETE"
                           Foreground="DimGray"
                           Background="Transparent" />
            </Border>
        </Button>
        <Button x:Name="SaveSearchButton"
                Background="Transparent"
                Foreground="Transparent"
                BorderThickness="0"
                Command="{Binding SaveSearchCommand}"
                local:MpHoverableExtension.IsEnabled="True"
                local:MpHoverableExtension.IsHovering="{Binding IsOverSaveSearchButton,
                                                                Mode=TwoWay}"
                Visibility="{Binding HasCriteriaItems,
                                     Converter={StaticResource BoolToVisibilityConverter},
                                     ConverterParameter={StaticResource Hide}}"
                Style="{StaticResource Transparent_Button}">
            <Border CornerRadius="5"
                    Padding="12,5"
                    Background="LightGray"
                    BorderBrush="{Binding SaveSearchButtonBorderBrush}"
                    BorderThickness="3">
                <TextBlock FontWeight="Bold"
                           Text="SAVE"
                           Foreground="DimGray"
                           Background="Transparent" />
            </Border>
        </Button>

        <!--  Search Border  -->
        <!--  Grid.ColumnSpan="{Binding SearchBorderColumnSpan}"  -->
        <local:MpClipBorder x:Name="SearchTextBoxBorder"
                            DataContextChanged="SearchTextBoxBorder_DataContextChanged"
                            Grid.Column="0"
                            Margin="8"
                            Width="280"
                            CornerRadius="10"
                            BorderBrush="{Binding IsTextValid,
                                                  Converter={StaticResource BoolToBrushConverter},
                                                  ConverterParameter='#FFFFFFFF|#FFFF0000'}"
                            Background="White"
                            BorderThickness="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.15*" />
                    <ColumnDefinition Width="*" />
                    <!--  Width is 0.1* or 0.2*  -->
                    <ColumnDefinition Width="{Binding ClearAndAddCriteriaColumnWidth}" />
                </Grid.ColumnDefinitions>
                <!--  Search Icon Dropdown Button  -->
                <Button x:Name="SearchDropDownButton"
                        PreviewMouseLeftButtonDown="SearchDropDownButton_PreviewMouseLeftButtonDown"
                        Background="Transparent"
                        Grid.Column="0"
                        Margin="3,0,0,0"
                        Width="25"
                        Height="25"
                        Template="{StaticResource SearchButtonControlTemplate}"
                        BorderThickness="0">
                    <!--<Button.ContextMenu>
                        <ContextMenu ItemsSource="{Binding Filters}">
                            <ContextMenu.ItemContainerStyle>
                                <Style TargetType="MenuItem">
                                    <Setter Property="Header" Value="{Binding Label}" />
                                    <Setter Property="IsChecked" Value="{Binding IsChecked, Mode=TwoWay}" />
                                    <Setter Property="IsCheckable" Value="True"/>
                                    <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                                </Style>
                            </ContextMenu.ItemContainerStyle>
                        </ContextMenu>
                    </Button.ContextMenu>-->
                    <Image Source="{Binding .,
                                            Source={StaticResource SearchIcon},
                                            Converter={StaticResource StringResourceToImageSourceConverter}}"
                           Stretch="Fill"
                           SnapsToDevicePixels="True" />
                </Button>
                <!--  Search TextBox  -->
                <TextBox x:Name="SearchBox"
                         GotFocus="SearchBox_GotFocus"
                         Grid.Column="1"
                         AllowDrop="False"
                         FontSize="18"
                         Background="Transparent"
                         PreviewMouseLeftButtonDown="SearchBox_PreviewMouseLeftButtonDown"
                         local:MpHoverableExtension.IsEnabled="True"
                         local:MpHoverableExtension.HoverCursor="IBeam"
                         Foreground="{Binding TextBoxTextBrush}"
                         FontStyle="{Binding TextBoxFontStyle}"
                         BorderThickness="0"
                         VerticalContentAlignment="Center"
                         KeyUp="SearchBox_KeyUp"
                         CaretBrush="{Binding CaretBrush}"
                         Text="{Binding SearchText,
                                        Mode=TwoWay,
                                        NotifyOnTargetUpdated=True,
                                        UpdateSourceTrigger=PropertyChanged}" />
                <!--  Placeholder TextBlock  -->
                <TextBlock x:Name="SearchBoxPlaceholderBlock"
                           Grid.Column="1"
                           FontSize="18"
                           IsHitTestVisible="False"
                           Visibility="{Binding IsPlaceholderVisible,
                                                Converter={StaticResource BoolToVisibilityConverter}}"
                           Text="{Binding PlaceholderText}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left"
                           Margin="0"
                           Foreground="DarkGray"
                           FontStyle="Italic" />
                <StackPanel Orientation="Horizontal"
                            Grid.Column="2">
                    <!--  IsSearching Spinner  -->
                    <local:MpSpinnerApple x:Name="IsSearchingSpinner"
                                          VerticalAlignment="Center"
                                          Margin="0,0,10,0"
                                          Visibility="{Binding IsSearching,
                                                               Converter={StaticResource BoolToVisibilityConverter}}" />
                    <!--  Clear SearchText Button  -->
                    <Button x:Name="ClearTextBoxButton"
                            Width="15"
                            Height="15"
                            local:MpHoverableExtension.IsEnabled="True"
                            local:MpHoverableExtension.IsHovering="{Binding IsOverClearTextButton}"
                            Style="{StaticResource SemiTransparentButton}"
                            BorderThickness="0"
                            VerticalAlignment="Center"
                            Visibility="{Binding ClearTextButtonVisibility}"
                            Click="ClearTextBoxButton_Click">
                        <Button.Background>
                            <ImageBrush ImageSource="{Binding ClearButtonImagePath,
                                                              Converter={StaticResource StringResourceToImageSourceConverter}}" />
                        </Button.Background>
                    </Button>
                    <!--  Search Navigation Border  -->
                    <Border CornerRadius="10"
                            Visibility="{Binding IsMultipleMatches,
                                                 Converter={StaticResource BoolToVisibilityConverter}}"
                            HorizontalAlignment="Left"
                            Margin="10,0,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="PreviousTemplateButton"
                                    TabIndex="2"
                                    Command="{Binding PrevMatchCommand}"
                                    Width="10"
                                    Height="10"
                                    Style="{StaticResource SemiTransparentButton}"
                                    Padding="5">
                                <Image Source="/Resources/Images/back_black.png" />
                            </Button>
                            <Button x:Name="NextTemplateButton"
                                    TabIndex="3"
                                    Command="{Binding NextMatchCommand}"
                                    Width="10"
                                    Height="10"
                                    Style="{StaticResource SemiTransparentButton}"
                                    Margin="3,0,0,0"
                                    Padding="5">
                                <Image Source="/Resources/Images/forward_black.png" />
                            </Button>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </local:MpClipBorder>
        <!--  Add Or Clear Search Criteria Button  -->
        <Button x:Name="AddSearchCriteriaButton"
                BorderThickness="0"
                Margin="5,10"
                Command="{Binding AddSearchCriteriaItemCommand}"
                Visibility="{Binding HasCriteriaItems,
                                     Converter={StaticResource BoolToVisibilityFlipConverter}}"
                Template="{StaticResource SearchButtonControlTemplate}">
            <Image Source="{Binding .,
                                    Source={StaticResource PlusIcon}}"
                   Height="20"
                   Width="20"
                   Stretch="Uniform" />
        </Button>
        <Button x:Name="ClearSearchCriteriaButton"
                BorderThickness="0"
                Margin="5"
                Command="{Binding ClearSearchCriteriaItemsCommand}"
                Visibility="{Binding HasCriteriaItems,
                                     Converter={StaticResource BoolToVisibilityConverter}}"
                Template="{StaticResource SearchButtonControlTemplate}">
            <Image Source="{Binding .,
                                    Source={StaticResource MinusIcon}}"
                   Height="20"
                   Width="20"
                   Stretch="Uniform" />
        </Button>
    </StackPanel>
</local:MpUserControl>
