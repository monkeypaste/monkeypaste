<local:MpUserControl x:Class="MpWpfApp.MpDropMenuView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpClipboardHandlerItemViewModel"
                     mc:Ignorable="d"
                     Canvas.Left="{Binding X}"
                     Canvas.Top="{Binding Y}"
                     Padding="5,5,0,0"
                     d:DesignHeight="450"
                     d:DesignWidth="800"
                     d:DataContext="{d:DesignInstance Type={x:Type local:MpClipboardHandlerItemViewModel},
                                                      IsDesignTimeCreatable=False}">
    <Border x:Name="DumbParentBorder"
            IsVisibleChanged="MpUserControl_IsVisibleChanged">
        <Border x:Name="DropMenuBorderContainer"
                CornerRadius="5"
                BorderThickness="1"
                BorderBrush="Black">
            <Border.Background>
                <SolidColorBrush Color="DimGray"
                                 Opacity="0.7" />
            </Border.Background>
            <Grid>
                <Button x:Name="HideDropMenuButton"
                        Width="8"
                        Height="8"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top"
                        MouseEnter="HideDropMenuButton_MouseEnter">
                    X
                </Button>

                <ListBox Background="Transparent"
                         BorderBrush="Transparent"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Center"
                         MaxWidth="500"
                         SelectionMode="Single"
                         ScrollViewer.IsDeferredScrollingEnabled="False"
                         ScrollViewer.CanContentScroll="False"
                         ScrollViewer.VerticalScrollBarVisibility="Hidden"
                         ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                         ItemsSource="{Binding Items}">
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="{x:Type ListBoxItem}">
                            <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                        <ContentPresenter />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel IsItemsHost="True"
                                                    ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                    Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid local:MpHoverableExtension.IsEnabled="True"
                                  local:MpHoverableExtension.IsHovering="{Binding IsSelected}">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Image Grid.Row="0"
                                       Width="30"
                                       Height="30"
                                       Margin="5"
                                       Stretch="Fill"
                                       Source="{Binding HandledFormatIconResourceKey,
                                                        Converter={StaticResource StringResourceToImageSourceConverter}}" />
                                <TextBlock Grid.Row="1"
                                           Background="Transparent"
                                           Foreground="{Binding ItemTitleForegroundBrush}"
                                           HorizontalAlignment="Center"
                                           FontSize="12"
                                           Text="{Binding HandledFormat}" />
                            </Grid>

                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>
    </Border>
</local:MpUserControl>
