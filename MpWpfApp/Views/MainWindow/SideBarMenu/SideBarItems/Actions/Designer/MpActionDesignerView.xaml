<local:MpUserControl x:Class="MpWpfApp.MpActionDesignerView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:dd="clr-namespace:GongSolutions.Wpf.DragDrop;assembly=GongSolutions.Wpf.DragDrop"
                     xmlns:sys="clr-namespace:System;assembly=mscorlib"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpActionCollectionViewModel"
                     mc:Ignorable="d"
                     d:DataContext="{d:DesignInstance Type=local:MpActionCollectionViewModel,
                                                      IsDesignTimeCreatable=False}">
    <Grid>
        <Grid.Background>
            <SolidColorBrush Color="Gray"
                             Opacity="0.7" />
        </Grid.Background>
        <local:MpZoomBorder ClipToBounds="True"
                            DataContext="{Binding}"
                            DesignerItem="{Binding SelectedItem}"
                            ShowGrid="{Binding IsAnySelected}"
                            OriginThickness="1.5"
                            GridLineThickness="0.5"
                            GridLineSpacing="50"
                            OriginBrush="Chartreuse"
                            GridLineBrush="Chartreuse">
            <ListBox x:Name="ActionDesignerListBox"
                     ClipToBounds="False"
                     Background="Transparent"
                     SelectedValuePath=""
                     BorderThickness="0"
                     IsSynchronizedWithCurrentItem="False"
                     ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                     ScrollViewer.VerticalScrollBarVisibility="Hidden"
                     ScrollViewer.CanContentScroll="False"
                     ScrollViewer.IsDeferredScrollingEnabled="True"
                     ItemsSource="{Binding AllSelectedTriggerActions}">
                <ListBox.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform ScaleX="{Binding ScaleX,
                                                         Mode=OneWayToSource}"
                                        ScaleY="{Binding ScaleY,
                                                         Mode=OneWayToSource}" />
                        <TranslateTransform />
                    </TransformGroup>
                </ListBox.RenderTransform>
                <ListBox.Template>
                    <ControlTemplate TargetType="{x:Type ListBox}">
                        <Border x:Name="Bd"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                Padding="1"
                                SnapsToDevicePixels="true">
                            <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </ListBox.Template>
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <local:MpDesignerCanvas x:Name="ActionDesignerCanvas"
                                                ClipToBounds="False"
                                                ShowVoronoi="False"
                                                MinDist="100.1"
                                                TipWidth="10"
                                                TailWidth="3"
                                                TransitionLineBorderBrush="White"
                                                TransitionLineThickness="1"
                                                EmptyLineBrush="Orange"
                                                IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Style.Resources>
                            <SolidColorBrush Color="Transparent"
                                             x:Key="{x:Static SystemColors.HighlightBrushKey}" />
                            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}"
                                             Color="Transparent" />
                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                             Color="Transparent" />
                            <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}"
                                             Color="Transparent" />
                        </Style.Resources>
                        <Setter Property="FocusVisualStyle"
                                Value="{x:Null}" />
                        <Setter Property="BorderThickness"
                                Value="0" />
                        <Setter Property="Background"
                                Value="Transparent" />
                        <Setter Property="HorizontalContentAlignment"
                                Value="Center" />
                        <Setter Property="VerticalContentAlignment"
                                Value="Center" />
                        <Setter Property="HorizontalAlignment"
                                Value="Center" />
                        <Setter Property="VerticalAlignment"
                                Value="Center" />
                        <Setter Property="ClipToBounds"
                                Value="False" />
                        <Setter Property="IsSelected"
                                Value="{Binding IsSelected,
                                                Mode=TwoWay,
                                                UpdateSourceTrigger=PropertyChanged,
                                                NotifyOnSourceUpdated=True,
                                                NotifyOnTargetUpdated=True}" />
                        <Setter Property="Canvas.Left"
                                Value="{Binding X,
                                                Mode=TwoWay,
                                                UpdateSourceTrigger=PropertyChanged,
                                                NotifyOnSourceUpdated=True,
                                                NotifyOnTargetUpdated=True}" />
                        <Setter Property="Canvas.Top"
                                Value="{Binding Y,
                                                Mode=TwoWay,
                                                UpdateSourceTrigger=PropertyChanged,
                                                NotifyOnSourceUpdated=True,
                                                NotifyOnTargetUpdated=True}" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                    <StackPanel Orientation="Vertical"
                                                HorizontalAlignment="Center">
                                        <ContentPresenter />
                                        <TextBlock HorizontalAlignment="Center"
                                                   Visibility="{Binding IsLabelVisible,
                                                                        Converter={StaticResource BoolToVisibilityConverter}}"
                                                   Padding="3"
                                                   FontSize="10"
                                                   Foreground="Wheat"
                                                   MaxWidth="{Binding Width}"
                                                   TextWrapping="Wrap"
                                                   Text="{Binding Label}">
                                            <TextBlock.Background>
                                                <SolidColorBrush Color="Black"
                                                                 Opacity="0.2" />
                                            </TextBlock.Background>
                                        </TextBlock>
                                    </StackPanel>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected"
                                                 Value="True">
                                            <Setter Property="BorderBrush"
                                                    Value="Transparent" />
                                            <Setter Property="Background"
                                                    Value="Transparent" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <local:MpActionDesignerItemView DataContext="{Binding}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </local:MpZoomBorder>
        <!--</zoompan:ZoomAndPanControl>-->
        <!--</local:MpDesignerViewbox>-->
        <Button x:Name="AddNewActionButton"
                Visibility="{Binding IsAnySelected,
                                     Converter={StaticResource BoolToVisibilityFlipConverter}}"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Background="Transparent"
                BorderThickness="0"
                local:MpHoverableExtension.IsEnabled="True"
                local:MpHoverableExtension.IsHovering="{Binding IsHovering,
                                                                Mode=TwoWay}"
                Style="{StaticResource SemiTransparentButton}"
                Command="{Binding ShowTriggerSelectorMenuCommand}"
                CommandParameter="{Binding RelativeSource={RelativeSource Self}}">
            <StackPanel Orientation="Vertical">
                <Grid>
                    <Ellipse Stroke="{Binding AddNewButtonBorderBrushHexColor}"
                             Fill="Transparent"
                             StrokeThickness="3"
                             Width="50"
                             Height="50" />
                    <Rectangle HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Fill="DimGray"
                               Height="30"
                               Width="3" />
                    <Rectangle HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Fill="DimGray"
                               Height="3"
                               Width="30" />
                </Grid>
                <Label HorizontalAlignment="Center">
                    Add New
                </Label>
            </StackPanel>
        </Button>
    </Grid>
</local:MpUserControl>
