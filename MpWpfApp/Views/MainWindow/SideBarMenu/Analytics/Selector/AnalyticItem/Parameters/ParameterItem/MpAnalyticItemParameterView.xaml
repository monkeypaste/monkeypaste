<local:MpUserControl x:Class="MpWpfApp.MpAnalyticItemParameterView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpAnalyticItemParameterViewModel"
                     mc:Ignorable="d"
                     d:DesignHeight="450"
                     d:DesignWidth="800"
                     HorizontalAlignment="Stretch"
                     d:DataContext="{d:DesignInstance Type=local:MpAnalyticItemParameterViewModel,
                                                      IsDesignTimeCreatable=False}">
    <Grid x:Name="ParamGrid"
          Background="DarkViolet">
        <Grid.Resources>
            <DataTemplate x:Key="MultiSelectComboBoxParameter"
                          DataType="local:MpMultiSelectComboBoxParameterViewModel">
                <DockPanel LastChildFill="False">
                    <TextBlock Grid.Column="0"
                               DockPanel.Dock="Left"
                               Margin="0,0,7,0"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Top"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="White"
                               Text="{Binding Label}" />
                    <Border DockPanel.Dock="Right"
                            BorderThickness="0"
                            CornerRadius="2"
                            ToolTipService.InitialShowDelay="2"
                            ToolTip="{Binding ParameterTooltipText}"
                            BorderBrush="{Binding ParameterBorderBrush}">
                        <ListBox x:Name="MultiSelectComboBox"
                                 Background="Transparent"
                                 HorizontalContentAlignment="Stretch"
                                 ItemsSource="{Binding Items}"
                                 SelectionMode="Multiple"
                                 HorizontalAlignment="Right"
                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                 MaxWidth="{Binding ActualWidth,
                                                    RelativeSource={RelativeSource AncestorType={x:Type Border}}}"
                                 MinWidth="80">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ListBoxItem}">
                                    <Setter Property="IsSelected"
                                            Value="{Binding IsSelected,
                                                            Mode=TwoWay,
                                                            NotifyOnTargetUpdated=True,
                                                            NotifyOnSourceUpdated=True,
                                                            UpdateSourceTrigger=PropertyChanged}" />
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Left" />
                                    <Setter Property="VerticalAlignment"
                                            Value="Stretch" />
                                    <Setter Property="VerticalContentAlignment"
                                            Value="Stretch" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type ListBoxItem}">
                                                <ContentPresenter />
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderThickness="1"
                                            Background="Transparent"
                                            BorderBrush="{Binding BorderBrush}">
                                        <TextBlock Background="{Binding BackgroundBrush}"
                                                   Foreground="OldLace"
                                                   local:MpHoverableExtension.IsEnabled="True"
                                                   local:MpHoverableExtension.IsHovering="{Binding IsHovering,
                                                                                                   Mode=TwoWay}"
                                                   Text="{Binding Label}" />
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>
                </DockPanel>
            </DataTemplate>
            <DataTemplate x:Key="ComboBoxParameter"
                          DataType="local:MpComboBoxParameterViewModel">
                <DockPanel LastChildFill="False">
                    <TextBlock Grid.Column="0"
                               DockPanel.Dock="Left"
                               Margin="0,0,7,0"
                               HorizontalAlignment="Left"
                               VerticalAlignment="Center"
                               FontSize="13"
                               Foreground="Black"
                               Text="{Binding Label}" />
                    <Border DockPanel.Dock="Right"
                            BorderThickness="0"
                            CornerRadius="2"
                            ToolTipService.InitialShowDelay="2"
                            ToolTip="{Binding ParameterTooltipText}"
                            BorderBrush="{Binding ParameterBorderBrush}">
                        <ComboBox ItemsSource="{Binding Items}"
                                  SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                                  IsSynchronizedWithCurrentItem="False"
                                  HorizontalAlignment="Right"
                                  MinWidth="80">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Label}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="IsSelected"
                                            Value="{Binding IsSelected,
                                                            Mode=TwoWay}" />
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                    </Border>
                </DockPanel>
            </DataTemplate>
            <DataTemplate x:Key="TextBoxParameter"
                          DataType="local:MpTextBoxParameterViewModel">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.3*" />
                        <ColumnDefinition Width="0.7*" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0"
                               Margin="0,0,7,0"
                               HorizontalAlignment="Left"
                               Text="{Binding Label}" />
                    <TextBox Grid.Column="1"
                             Text="{Binding CurrentValue,
                                            Mode=TwoWay,
                                            UpdateSourceTrigger=PropertyChanged,
                                            NotifyOnTargetUpdated=True}" />
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="CheckBoxParameter"
                          DataType="local:MpCheckBoxParameterViewModel">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Margin="0,0,7,0"
                               HorizontalAlignment="Left"
                               Text="{Binding Label}" />
                    <CheckBox IsChecked="{Binding BoolValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True}" />
                </StackPanel>
            </DataTemplate>
            <DataTemplate x:Key="SliderParameter"
                          DataType="local:MpSliderParameterViewModel">
                <DockPanel MinWidth="200">
                    <StackPanel Orientation="Vertical"
                                MaxWidth="80"
                                DockPanel.Dock="Left">
                        <TextBlock Text="{Binding Label}"
                                   VerticalAlignment="Top"
                                   HorizontalAlignment="Center"
                                   Foreground="Black"
                                   TextWrapping="Wrap" />
                        <TextBox Text="{Binding SliderValue,
                                                Mode=TwoWay,
                                                UpdateSourceTrigger=PropertyChanged,
                                                NotifyOnTargetUpdated=True,
                                                NotifyOnSourceUpdated=True}"
                                 HorizontalAlignment="Stretch" />
                    </StackPanel>
                    <Slider Minimum="{Binding Min}"
                            Maximum="{Binding Max}"
                            Margin="0,15,0,0"
                            Width="120"
                            HorizontalAlignment="Right"
                            DockPanel.Dock="Right"
                            Value="{Binding SliderValue,
                                            Mode=TwoWay,
                                            UpdateSourceTrigger=PropertyChanged,
                                            NotifyOnTargetUpdated=True,
                                            NotifyOnSourceUpdated=True}"
                            TickPlacement="None"
                            TickFrequency="{Binding TickFrequency}"
                            IsSnapToTickEnabled="False" />
                </DockPanel>
            </DataTemplate>
            <local:MpParameterViewSelector x:Key="ParameterViewSelector"
                                           MultiSelectComboBoxTemplate="{StaticResource MultiSelectComboBoxParameter}"
                                           ComboBoxTemplate="{StaticResource ComboBoxParameter}"
                                           TextBoxTemplate="{StaticResource TextBoxParameter}"
                                           CheckBoxTemplate="{StaticResource CheckBoxParameter}"
                                           SliderTemplate="{StaticResource SliderParameter}" />
        </Grid.Resources>
        <ContentControl Content="{Binding}"
                        Margin="5"
                        ContentTemplateSelector="{StaticResource ParameterViewSelector}" />
    </Grid>
</local:MpUserControl>
