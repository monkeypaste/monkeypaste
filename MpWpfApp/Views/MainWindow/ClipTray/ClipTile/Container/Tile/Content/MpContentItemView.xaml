<UserControl x:Class="MpWpfApp.MpContentItemView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:spinners="clr-namespace:xamlSpinnersWPF"
             xmlns:local="clr-namespace:MpWpfApp"
             mc:Ignorable="d"
             Focusable="True"
             d:DesignHeight="100"
             d:DesignWidth="800"
             d:DataContext="{d:DesignInstance local:MpContentItemViewModel, IsDesignTimeCreatable=True}">
    <i:Interaction.Behaviors>
        <local:MpSelectionBehavior x:Name="SelectionBehavior"/>
    </i:Interaction.Behaviors>    
    <Border BorderThickness="1"
            Focusable="True">
        <Border.BorderBrush>
            <DrawingBrush Viewport="0,0,7,7"
                        ViewportUnits="Absolute"
                        TileMode="Tile">
                <DrawingBrush.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing Brush="{Binding ItemBorderBrush}">
                            <GeometryDrawing.Geometry>
                                <GeometryGroup>
                                    <RectangleGeometry Rect="{Binding ItemBorderBrushRect}" />
                                    <RectangleGeometry Rect="50,50,50,50" />
                                </GeometryGroup>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingGroup>
                </DrawingBrush.Drawing>
            </DrawingBrush>
        </Border.BorderBrush>
        <Grid x:Name="ContentListItemViewGrid"
              Loaded="ContentListItemView_Loaded"
              DataContextChanged="ContentListItemView_DataContextChanged"
              DataContext="{Binding}"
              Focusable="{Binding Parent.IsExpanded}"
              Tag="{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}"
              MouseEnter="ContentListItemView_MouseEnter"
              MouseLeave="ContentListItemView_MouseLeave"
              HorizontalAlignment="Stretch"     
              VerticalAlignment="Stretch">
            <local:MpRtbView x:Name="EditorView"
                                 DataContext="{Binding}" />
            <!--<local:MpQuillEditorView x:Name="EditorView"
                                         DataContext="{Binding}" />-->
            <local:MpClipBorder x:Name="ContentListItemViewOverlayBorder"
                                Visibility="{Binding IsDragButtonVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Background="Transparent"
                                Tag="{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}"
                                ToolTipService.InitialShowDelay="750"
                                CornerRadius="5">
                <!--<local:MpClipBorder.ToolTip>
                    <ToolTip x:Name="ClipTileTooltip"
                             Visibility="{Binding PlacementTarget.DataContext.SubItemToolTipVisibility, RelativeSource={RelativeSource Self}}"
                             Placement="Top"
                             HorizontalOffset="{Binding PlacementTarget.DataContext.Parent.TileBorderWidth, RelativeSource={RelativeSource Self}}">
                        <ToolTip.Template>
                            <ControlTemplate>
                                <Border Background="White"
                                        BorderThickness="1"
                                        BorderBrush="Black"
                                        Padding="5">
                                    <Image Stretch="Fill"
                                           Source="{Binding PlacementTarget.Tag.CopyItemBmp,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:MpClipBorder}}" />
                                </Border>
                            </ControlTemplate>
                        </ToolTip.Template>
                    </ToolTip>
                </local:MpClipBorder.ToolTip>-->
                <Button x:Name="DragButton"
                        MouseEnter="DragButton_MouseEnter"
                        MouseLeave="DragButton_MouseLeave"
                        BorderThickness="0"                        
                        Cursor="SizeAll"
                        Margin="0,0,0,0"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Left"
                        Template="{StaticResource SearchButtonControlTemplate}">
                    <i:Interaction.Behaviors>
                        <local:MpClipTileDragBehavior x:Name="TileDragBehavior"/>
                    </i:Interaction.Behaviors>
                    <Image Width="{local:MpMeasurementsBinding ClipTileContentItemDragButtonSize}"
                           Height="{local:MpMeasurementsBinding ClipTileContentItemDragButtonSize}"
                           Source="/Resources/Images/burger.png"
                           Stretch="Uniform" />
                </Button>
            </local:MpClipBorder>
        </Grid>
    </Border>
</UserControl>
