<local:MpUserControl x:Class="MpWpfApp.MpClipTileTitleView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:PresentationOptions="https://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
                     xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:local="clr-namespace:MpWpfApp"
                     x:TypeArguments="local:MpContentItemViewModel"
                     mc:Ignorable="d PresentationOptions"
                     d:DesignHeight="450"
                     d:DesignWidth="800"
                     d:DataContext="{d:DesignInstance Type=local:MpContentItemViewModel,
                                                      IsDesignTimeCreatable=False}">
    <Grid x:Name="TileTitleGrid"
          Unloaded="Grid_Unloaded">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.75*" />
            <ColumnDefinition Width="0.25*" />
        </Grid.ColumnDefinitions>
        <Viewbox Stretch="Fill"
                 Grid.ColumnSpan="2">
            <Canvas x:Name="TitleSwirlCanvas"
                    Width="{local:MpMeasurementsBinding ClipTileDefaultMinSize,
                                                        Mode=OneWay}"
                    Height="{local:MpMeasurementsBinding ClipTileTitleHeight,
                                                         Mode=OneWay}"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    DataContext="{Binding TitleSwirlViewModel}">
                <Path x:Name="Layer0"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer0}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,22"
                                            IsClosed="True">
                                    <BezierSegment Point1="150,-10"
                                                   Point2="160,85"
                                                   Point3="270,40" />
                                    <LineSegment Point="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
                <Path x:Name="Layer1"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer1}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,35"
                                            IsClosed="True">
                                    <BezierSegment Point1="40,45"
                                                   Point2="75,20"
                                                   Point3="100,20" />
                                    <BezierSegment Point1="185,20"
                                                   Point2="130,65"
                                                   Point3="270,40" />
                                    <LineSegment Point="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
                <Ellipse x:Name="Layer2"
                         StrokeThickness="0"
                         DataContext="{Binding SwirlLayer2}"
                         Fill="{Binding LayerBrush}"
                         Opacity="0.2"
                         Width="87"
                         Height="28"
                         Canvas.Left="165"
                         Canvas.Top="24" />
                <Path x:Name="Layer3"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer3}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,55"
                                            IsClosed="True">
                                    <QuadraticBezierSegment Point1="30,10"
                                                            Point2="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
                <Button x:Name="FlipButton"
                        Visibility="{Binding Parent.Parent.FlipButtonVisibility}"
                        Background="Green"
                        Width="12"
                        Height="12"
                        Canvas.Top="3"
                        Canvas.Right="3"
                        Command="{Binding ToggleTileIsPinnedCommand,
                                          Source={StaticResource ClipTrayViewModel}}"
                        CommandParameter="{Binding Parent.Parent}" />
            </Canvas>
        </Viewbox>
        <Grid x:Name="ClipTileTitleTextGrid"
              Grid.Column="0"
              IsHitTestVisible="{Binding HasScrollVelocity,
                                         Source={StaticResource ClipTrayViewModel},
                                         Converter={StaticResource BoolFlipConverter}}"
              MouseEnter="ClipTileTitleTextGrid_MouseEnter"
              MouseLeave="ClipTileTitleTextGrid_MouseLeave"
              PreviewMouseLeftButtonDown="ClipTileTitleTextGrid_MouseLeftButtonDown"
              Margin="10,3,30,25"
              MaxWidth="{local:MpMeasurementsBinding ClipTileTitleTextGridMaxWidth}"
              MinWidth="{local:MpMeasurementsBinding ClipTileTitleTextGridMinWidth}"
              HorizontalAlignment="Left">
            <!--  Clip Title TextBlock  -->
            <TextBlock x:Name="ClipTileTitleTextBlock"
                       Text="{Binding Path=Text,
                                      ElementName=ClipTileTitleTextBox}"
                       FontSize="{local:MpMeasurementsBinding ClipTileTitleFontSize,
                                                              Mode=OneWay}"
                       Background="{Binding TileTitleTextGridBackgroundBrush}"
                       Foreground="White"
                       Visibility="{Binding IsEditingTitle,
                                            Converter={StaticResource BoolToVisibilityFlipConverter}}">
                <TextBlock.Effect>
                    <DropShadowEffect ShadowDepth="0.5"
                                      Direction="300"
                                      Color="Black"
                                      Opacity="0.70"
                                      BlurRadius="0.1" />
                </TextBlock.Effect>
            </TextBlock>
            <!--  Clip Title TextBox  -->
            <TextBox x:Name="ClipTileTitleTextBox"
                     IsVisibleChanged="ClipTileTitleTextBox_IsVisibleChanged"
                     LostFocus="ClipTileTitleTextBox_LostFocus"
                     PreviewKeyDown="ClipTileTitleTextBox_PreviewKeyDown"
                     Background="{StaticResource ClipTileTitleTextBoxBackgroundBrush}"
                     Foreground="Black"
                     FontSize="{local:MpMeasurementsBinding ClipTileTitleFontSize,
                                                              Mode=OneWay}"
                     IsReadOnly="False"
                     Visibility="{Binding IsEditingTitle,
                                          Converter={StaticResource BoolToVisibilityConverter}}"
                     Text="{Binding CopyItemTitle,
                                    Mode=TwoWay,
                                    NotifyOnTargetUpdated=True,
                                    NotifyOnSourceUpdated=True,
                                    UpdateSourceTrigger=PropertyChanged}" />

        </Grid>
        <Image x:Name="ClipTileAppIconHighlightedBorderImage"
               Grid.Column="1"
               HorizontalAlignment="Left"
               Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconBorderHighlightImage.ImageBase64,
                                Converter={StaticResource Base64StringToBitmapSourceConverter}}"
               Stretch="Fill"
               Visibility="Hidden"
               Width="{local:MpMeasurementsBinding ClipTileTitleIconBorderSize,
                                                   Mode=OneWay}"
               Height="{local:MpMeasurementsBinding ClipTileTitleIconBorderSize,
                                                    Mode=OneWay}" />
        <!--  Clip Title Icon Image  -->
        <Grid Grid.Column="1">
            <Button x:Name="ClipTileAppIconImageButton"
                    IsHitTestVisible="{Binding HasScrollVelocity,
                                               Source={StaticResource ClipTrayViewModel},
                                               Converter={StaticResource BoolFlipConverter}}"
                    MouseEnter="ClipTileAppIconImageButton_MouseEnter"
                    MouseLeave="ClipTileAppIconImageButton_MouseLeave"
                    PreviewMouseLeftButtonDown="ClipTileAppIconImageButton_PreviewMouseLeftButtonDown"
                    Style="{StaticResource Transparent_Button}"
                    Visibility="Visible"
                    HorizontalAlignment="Right"
                    Margin="0,0,20,0"
                    VerticalAlignment="Center"
                    RenderTransformOrigin="0.5,0.5"
                    Background="Transparent"
                    BorderThickness="0">
                <Button.RenderTransform>
                    <RotateTransform x:Name="ClipTileAppIconImageButtonRotateTransform" />
                </Button.RenderTransform>
                <Button.ContextMenu>
                    <local:MpClipTileSourceIconContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}" />
                </Button.ContextMenu>
                <Grid>
                    <Image x:Name="ClipTileAppIconBorderImage"
                           Loaded="ClipTileAppIconBorderImage_Loaded"
                           Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconBorderImage.ImageBase64,
                                            Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                           Stretch="Fill"
                           RenderTransformOrigin="0.5, 0.5"
                           Visibility="Hidden"
                           MaxWidth="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                  Mode=OneWay}"
                           MaxHeight="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                   Mode=OneWay}">
                        <Image.RenderTransform>
                            <ScaleTransform x:Name="ClipTileAppIconBorderImageScaleTransform" />
                        </Image.RenderTransform>
                    </Image>
                    <Image x:Name="ClipTileAppIconImage"
                           Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconImage.ImageBase64,
                                            Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                           Stretch="Uniform"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="Visible"
                           Width="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                               Mode=OneWay}"
                           Height="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                Mode=OneWay}" />
                    <!--<Viewbox Width="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                     Height="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                     Visibility="{Binding MultiSelectOrderMarkerVisibility}">
                                                                <Grid>
                                                                    <Ellipse HorizontalAlignment="Center"
                                                                             VerticalAlignment="Center"
                                                                             Width="{Binding TileTitleIconBorderSize}"
                                                                             Height="{Binding TileTitleIconBorderSize}"
                                                                             Fill="{Binding TileBorderBrush}" />
                                                                    <Ellipse HorizontalAlignment="Center"
                                                                             VerticalAlignment="Center"
                                                                             Width="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                             Height="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                             Fill="White" />
                                                                    <TextBlock Background="Transparent"
                                                                               Foreground="Black"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"
                                                                               FontSize="20"
                                                                               Text="{Binding MultiSelectedOrderIdxDisplayValue}" />
                                                                </Grid>
                                                            </Viewbox>-->
                </Grid>
            </Button>
        </Grid>
    </Grid>
</local:MpUserControl>
