<local:MpContentUserControl x:Class="MpWpfApp.MpClipTileTitleView"
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                            xmlns:PresentationOptions="https://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
                            xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                            xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                            xmlns:local="clr-namespace:MpWpfApp"
                            x:TypeArguments="local:MpContentItemViewModel"
                            mc:Ignorable="d PresentationOptions"
                            d:DesignHeight="450"
                            d:DesignWidth="800"
                            d:DataContext="{d:DesignInstance Type=local:MpContentItemViewModel,
                                                             IsDesignTimeCreatable=False}">
    <i:Interaction.Behaviors>
        <local:MpClipTileTitleHighlightBehavior x:Name="ClipTileTitleHighlightBehavior" />
        <local:MpSourceHighlightBehavior x:Name="SourceHighlightBehavior" />
    </i:Interaction.Behaviors>
    <Grid>
        <Viewbox VerticalAlignment="Top"
                 HorizontalAlignment="Left"
                 Stretch="Fill"
                 Width="{Binding Parent.TileBorderWidth}"
                 Height="{Binding ClipTileTitleHeight,
                                  Source={x:Static local:MpMeasurements.Instance}}"
                 Loaded="ClipTileAppIconBorderImage_Loaded"
                 Unloaded="Grid_Unloaded"
                 Grid.ColumnSpan="2">
            <Canvas x:Name="TitleSwirlCanvas"
                    Width="{Binding ClipTileDefaultMinSize,
                                    Source={x:Static local:MpMeasurements.Instance}}"
                    Height="{Binding ClipTileTitleHeight,
                                     Source={x:Static local:MpMeasurements.Instance}}"
                    DataContext="{Binding TitleSwirlViewModel}">
                <Path x:Name="Layer0"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer0}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,22"
                                            IsClosed="True">
                                    <BezierSegment Point1="150,-10"
                                                   Point2="160,85"
                                                   Point3="270,40" />
                                    <LineSegment Point="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
                <Path x:Name="Layer1"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer1}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,35"
                                            IsClosed="True">
                                    <BezierSegment Point1="40,45"
                                                   Point2="75,20"
                                                   Point3="100,20" />
                                    <BezierSegment Point1="185,20"
                                                   Point2="130,65"
                                                   Point3="270,40" />
                                    <LineSegment Point="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
                <Ellipse x:Name="Layer2"
                         StrokeThickness="0"
                         DataContext="{Binding SwirlLayer2}"
                         Fill="{Binding LayerBrush}"
                         Opacity="0.2"
                         Width="87"
                         Height="28"
                         Canvas.Left="165"
                         Canvas.Top="24" />
                <Path x:Name="Layer3"
                      StrokeThickness="0"
                      DataContext="{Binding SwirlLayer3}"
                      Fill="{Binding LayerBrush}"
                      Opacity="{Binding LayerOpacity}">
                    <Path.Data>
                        <PathGeometry PresentationOptions:Freeze="True">
                            <PathGeometry.Figures>
                                <PathFigure StartPoint="0,55"
                                            IsClosed="True">
                                    <QuadraticBezierSegment Point1="30,10"
                                                            Point2="270,0" />
                                    <LineSegment Point="0,0" />
                                </PathFigure>
                            </PathGeometry.Figures>
                        </PathGeometry>
                    </Path.Data>
                </Path>
            </Canvas>
        </Viewbox>

        <Canvas x:Name="ClipTileTitleTextGrid"
                DataContext="{Binding}"
                ClipToBounds="True"
                Grid.Column="0"
                IsHitTestVisible="{Binding HasScrollVelocity,
                                           Source={x:Static local:MpClipTrayViewModel.Instance},
                                           Converter={StaticResource BoolFlipConverter}}"
                MouseEnter="ClipTileTitleTextGrid_MouseEnter"
                MouseLeave="ClipTileTitleTextGrid_MouseLeave"
                PreviewMouseLeftButtonDown="ClipTileTitleTextGrid_MouseLeftButtonDown"
                Margin="10,3,30,25"
                Width="{Binding ClipTileTitleTextGridMaxWidth, Source={x:Static local:MpMeasurements.Instance}}"
                HorizontalAlignment="Left">
            <!--  Clip Title TextBlock  -->

            <TextBlock x:Name="ClipTileTitleTextBlock"
                       Text="{Binding Path=Text,
                                      ElementName=ClipTileTitleTextBox}"
                       FontSize="{local:MpMeasurementsBinding ClipTileTitleFontSize,
                                                              Mode=OneWay}"
                       Foreground="White"
                       Visibility="Hidden">
                <TextBlock.Effect>
                    <DropShadowEffect ShadowDepth="0.5"
                                      Direction="300"
                                      Color="Black"
                                      Opacity="0.70"
                                      BlurRadius="0.1" />
                </TextBlock.Effect>
            </TextBlock>
            
            <Image x:Name="ClipTileTitleMarqueeImage"
                   
                   local:MpMarqueeExtension.IsEnabled="True"
                   local:MpMarqueeExtension.DropShadowOffset="1 1"
                   local:MpMarqueeExtension.TextBox="{Binding ElementName=ClipTileTitleTextBox}"
                   Visibility="{Binding IsEditingTitle,
                                        Converter={StaticResource BoolToVisibilityFlipConverter}}" />
            <!--  Clip Title TextBox  -->
            <TextBox x:Name="ClipTileTitleTextBox"
                     IsVisibleChanged="ClipTileTitleTextBox_IsVisibleChanged"
                     LostFocus="ClipTileTitleTextBox_LostFocus"
                     PreviewKeyDown="ClipTileTitleTextBox_PreviewKeyDown"
                     local:MpIsFocusedExtension.IsEnabled="True"
                     Background="{StaticResource ClipTileTitleTextBoxBackgroundBrush}"
                     Foreground="Black"
                     FontSize="{local:MpMeasurementsBinding ClipTileTitleFontSize,
                                                            Mode=OneWay}"
                     IsReadOnly="False"
                     Visibility="{Binding IsEditingTitle,
                                          Converter={StaticResource BoolToVisibilityConverter},
                                          ConverterParameter={StaticResource Hide}}"
                     Text="{Binding CopyItemTitle,
                                    Mode=TwoWay,
                                    NotifyOnTargetUpdated=True,
                                    NotifyOnSourceUpdated=True,
                                    UpdateSourceTrigger=PropertyChanged}" />
        </Canvas>
        <!--  Clip Title Icon Image  -->
        <Grid Grid.Column="1"
              Margin="0,0,0,0"
              HorizontalAlignment="Right"
              ClipToBounds="False">
            <Button x:Name="PinButton"
                    MouseEnter="PinButton_MouseEnter"
                    MouseLeave="PinButton_MouseLeave"
                    Background="Transparent"
                    Style="{StaticResource Transparent_Button}"
                    BorderThickness="0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Visibility="{Binding Parent.PinButtonVisibility}"
                    Command="{Binding ToggleTileIsPinnedCommand,
                                      Source={x:Static local:MpClipTrayViewModel.Instance}}"
                    CommandParameter="{Binding Parent}">
                <Image x:Name="PinButtonImage"
                       Width="15"
                       Height="15"
                       Stretch="Fill"
                       Source="{Binding Parent.PinIconSourcePath,
                                        Converter={StaticResource StringResourceToImageSourceConverter}}" />
            </Button>
            <Ellipse x:Name="SourceMatchEllipse"
                     Visibility="Hidden"
                     StrokeThickness="1"
                     RenderTransformOrigin="0.5,0.5"
                     HorizontalAlignment="Right"
                     VerticalAlignment="Center"
                     Margin="0,3,13,0"
                     Width="{local:MpMeasurementsBinding ClipTileTitleIconBorderSize}"
                     Height="{local:MpMeasurementsBinding ClipTileTitleIconBorderSize}" />
            <Button x:Name="ClipTileAppIconImageButton"
                    IsHitTestVisible="{Binding HasScrollVelocity,
                                               Source={x:Static local:MpClipTrayViewModel.Instance},
                                               Converter={StaticResource BoolFlipConverter}}"
                    MouseEnter="ClipTileAppIconImageButton_MouseEnter"
                    MouseLeave="ClipTileAppIconImageButton_MouseLeave"
                    PreviewMouseLeftButtonDown="ClipTileAppIconImageButton_PreviewMouseLeftButtonDown"
                    Style="{StaticResource Transparent_Button}"
                    Visibility="Visible"
                    HorizontalAlignment="Right"
                    Margin="0,0,20,0"
                    VerticalAlignment="Center"
                    RenderTransformOrigin="0.5,0.5"
                    Background="Transparent"
                    BorderThickness="0">
                <Button.RenderTransform>
                    <RotateTransform x:Name="ClipTileAppIconImageButtonRotateTransform" />
                </Button.RenderTransform>
                <Button.ContextMenu>
                    <local:MpClipTileSourceIconContextMenu DataContext="{Binding PlacementTarget.DataContext,
                                                                                 RelativeSource={RelativeSource Self}}" />
                </Button.ContextMenu>
                <Grid>
                    <Image x:Name="ClipTileAppIconBorderImage"
                           Loaded="ClipTileAppIconBorderImage_Loaded"
                           Source="{Binding SourceId,
                                            Converter={StaticResource SourceIdToImageSourceConverter},
                                            ConverterParameter='border'}"
                           Stretch="Fill"
                           RenderTransformOrigin="0.5, 0.5"
                           Visibility="Hidden"
                           MaxWidth="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                  Mode=OneWay}"
                           MaxHeight="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                   Mode=OneWay}">
                        <Image.RenderTransform>
                            <ScaleTransform x:Name="ClipTileAppIconBorderImageScaleTransform" />
                        </Image.RenderTransform>
                    </Image>
                    <Image x:Name="ClipTileAppIconImage"
                           Source="{Binding SourceId,
                                            Converter={StaticResource SourceIdToImageSourceConverter}}"
                           Stretch="UniformToFill"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="Visible"
                           Width="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                               Mode=OneWay}"
                           Height="{local:MpMeasurementsBinding ClipTileTitleIconSize,
                                                                Mode=OneWay}" />
                    <!--<Viewbox Width="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                     Height="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                     Visibility="{Binding MultiSelectOrderMarkerVisibility}">
                                                                <Grid>
                                                                    <Ellipse HorizontalAlignment="Center"
                                                                             VerticalAlignment="Center"
                                                                             Width="{Binding TileTitleIconBorderSize}"
                                                                             Height="{Binding TileTitleIconBorderSize}"
                                                                             Fill="{Binding TileBorderBrush}" />
                                                                    <Ellipse HorizontalAlignment="Center"
                                                                             VerticalAlignment="Center"
                                                                             Width="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                             Height="{local:MpMeasurementsBinding ClipTileTitleIconSize}"
                                                                             Fill="White" />
                                                                    <TextBlock Background="Transparent"
                                                                               Foreground="Black"
                                                                               HorizontalAlignment="Center"
                                                                               VerticalAlignment="Center"
                                                                               FontSize="20"
                                                                               Text="{Binding MultiSelectedOrderIdxDisplayValue}" />
                                                                </Grid>
                                                            </Viewbox>-->
                </Grid>
            </Button>
        </Grid>
    </Grid>
</local:MpContentUserControl>
