<Window x:Class="MpWpfApp.MpManageAnalyticItemModalWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MpWpfApp"
        mc:Ignorable="d"
        Title="Manage Analyzer"
        Width="600"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterScreen"
        d:DataContext="{d:DesignInstance local:MpAnalyticItemViewModel, IsDesignTimeCreatable=False}">
    <StackPanel>
        <DataGrid x:Name="AnalyticItemDatagrid"
                  ItemsSource="{Binding PresetViewModels}"
                  SelectionMode="Single"
                  Margin="10,0,10,5"
                  Width="Auto"
                  Height="Auto"
                  CanUserAddRows="False"
                  IsReadOnly="False"
                  AutoGenerateColumns="False">
            <DataGrid.Columns>
                <DataGridTemplateColumn Width="50">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button x:Name="PresetIcon"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Background="Transparent"
                                    Template="{StaticResource SearchButtonControlTemplate}"
                                    Command="{Binding ChangeIconCommand}"
                                    CommandParameter="{Binding RelativeSource={RelativeSource Self}}">
                                <Image Width="20"
                                       Height="20"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Source="{Binding PresetIcon, Converter={StaticResource Base64StringToBitmapSourceConverter}}" />
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <!--<DataGridTemplateColumn Header="Application"
                                        Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Label Content="{Binding Parent.Title}"
                                   VerticalAlignment="Center" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>-->
                <DataGridTemplateColumn Header="Preset Name"
                                        Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox IsReadOnly="{Binding IsReadOnly}"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Text="{Binding Label, Mode=TwoWay, UpdateSourceTrigger=LostFocus, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}"
                                     VerticalAlignment="Center" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Quick Action?"
                                        Width="Auto">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding IsQuickAction, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="Shortcut"
                                    Width="100"
                                    IsReadOnly="True"
                                    Binding="{Binding ShortcutKeyString}" />
                <DataGridTemplateColumn Width="50">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Background="White"
                                    BorderThickness="0"
                                    ToolTip="Reassign"
                                    Command="{Binding AssignHotkeyCommand}">
                                <Image Width="20"
                                       Height="20"
                                       Source="/MpWpfApp;component/Resources/Icons/Silk/icons/anchor.png" />
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Sort" Width="33">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button x:Name="ShiftDownButton"
                                        DataContextChanged="ShiftDownButton_DataContextChanged"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Background="Transparent"
                                        Width="15"
                                        Height="20"
                                        Template="{StaticResource SearchButtonControlTemplate}">
                                    <Image Stretch="UniformToFill" 
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Source="/MpWpfApp;component/Resources/Images/desc_black.png" />
                                </Button>
                                <Button x:Name="ShiftUpButton"
                                        BorderThickness="0"
                                        DataContextChanged="ShiftUpButton_DataContextChanged"
                                        Cursor="Hand"
                                        Width="15"
                                        Height="20"
                                        Background="Transparent"
                                        Template="{StaticResource SearchButtonControlTemplate}">
                                    <Image Stretch="UniformToFill"
                                            HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Source="/MpWpfApp;component/Resources/Images/asc_black.png" />
                                </Button>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Width="50">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Background="White"
                                    BorderThickness="0"
                                    ToolTip="Delete"
                                    Command="{Binding Parent.DeletePresetCommand}"
                                    CommandParameter="{Binding}">
                                <Image Width="20"
                                       Height="20"
                                       Visibility="{Binding IsReadOnly, Converter={StaticResource BoolToVisibilityFlipConverter}}"
                                       Source="/MpWpfApp;component/Resources/Images/delete.png" />
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        <StackPanel Orientation="Horizontal"
                    Margin="0,10,15,0"
                    HorizontalAlignment="Right">
            <Button x:Name="OkButton"
                    TabIndex="2"
                    Width="100"
                    Height="25"
                    Margin="0,0,7,0"
                    Content="_Save"
                    Click="OKButton_Click" />
            <Button Content="_Cancel"
                    TabIndex="3"
                    Width="100"
                    Height="25"
                    Click="Cancel_Click" />
        </StackPanel>
    </StackPanel>
</Window>
