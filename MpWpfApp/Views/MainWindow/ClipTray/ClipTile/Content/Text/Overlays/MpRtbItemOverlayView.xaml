<UserControl x:Class="MpWpfApp.MpRtbItemOverlayView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:spinners="clr-namespace:xamlSpinnersWPF"
             xmlns:local="clr-namespace:MpWpfApp"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <local:MpClipBorder x:Name="RtbListBoxItemOverlayBorder"
                        DataContext="{Binding}"
                        Visibility="{Binding SubItemOverlayVisibility}"
                        Width="{Binding RtbCanvasWidth}"
                        Height="{Binding RtbCanvasHeight}"
                        Background="{Binding RtbListBoxItemBackgroundColor}"
                        Tag="{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}"
                        ToolTipService.InitialShowDelay="750"
                        BorderBrush="{Binding RtbOverlayBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="5">
        <local:MpClipBorder.ToolTip>
            <ToolTip x:Name="ClipTileTooltip"
                     Visibility="{Binding PlacementTarget.Tag.SubItemToolTipVisibility, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:MpClipBorder}}"
                     Placement="Top"
                     HorizontalOffset="{Binding PlacementTarget.Tag.HostClipTileViewModel.TileBorderWidth, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:MpClipBorder}}">
                <ToolTip.Template>
                    <ControlTemplate>
                        <Border Background="White"
                                BorderThickness="1"
                                BorderBrush="Black"
                                Padding="5">
                            <Image Stretch="Fill"
                                   Source="{Binding PlacementTarget.Tag.CopyItemBmp,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:MpClipBorder}}" />
                        </Border>
                    </ControlTemplate>
                </ToolTip.Template>
            </ToolTip>
        </local:MpClipBorder.ToolTip>
        <DockPanel x:Name="RtbListItemOverlayBorderDockPanel"
                   DataContext="{Binding}"
                   Width="{Binding RtbCanvasWidth}"
                   Height="{Binding RtbCanvasHeight}">
            <DockPanel DockPanel.Dock="Left"
                       Visibility="{Binding DragAndHotkeyButtonVisibility}">
                <Button x:Name="RtbListBoxItemOverlayBorderGridDragButton"
                        DockPanel.Dock="Top"
                        BorderThickness="0"
                        Cursor="SizeAll"
                        Margin="0,0,0,0"
                        Background="Transparent"
                        VerticalAlignment="Top"
                        VerticalContentAlignment="Top"
                        HorizontalAlignment="Left"
                        HorizontalContentAlignment="Left"
                        Width="{Binding DragButtonSize}"
                        Height="{Binding DragButtonSize}"
                        Template="{StaticResource SearchButtonControlTemplate}">
                    <Image HorizontalAlignment="Left"
                           Source="/Resources/Images/burger.png"
                           Stretch="Fill" />
                </Button>
                <Button x:Name="RtbListboxItemHotkeyButton"
                        DockPanel.Dock="Bottom"
                        VerticalAlignment="Bottom"
                        VerticalContentAlignment="Bottom"
                        HorizontalAlignment="Center"
                        HorizontalContentAlignment="Center"
                        Width="14"
                        Height="14"
                        Margin="0,0,0,0"
                        ToolTipService.InitialShowDelay="0"
                        ToolTip="{Binding HotkeyIconTooltip}"
                        Command="{Binding AssignHotkeyToSubSelectedItemCommand}"
                        Visibility="{Binding SubItemOverlayVisibility}"
                        Template="{StaticResource SearchButtonControlTemplate}">
                    <Image Source="{Binding HotkeyIconSource}" />
                </Button>
            </DockPanel>
            <DockPanel DockPanel.Dock="Right">
                <TextBlock x:Name="RtbListBoxItemTitleTextBlock"
                           DockPanel.Dock="Top"
                           Opacity="1"
                           Margin="0,0,25,0"
                           TextAlignment="Right"
                           HorizontalAlignment="Right"
                           VerticalAlignment="Top"
                           Cursor="IBeam"
                           ToolTip="{Binding DetailText}"
                           Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}"
                           FontSize="{Binding RtbListBoxItemTitleFontSize}"
                           Foreground="{Binding RtbListBoxItemTitleTextBlockTextColor}"
                           FontWeight="Bold"
                           Background="Transparent"
                           Visibility="{Binding RtbListBoxItemTitleTextBlockVisibility}">
                                                                                                    <!--<TextBlock.Effect>
                                                                                                        <DropShadowEffect ShadowDepth="2"
                                                                                                                          Direction="300"
                                                                                                                          Color="Black"
                                                                                                                          Opacity="1.0"
                                                                                                                          BlurRadius="3" />
                                                                                                    </TextBlock.Effect>--></TextBlock>
                <TextBox x:Name="RtbListBoxItemTitleTextBox"
                         DockPanel.Dock="Top"
                         Opacity="1"
                         Margin="0,0,25,0"
                         TextAlignment="Right"
                         VerticalAlignment="Top"
                         HorizontalAlignment="Right"
                         Background="White"
                         Foreground="Black"
                         FontSize="{Binding RtbListBoxItemTitleFontSize}"
                         IsReadOnly="False"
                         Visibility="{Binding RtbListBoxItemTitleTextBoxVisibility}"
                         Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}" />
                <!-- Sub Item Title Icon Image -->
                <Canvas DockPanel.Dock="Right"
                        HorizontalAlignment="Right"
                        Width="{Binding SubItemAppIconBorderSize}"
                        Height="{Binding SubItemAppIconBorderSize}"
                        Background="Transparent"
                        Margin="0,0,25,0"
                        Visibility="{Binding SubItemOverlayVisibility}">
                    <Image x:Name="RtbItemAppIconHighlightedBorderImage"
                           Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconBorderHighlightImage.ImageBase64, Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                           Stretch="Fill"
                           Visibility="{Binding AppIconHighlightBorderVisibility}"
                           Width="{Binding SubItemAppIconBorderSize}"
                           Height="{Binding SubItemAppIconBorderSize}" />
                    <Button x:Name="RtbItemAppIconImageButton"
                            Canvas.Top="-2"
                            Margin="0"
                            Style="{StaticResource Transparent_Button}"
                            Visibility="{Binding SubItemOverlayVisibility}"
                            Background="Transparent"
                            BorderThickness="0">
                        <Button.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Exclude Application"
                                          Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                          Command="{Binding PlacementTarget.Tag.ExcludeSubSelectedItemApplicationCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                                <MenuItem Header="Add Paste Macro For Application"
                                          Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                          Command="{Binding SystemTrayViewModel.ShowSettingsWindowCommand, Source={StaticResource MainWindowViewModel}}"
                                          CommandParameter="{Binding}" />
                            </ContextMenu>
                        </Button.ContextMenu>
                        <Grid>
                            <Image x:Name="RtbItemAppIconImage"
                                   Visibility="{Binding AppIconImageVisibility}"
                                   Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconImage.ImageBase64, Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                                   Stretch="Fill"
                                   Width="{Binding SubItemAppIconSize}"
                                   Height="{Binding SubItemAppIconSize}" />
                            <!--<Viewbox Visibility="{Binding MultiSelectOrderMarkerVisibility}"
                                                                                                                         Width="{Binding SubItemAppIconBorderSize}"
                                                                                                                         Height="{Binding SubItemAppIconBorderSize}">
                                                                                                                    <Grid>
                                                                                                                        <Ellipse HorizontalAlignment="Center"
                                                                                                                                 VerticalAlignment="Center"
                                                                                                                                 Width="{Binding SubItemAppIconBorderSize}"
                                                                                                                                 Height="{Binding SubItemAppIconBorderSize}"
                                                                                                                                 Fill="{Binding RtbOverlayBorderBrush}" />
                                                                                                                        <Ellipse HorizontalAlignment="Center"
                                                                                                                                 VerticalAlignment="Center"
                                                                                                                                 Width="{Binding SubItemAppIconSize}"
                                                                                                                                 Height="{Binding TileTitleIconSize}"
                                                                                                                                 Fill="White" />
                                                                                                                        <TextBlock Background="Transparent"
                                                                                                                                   Foreground="Black"
                                                                                                                                   HorizontalAlignment="Center"
                                                                                                                                   VerticalAlignment="Center"
                                                                                                                                   FontSize="14"
                                                                                                                                   Text="{Binding MultiSelectedOrderIdxDisplayValue}" />
                                                                                                                    </Grid>
                                                                                                                </Viewbox>-->
                        </Grid>
                    </Button>
                </Canvas>
            </DockPanel>
        </DockPanel>
    </local:MpClipBorder>
</UserControl>
