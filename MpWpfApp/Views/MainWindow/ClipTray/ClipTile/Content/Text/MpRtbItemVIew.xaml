<UserControl x:Class="MpWpfApp.MpRtbItemView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:spinners="clr-namespace:xamlSpinnersWPF"
             xmlns:local="clr-namespace:MpWpfApp"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <AdornerDecorator x:Name="RtbListBoxItemCanvasAdorner"
                      AllowDrop="True"
                      DataContext="{Binding}">
        <Canvas x:Name="RtbListBoxItemCanvas"
                Loaded="RtbListBoxItemCanvas_Loaded"
                DataContext="{Binding}"
                Focusable="{Binding HostClipTileViewModel.IsExpanded}"
                Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                Width="{Binding RtbCanvasWidth}"
                Height="{Binding RtbCanvasHeight}"
                Tag="{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}"
                MouseEnter="RtbListBoxItemCanvas_MouseEnter"
                MouseLeave="RtbListBoxItemCanvas_MouseLeave"
                HorizontalAlignment="Left"
                AllowDrop="True"
                VerticalAlignment="Top">
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="Loaded">
                    <i:CallMethodAction TargetObject="{Binding}"
                                        MethodName="RtbItem_Loaded" />
                </i:EventTrigger>
            </i:Interaction.Triggers>
            <Canvas.Resources>
                <local:MpBindingProxy x:Key="RtbListBoxItemProxy"
                                      Data="{Binding}" />
            </Canvas.Resources>
            <Canvas.ContextMenu>
                <ContextMenu x:Name="RtbItem_ContextMenu"
                             Loaded="RtbItem_ContextMenu_Loaded"
                             Opened="RtbItem_ContextMenu_Opened"
                             Closed="RtbItem_ContextMenu_Closed">
                    <MenuItem Header="_Copy"
                              Tag="27"
                              Icon="{Binding Source={StaticResource CopyIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                              Command="{Binding CopySelectedClipsCommand, Source={StaticResource ClipTrayViewModel}}" />
                    <MenuItem Header="_Paste"
                              Tag="6"
                              Icon="{Binding Source={StaticResource PasteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                              Command="{Binding PlacementTarget.Tag.PasteSubItemCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                    <Separator />
                    <MenuItem Header="Delete"
                              Tag="7"
                              Icon="{Binding Source={StaticResource DeleteIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                              Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.DeleteSubSelectedClipsCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                    <Separator />
                    <MenuItem Header="_Edit"
                              Icon="{Binding Source={StaticResource EditIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                        <MenuItem Header="_Edit Content"
                                  Tag="20"
                                  Icon="{Binding Source={StaticResource EditContentIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.ToggleEditSubSelectedItemCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="_Rename"
                                  Tag="21"
                                  Icon="{Binding Source={StaticResource RenameIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.EditSubTitleCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <Separator />
                        <MenuItem x:Name="TranslateMenuItem"
                                  Header="Translate"
                                  Icon="{Binding Source={StaticResource TranslateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  ItemsSource="{Binding TranslateLanguageMenuItems, Source={StaticResource ClipTrayViewModel}}">
                            <MenuItem.ItemContainerStyle>
                                <Style TargetType="{x:Type MenuItem}">
                                    <Setter Property="Header"
                                            Value="{Binding Header}" />
                                    <Setter Property="Command"
                                            Value="{Binding Command}" />
                                    <Setter Property="CommandParameter"
                                            Value="{Binding CommandParameter}" />
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Left" />
                                    <Setter Property="VerticalContentAlignment"
                                            Value="Top" />
                                </Style>
                            </MenuItem.ItemContainerStyle>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem x:Name="ToolsMenuItem"
                              Header="_Tools"
                              Icon="{Binding Source={StaticResource ToolsIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                        <MenuItem Header="Duplicate"
                                  Tag="22"
                                  Icon="{Binding Source={StaticResource DuplicateIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.DuplicateSubSelectedClipsCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="_Merge"
                                  Tag="17"
                                  Icon="{Binding Source={StaticResource MergeIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding MergeSelectedClipsCommand, Source={StaticResource ClipTrayViewModel}}" />
                        <Separator />
                        <MenuItem Header="Send as Email"
                                  Tag="23"
                                  Icon="{Binding Source={StaticResource EmailIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.SendSubSelectedToEmailCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="Duplicate As _Qr Code"
                                  Tag="24"
                                  Icon="{Binding Source={StaticResource QrIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.CreateQrCodeFromSubSelectedItemCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <Separator />
                        <MenuItem Header="Say"
                                  Tag="16"
                                  Icon="{Binding Source={StaticResource SpeakIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SpeakSubSelectedClipsAsyncCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <Separator />
                        <MenuItem Header="Search"
                                  Icon="{Binding Source={StaticResource SearchIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                            <MenuItem Header="_Google"
                                      Icon="{Binding Source={StaticResource GoogleIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                      Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SearchWebCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"
                                      CommandParameter="https://www.google.com/search?q=" />
                            <MenuItem Header="_Bing"
                                      Icon="{Binding Source={StaticResource BingIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                      Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SearchWebCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"
                                      CommandParameter="https://www.bing.com/search?q=" />
                            <MenuItem Header="_DuckDuckGo"
                                      Icon="{Binding Source={StaticResource DuckIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                      Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SearchWebCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"
                                      CommandParameter="https://duckduckgo.com/?q=" />
                            <MenuItem Header="_Yandex"
                                      Icon="{Binding Source={StaticResource YandexIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                      Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SearchWebCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}"
                                      CommandParameter="https://yandex.com/search/?text=" />
                        </MenuItem>
                        <Separator />
                        <MenuItem x:Name="ExcludeApplication"
                                  Header="Exclude Application"
                                  Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.ExcludeSubSelectedItemApplicationCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="Add Paste Macro For Application"
                                  Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding ShowSettingsWindowCommand, Source={StaticResource SystemTrayViewModel}}"
                                  CommandParameter="{Binding}" />
                    </MenuItem>
                    <MenuItem Header="_Selection"
                              Icon="{Binding Source={StaticResource SelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}">
                        <MenuItem Header="_Bring to Front"
                                  Tag="12"
                                  Icon="{Binding Source={StaticResource BringToFrontIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.BringSubSelectedClipTilesToFrontCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="_Send to Back"
                                  Tag="13"
                                  Icon="{Binding Source={StaticResource SendToBackIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SendSubSelectedClipTilesToBackCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <Separator />
                        <MenuItem Header="Select _All"
                                  Tag="10"
                                  Icon="{Binding Source={StaticResource SelectAllIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.SelectAllCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                        <MenuItem Header="_Invert Selection"
                                  Tag="11"
                                  Icon="{Binding Source={StaticResource InvertSelectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                  Command="{Binding PlacementTarget.Tag.RtbItemCollectionViewModel.InvertSubSelectionCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                    </MenuItem>
                    <MenuItem Header="_Hotkey"
                              Tag="14"
                              Icon="{Binding Source={StaticResource HotkeyIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                              InputGestureText="{Binding ShortcutKeyString}"
                              Command="{Binding PlacementTarget.Tag.AssignHotkeyToSubSelectedItemCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                    <Separator />
                    <MenuItem x:Name="ClipTileColorContextMenuItem"
                              Style="{StaticResource ColorPalleteMenuItemStyle}" />
                    <Separator />
                    <MenuItem x:Name="PasteToAppPathMenuItem"
                              Header="Paste To Application"
                              Icon="{Binding Source={StaticResource PasteToAppIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}" />
                    <Separator />
                    <MenuItem x:Name="CollectionParentMenuItem"
                              Tag="8080"
                              Header="Pin To _Collection"
                              Icon="{Binding Source={StaticResource PinToCollectionIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                              ItemsSource="{Binding PlacementTarget.Tag.TagMenuItems, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}">
                        <MenuItem.ItemContainerStyle>
                            <Style TargetType="{x:Type MenuItem}">
                                <Setter Property="Header"
                                        Value="{Binding Header}" />
                                <Setter Property="Command"
                                        Value="{Binding Command}" />
                                <Setter Property="CommandParameter"
                                        Value="{Binding CommandParameter}" />
                                <Setter Property="Icon"
                                        Value="{Binding Icon}" />
                                <Setter Property="InputGestureText"
                                        Value="{Binding InputGestureText}" />
                                <!--<Setter Property="IsCheckable"
                                                                                                                        Value="True" />
                                                                                                                <Setter Property="IsChecked"
                                                                                                                        Value="{Binding IsChecked}" />-->
                            </Style>
                        </MenuItem.ItemContainerStyle>
                    </MenuItem>
                </ContextMenu>
            </Canvas.ContextMenu>
            <AdornerDecorator x:Name="RtbListBoxItemRichTextBoxAdorner"
                              DataContext="{Binding}">
                <RichTextBox x:Name="RtbListBoxItemRichTextBox"
                             Background="{local:MpSettingBinding ThemeClipTileBackgroundColor, Converter={StaticResource StringToBrushConverter}}"
                             IsReadOnly="{Binding HostClipTileViewModel.IsRtbReadOnly}"
                             Loaded="RtbListBoxItemRichTextBox_Loaded"
                             TextChanged="RtbListBoxItemRichTextBox_TextChanged"
                             SelectionChanged="RtbListBoxItemRichTextBox_SelectionChanged"                            
                             IsEnabled="True"
                             AllowDrop="True"
                             AutoWordSelection="False"
                             IsInactiveSelectionHighlightEnabled="True"
                             IsDocumentEnabled="True"
                             Focusable="{Binding HostClipTileViewModel.IsEditingTile}"
                             Cursor="{Binding RtbListBoxItemCursor}"
                             Width="{Binding RtbWidth}"
                             Height="{Binding RtbHeight}"
                             Padding="{Binding RtbPadding}"
                             local:MpDocumentRtfExtension.DocumentRtf="{Binding CopyItemRichText, UpdateSourceTrigger=LostFocus,NotifyOnSourceUpdated=True}"
                             IsUndoEnabled="True"
                             SpellCheck.IsEnabled="{Binding RtbItemCollectionViewModel.EditRichTextBoxToolbarViewModel.UseSpellCheck}"
                             VerticalAlignment="Top"
                             HorizontalAlignment="Left"
                             ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                             ScrollViewer.VerticalScrollBarVisibility="Hidden"
                             BorderThickness="0">
                    <RichTextBox.Resources>
                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}"
                                         Color="Blue" />
                    </RichTextBox.Resources>
                </RichTextBox>
            </AdornerDecorator>
            <local:MpClipBorder x:Name="RtbListBoxItemOverlayBorder"
                                DataContext="{Binding}"
                                Visibility="{Binding SubItemOverlayVisibility}"
                                Width="{Binding RtbCanvasWidth}"
                                Height="{Binding RtbCanvasHeight}"
                                Background="{Binding RtbListBoxItemBackgroundColor}"
                                Tag="{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}"
                                ToolTipService.InitialShowDelay="750"
                                BorderBrush="{Binding RtbOverlayBorderBrush}"
                                BorderThickness="1"
                                CornerRadius="5">
                <local:MpClipBorder.ToolTip>
                    <ToolTip x:Name="ClipTileTooltip"
                             Visibility="{Binding PlacementTarget.DataContext.SubItemToolTipVisibility, RelativeSource={RelativeSource Self}}"
                             Placement="Top"
                             HorizontalOffset="{Binding PlacementTarget.DataContext.HostClipTileViewModel.TileBorderWidth, RelativeSource={RelativeSource Self}}">
                        <ToolTip.Template>
                            <ControlTemplate>
                                <Border Background="White"
                                        BorderThickness="1"
                                        BorderBrush="Black"
                                        Padding="5">
                                    <Image Stretch="Fill"
                                           Source="{Binding PlacementTarget.Tag.CopyItemBmp,RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=local:MpClipBorder}}" />
                                </Border>
                            </ControlTemplate>
                        </ToolTip.Template>
                    </ToolTip>
                </local:MpClipBorder.ToolTip>
                <DockPanel x:Name="RtbListItemOverlayBorderDockPanel"
                           DataContext="{Binding}"
                           Width="{Binding RtbCanvasWidth}"
                           Height="{Binding RtbCanvasHeight}">
                    <DockPanel DockPanel.Dock="Left"
                               Visibility="{Binding DragAndHotkeyButtonVisibility}">
                        <Button x:Name="DragButton"
                                PreviewGiveFeedback="DragButton_PreviewGiveFeedback"
                                PreviewMouseUp="DragButton_PreviewMouseUp"
                                PreviewMouseDown="DragButton_PreviewMouseDown"
                                PreviewMouseMove="DragButton_PreviewMouseMove"
                                MouseEnter="DragButton_MouseEnter"
                                MouseLeave="DragButton_MouseLeave"
                                DockPanel.Dock="Top"
                                BorderThickness="0"
                                Cursor="SizeAll"
                                Margin="0,0,0,0"
                                Background="Transparent"
                                VerticalAlignment="Top"
                                VerticalContentAlignment="Top"
                                HorizontalAlignment="Left"
                                HorizontalContentAlignment="Left"
                                Width="{Binding DragButtonSize}"
                                Height="{Binding DragButtonSize}"
                                Template="{StaticResource SearchButtonControlTemplate}">
                            <Image HorizontalAlignment="Left"
                                   Source="/Resources/Images/burger.png"
                                   Stretch="Fill" />
                        </Button>
                        <Button x:Name="RtbListboxItemHotkeyButton"
                                DockPanel.Dock="Bottom"
                                VerticalAlignment="Bottom"
                                VerticalContentAlignment="Bottom"
                                HorizontalAlignment="Center"
                                HorizontalContentAlignment="Center"
                                Width="14"
                                Height="14"
                                Margin="0,0,0,0"
                                ToolTipService.InitialShowDelay="0"
                                ToolTip="{Binding HotkeyIconTooltip}"
                                Command="{Binding AssignHotkeyToSubSelectedItemCommand}"
                                Visibility="{Binding SubItemOverlayVisibility}"
                                Template="{StaticResource SearchButtonControlTemplate}">
                            <Image Source="{Binding HotkeyIconSource}" />
                        </Button>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Right">
                        <TextBlock x:Name="RtbTitleTextBlock"
                                   PreviewMouseLeftButtonDown="RtbTitleTextBlock_PreviewMouseLeftButtonDown"
                                   MouseEnter="RtbTitleTextBlock_MouseEnter"
                                   MouseLeave="RtbTitleTextBlock_MouseLeave"                                   
                                   DockPanel.Dock="Top"
                                   Opacity="1"
                                   Margin="0,0,25,0"
                                   TextAlignment="Right"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Top"
                                   Cursor="IBeam"
                                   ToolTip="{Binding DetailText}"
                                   Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}"
                                   FontSize="{Binding RtbListBoxItemTitleFontSize}"
                                   Foreground="{Binding RtbListBoxItemTitleTextBlockTextColor}"
                                   FontWeight="Bold"
                                   Background="Transparent"
                                   Visibility="{Binding RtbListBoxItemTitleTextBlockVisibility}">
                        <!--<TextBlock.Effect>
                            <DropShadowEffect ShadowDepth="2"
                                                Direction="300"
                                                Color="Black"
                                                Opacity="1.0"
                                                BlurRadius="3" />
                        </TextBlock.Effect>--></TextBlock>
                        <TextBox x:Name="RtbTitleTextBox"
                                 IsVisibleChanged="RtbTitleTextBox_IsVisibleChanged"
                                 LostFocus="RtbTitleTextBox_LostFocus"
                                 PreviewKeyDown="RtbTitleTextBox_PreviewKeyDown"
                                 DockPanel.Dock="Top"
                                 Opacity="1"
                                 Margin="0,0,25,0"
                                 TextAlignment="Right"
                                 VerticalAlignment="Top"
                                 HorizontalAlignment="Right"
                                 Background="White"
                                 Foreground="Black"
                                 FontSize="{Binding RtbListBoxItemTitleFontSize}"
                                 IsReadOnly="False"
                                 Visibility="{Binding RtbListBoxItemTitleTextBoxVisibility}"
                                 Text="{Binding CopyItemTitle, Mode=TwoWay, NotifyOnTargetUpdated=True, NotifyOnSourceUpdated=True, UpdateSourceTrigger=LostFocus}" />
                        <!-- Sub Item Title Icon Image -->
                        <Canvas DockPanel.Dock="Right"
                                HorizontalAlignment="Right"
                                Width="{Binding SubItemAppIconBorderSize}"
                                Height="{Binding SubItemAppIconBorderSize}"
                                Background="Transparent"
                                Margin="0,0,25,0"
                                Visibility="{Binding SubItemOverlayVisibility}">
                            <Image x:Name="RtbItemAppIconHighlightedBorderImage"
                                   Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconBorderHighlightImage.ImageBase64, Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                                   Stretch="Fill"
                                   Visibility="{Binding AppIconHighlightBorderVisibility}"
                                   Width="{Binding SubItemAppIconBorderSize}"
                                   Height="{Binding SubItemAppIconBorderSize}" />
                            <Button x:Name="RtbItemAppIconImageButton"
                                    PreviewMouseLeftButtonDown="RtbItemAppIconImageButton_PreviewMouseLeftButtonDown"
                                    Canvas.Top="-2"
                                    Margin="0"
                                    Style="{StaticResource Transparent_Button}"
                                    Visibility="{Binding SubItemOverlayVisibility}"
                                    Background="Transparent"
                                    BorderThickness="0">
                                <Button.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Exclude Application"
                                                  Icon="{Binding Source={StaticResource NoEntryIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                  Command="{Binding PlacementTarget.Tag.ExcludeSubSelectedItemApplicationCommand, RelativeSource={RelativeSource Mode=FindAncestor,AncestorType=ContextMenu}}" />
                                        <MenuItem Header="Add Paste Macro For Application"
                                                  Icon="{Binding Source={StaticResource RobotClawIcon}, Converter={StaticResource StringToIconConverter}, Mode=OneWay}"
                                                  Command="{Binding ShowSettingsWindowCommand, Source={StaticResource SystemTrayViewModel}}"
                                                  CommandParameter="{Binding}" />
                                    </ContextMenu>
                                </Button.ContextMenu>
                                <Grid>
                                    <Image x:Name="RtbItemAppIconImage"
                                           Visibility="{Binding AppIconImageVisibility}"
                                           Source="{Binding CopyItem.Source.PrimarySource.SourceIcon.IconImage.ImageBase64, Converter={StaticResource Base64StringToBitmapSourceConverter}}"
                                           Stretch="Fill"
                                           Width="{Binding SubItemAppIconSize}"
                                           Height="{Binding SubItemAppIconSize}" />
                                    <!--<Viewbox Visibility="{Binding MultiSelectOrderMarkerVisibility}"
                                                                                                                         Width="{Binding SubItemAppIconBorderSize}"
                                                                                                                         Height="{Binding SubItemAppIconBorderSize}">
                                                                                                                    <Grid>
                                                                                                                        <Ellipse HorizontalAlignment="Center"
                                                                                                                                 VerticalAlignment="Center"
                                                                                                                                 Width="{Binding SubItemAppIconBorderSize}"
                                                                                                                                 Height="{Binding SubItemAppIconBorderSize}"
                                                                                                                                 Fill="{Binding RtbOverlayBorderBrush}" />
                                                                                                                        <Ellipse HorizontalAlignment="Center"
                                                                                                                                 VerticalAlignment="Center"
                                                                                                                                 Width="{Binding SubItemAppIconSize}"
                                                                                                                                 Height="{Binding TileTitleIconSize}"
                                                                                                                                 Fill="White" />
                                                                                                                        <TextBlock Background="Transparent"
                                                                                                                                   Foreground="Black"
                                                                                                                                   HorizontalAlignment="Center"
                                                                                                                                   VerticalAlignment="Center"
                                                                                                                                   FontSize="14"
                                                                                                                                   Text="{Binding MultiSelectedOrderIdxDisplayValue}" />
                                                                                                                    </Grid>
                                                                                                                </Viewbox>-->
                                </Grid>
                            </Button>
                        </Canvas>
                    </DockPanel>
                </DockPanel>
            </local:MpClipBorder>
        </Canvas>
    </AdornerDecorator>
</UserControl>
