<local:MpAvUserControl x:Name="TagView"
                       xmlns="https://github.com/avaloniaui"
                       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                       xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                       xmlns:sys="clr-namespace:System;assembly=mscorlib"
                       xmlns:local="using:MonkeyPaste.Avalonia"
                       xmlns:pcl="using:MonkeyPaste"
                       x:TypeArguments="local:MpAvTagTileViewModel"
                       x:DataType="local:MpAvTagTileViewModel"
                       x:CompileBindings="True"
                       mc:Ignorable="d"
                       x:Class="MonkeyPaste.Avalonia.MpAvTagView">
    <local:MpAvUserControl.Styles>
        <Style Selector="local|MpAvClipBorder#TagNameBorder">
            <Setter Property="Background"
                    Value="{DynamicResource TagTileBgColor}" />
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TagTileBorderColor}" />
            <Setter Property="BorderDashArray"
                    Value="{x:Null}" />
            <Setter Property="BorderDashOffset"
                    Value="0" />
        </Style>
        <Style Selector="local|MpAvClipBorder#TagNameBorder.isselected">
            <Setter Property="Background"
                    Value="{DynamicResource TagTileSelectedBgColor}" />
        </Style>
        <Style Selector="local|MpAvClipBorder#TagNameBorder:pointerover:not(.isselected)">
            <Setter Property="Background"
                    Value="{DynamicResource TagTileHoverBgColor}" />
        </Style>
        <Style Selector="local|MpAvClipBorder#TagNameBorder.contextfocus, local|MpAvClipBorder#TagNameBorder:not(.isselected).activeTag">
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TagTileContextFocusBorderColor}" />
        </Style>
        <Style Selector="local|MpAvClipBorder#TagNameBorder.dragover">
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TagTileDragOverBorderColor}" />
            <Setter Property="BorderDashArray"
                    Value="2,2" />
            <Setter Property="BorderDashOffset"
                    Value="2" />
        </Style>
        <Style Selector="local|MpAvClipBorder#TagNameBorder.dragover.dragover_invalid">
            <Setter Property="BorderBrush"
                    Value="{DynamicResource TagTileDragOverInvalidBorderColor}" />
        </Style>
    </local:MpAvUserControl.Styles>
    <Grid x:Name="TagViewContainerGrid"
          local:MpAvIsHoveringExtension.IsEnabled="True"
          local:MpAvIsHoveringExtension.IsHovering="{Binding IsHovering, Mode=TwoWay}"
          local:MpAvIsHoveringExtension.HoverCursor="Hand"
          local:MpAvMenuExtension.IsEnabled="True"
          local:MpAvMenuExtension.SelectOnRightClick="False"
          local:MpAvMenuExtension.IsOpen="{Binding IsContextMenuOpen, Mode=TwoWay}"
          local:MpAvPointerPressCommandExtension.IsEnabled="True"
          local:MpAvPointerPressCommandExtension.RoutingStrategy="Tunnel"
          local:MpAvPointerPressCommandExtension.LeftPressCommand="{Binding SelectTagCommand}"
          local:MpAvPointerPressCommandExtension.DoubleLeftPressCommand="{Binding RenameTagCommand}"
          Cursor="Hand"
          HorizontalAlignment="Stretch"
          VerticalAlignment="Stretch"
          MinWidth="100"
          MaxWidth="130"
          Height="30">
        <local:MpAvClipBorder x:Name="TagNameBorder"
                              CornerRadius="7"
                              Margin="5,0,0,0"
                              Padding="1"
                              VerticalAlignment="Stretch"
                              HorizontalAlignment="Stretch"
                              MinHeight="20"
                              Classes.islinked="{Binding IsLinkedToSelectedClipTile}"
                              Classes.isgroup="{Binding IsGroupTag}"
                              Classes.isselected="{Binding IsSelected}"
                              Classes.dragover="{Binding IsDragOverTag}"
                              Classes.dragover_invalid="{Binding !IsDragOverTagValid}"
                              Classes.contextfocus="{Binding IsContextMenuOpen}"
                              Classes.activeTag="{Binding IsActiveTag}"
                              BorderThickness="1.5">
            <StackPanel Orientation="Horizontal">
                <Grid VerticalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <!--  Tag Count Box  -->
                    <local:MpAvClipBorder CornerRadius="5"
                                          Grid.Column="0"
                                          MinWidth="20"
                                          MinHeight="20"
                                          Margin="1"
                                          Padding="4,1"
                                          BorderThickness="0"
                                          Background="{Binding TagHexColor, Converter={StaticResource StringHexToBrushConverter}}">
                        <TextBlock x:Name="TagCountTextBlock"
                                   Background="Transparent"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Text="{Binding TagClipCountText}"
                                   Foreground="{Binding $parent.Background, Converter={StaticResource BrushToContrastBrushConverter}}" />
                    </local:MpAvClipBorder>
                    <!--  Tag Name TextBox/ Marquee  -->
                    <local:MpAvMarqueeTextBox x:Name="TagNameTextBox"
                                              Grid.Column="1"
                                              FocusAdorner="{x:Null}"
                                              HorizontalAlignment="Stretch"
                                              VerticalAlignment="Center"
                                              HorizontalContentAlignment="Left"
                                              VerticalContentAlignment="Center"
                                              Margin="5,0,0,0"
                                              FontSize="16"
                                              Padding="0"
                                              MinWidth="70"
                                              MaxWidth="100"
                                              local:MpAvIsFocusedExtension.IsEnabled="True"
                                              local:MpAvIsFocusedExtension.SelectViewModelOnFocus="False"
                                              local:MpAvIsFocusedExtension.IsFocused="{Binding IsTagNameTextBoxFocused, Mode=TwoWay}"
                                              EditOnFocus="{Binding !IsTagNameReadOnly, Mode=OneWay}"
                                              CancelEditCommand="{Binding CancelRenameTagCommand}"
                                              BeginEditCommand="{Binding FinishRenameTagCommand}"
                                              ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                              ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                              IsReadOnly="{Binding IsTagNameReadOnly, Mode=OneWay}"
                                              FontFamily="Segoe UI"
                                              ReadOnlyBackground="Transparent"
                                              ReadOnlyForeground="{Binding TagTextHexColor, Converter={x:Static local:MpAvStringHexToBrushConverter.Instance}}"
                                              Text="{Binding TagName, Mode=TwoWay}" />
                </Grid>
            </StackPanel>
        </local:MpAvClipBorder>

        <Border Background="Red"
                ClipToBounds="False"
                MinWidth="15"
                Height="15"
                CornerRadius="7.5"
                BorderThickness="1"
                BorderBrush="White"
                VerticalAlignment="Top"
                HorizontalAlignment="Left"
                IsVisible="{Binding BadgeCount, Converter={StaticResource IsNotNullZeroOrEmptyToBoolConverter}}">
            <TextBlock Foreground="White"
                       FontSize="10"
                       MinWidth="15"
                       Height="15"
                       TextAlignment="Center"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Text="{Binding BadgeCount}" />
        </Border>
    </Grid>
</local:MpAvUserControl>
